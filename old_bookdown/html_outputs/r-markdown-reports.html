<!DOCTYPE html>
<html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>41 R Markdown reports | The Epidemiologist R Handbook</title>
<meta name="author" content="the handbook team">
<!-- JS --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.2"></script><script src="https://kit.fontawesome.com/6ecbd6c532.js" crossorigin="anonymous"></script><script src="libs/header-attrs-2.7/header-attrs.js"></script><script src="libs/jquery-3.5.1/jquery-3.5.1.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="libs/bootstrap-4.5.3/bootstrap.min.css" rel="stylesheet">
<script src="libs/bootstrap-4.5.3/bootstrap.bundle.min.js"></script><script src="libs/bs3compat-0.2.4/tabs.js"></script><script src="libs/bs3compat-0.2.4/bs3compat.js"></script><link href="libs/bs4_book-1.0.0/bs4_book.css" rel="stylesheet">
<script src="libs/bs4_book-1.0.0/bs4_book.js"></script><script src="libs/htmlwidgets-1.5.3/htmlwidgets.js"></script><link href="libs/datatables-css-0.0.0/datatables-crosstalk.css" rel="stylesheet">
<script src="libs/datatables-binding-0.15/datatables.js"></script><link href="libs/dt-core-1.10.20/css/jquery.dataTables.min.css" rel="stylesheet">
<link href="libs/dt-core-1.10.20/css/jquery.dataTables.extra.css" rel="stylesheet">
<script src="libs/dt-core-1.10.20/js/jquery.dataTables.min.js"></script><link href="libs/nouislider-7.0.10/jquery.nouislider.min.css" rel="stylesheet">
<script src="libs/nouislider-7.0.10/jquery.nouislider.min.js"></script><link href="libs/selectize-0.12.0/selectize.bootstrap3.css" rel="stylesheet">
<script src="libs/selectize-0.12.0/selectize.min.js"></script><link href="libs/crosstalk-1.1.1/css/crosstalk.css" rel="stylesheet">
<script src="libs/crosstalk-1.1.1/js/crosstalk.min.js"></script><script src="libs/kePrint-0.0.1/kePrint.js"></script><link href="libs/lightable-0.0.1/lightable.css" rel="stylesheet">
<link href="libs/tabwid-1.0.0/tabwid.css" rel="stylesheet">
<link href="libs/leaflet-1.3.1/leaflet.css" rel="stylesheet">
<script src="libs/leaflet-1.3.1/leaflet.js"></script><link href="libs/leafletfix-1.0.0/leafletfix.css" rel="stylesheet">
<script src="libs/proj4-2.6.2/proj4.min.js"></script><script src="libs/Proj4Leaflet-1.0.1/proj4leaflet.js"></script><link href="libs/rstudio_leaflet-1.3.1/rstudio_leaflet.css" rel="stylesheet">
<script src="libs/leaflet-binding-2.0.4.1/leaflet.js"></script><script src="libs/leaflet-providers-1.9.0/leaflet-providers_1.9.0.js"></script><script src="libs/leaflet-providers-plugin-2.0.4.1/leaflet-providers-plugin.js"></script><script src="libs/viz-1.8.2/viz.js"></script><link href="libs/DiagrammeR-styles-0.2/styles.css" rel="stylesheet">
<script src="libs/grViz-binding-1.0.6.1/grViz.js"></script><script src="libs/d3-4.5.0/d3.min.js"></script><script src="libs/sankey-1/sankey.js"></script><script src="libs/sankeyNetwork-binding-0.4/sankeyNetwork.js"></script><script src="libs/plotly-binding-4.9.3/plotly.js"></script><script src="libs/typedarray-0.1/typedarray.min.js"></script><link href="libs/plotly-htmlwidgets-css-1.57.1/plotly-htmlwidgets.css" rel="stylesheet">
<script src="libs/plotly-main-1.57.1/plotly-latest.min.js"></script><link href="libs/vis-4.20.1/vis.css" rel="stylesheet">
<script src="libs/vis-4.20.1/vis.min.js"></script><script src="libs/visNetwork-binding-2.0.9/visNetwork.js"></script><link href="libs/font-awesome-4.7.0/css/font-awesome.min.css" rel="stylesheet">
<script src="libs/plotly-basic-1.57.1/plotly-basic-1.57.1.min.js"></script><script src="libs/plotly-cartesian-1.57.1/plotly-cartesian-1.57.1.min.js"></script><script src="https://cdn.jsdelivr.net/autocomplete.js/0/autocomplete.jquery.min.js"></script><script src="https://cdn.jsdelivr.net/npm/mark.js@8.11.1/dist/mark.min.js"></script><!-- CSS --><link rel="stylesheet" href="style_bs4.css">
</head>
<body data-spy="scroll" data-target="#toc">

<div class="container-fluid">
<div class="row">
  <header class="col-sm-12 col-lg-3 sidebar sidebar-book"><a class="sr-only sr-only-focusable" href="#content">Skip to main content</a>

    <div class="d-flex align-items-start justify-content-between">
      <h1>
        <a href="index.html" title="">The Epidemiologist R Handbook</a>
      </h1>
      <button class="btn btn-outline-primary d-lg-none ml-2 mt-1" type="button" data-toggle="collapse" data-target="#main-nav" aria-expanded="true" aria-controls="main-nav"><i class="fas fa-bars"></i><span class="sr-only">Show table of contents</span></button>
    </div>

    <div id="main-nav" class="collapse-lg">
      <form role="search">
        <input id="search" class="form-control" type="search" placeholder="Search" aria-label="Search">
</form>

      <nav aria-label="Table of contents"><h2>Table of contents</h2>
        <ul class="book-toc list-unstyled">
<li><a class="" href="index.html"></a></li>
<li class="book-part">About this book</li>
<li><a class="" href="editorial-and-technical-notes.html"><span class="header-section-number">1</span> Editorial and technical notes</a></li>
<li><a class="" href="download-handbook-and-data.html"><span class="header-section-number">2</span> Download handbook and data</a></li>
<li class="book-part">Basics</li>
<li><a class="" href="r-basics.html"><span class="header-section-number">3</span> R Basics</a></li>
<li><a class="" href="transition-to-r.html"><span class="header-section-number">4</span> Transition to R</a></li>
<li><a class="" href="suggested-packages-1.html"><span class="header-section-number">5</span> Suggested packages</a></li>
<li><a class="" href="r-projects.html"><span class="header-section-number">6</span> R projects</a></li>
<li><a class="" href="import-and-export.html"><span class="header-section-number">7</span> Import and export</a></li>
<li class="book-part">Data Management</li>
<li><a class="" href="cleaning-data-and-core-functions.html"><span class="header-section-number">8</span> Cleaning data and core functions</a></li>
<li><a class="" href="working-with-dates.html"><span class="header-section-number">9</span> Working with dates</a></li>
<li><a class="" href="factors.html"><span class="header-section-number">10</span> Factors</a></li>
<li><a class="" href="pivoting-data.html"><span class="header-section-number">11</span> Pivoting data</a></li>
<li><a class="" href="grouping-data.html"><span class="header-section-number">12</span> Grouping data</a></li>
<li><a class="" href="joining-data.html"><span class="header-section-number">13</span> Joining data</a></li>
<li><a class="" href="characters-and-strings.html"><span class="header-section-number">14</span> Characters and strings</a></li>
<li><a class="" href="de-duplication.html"><span class="header-section-number">15</span> De-duplication</a></li>
<li><a class="" href="iteration-loops-and-lists.html"><span class="header-section-number">16</span> Iteration, loops, and lists</a></li>
<li class="book-part">Analysis</li>
<li><a class="" href="descriptive-tables.html"><span class="header-section-number">17</span> Descriptive tables</a></li>
<li><a class="" href="simple-statistical-tests.html"><span class="header-section-number">18</span> Simple statistical tests</a></li>
<li><a class="" href="univariate-and-multivariable-regression.html"><span class="header-section-number">19</span> Univariate and multivariable regression</a></li>
<li><a class="" href="missing-data.html"><span class="header-section-number">20</span> Missing data</a></li>
<li><a class="" href="standardization-1.html"><span class="header-section-number">21</span> Standardization</a></li>
<li><a class="" href="moving-averages.html"><span class="header-section-number">22</span> Moving averages</a></li>
<li><a class="" href="time-series-and-outbreak-detection-1.html"><span class="header-section-number">23</span> Time series and outbreak detection</a></li>
<li><a class="" href="epidemic-modeling.html"><span class="header-section-number">24</span> Epidemic modeling</a></li>
<li><a class="" href="survey-analysis.html"><span class="header-section-number">25</span> Survey analysis</a></li>
<li><a class="" href="survival-analysis.html"><span class="header-section-number">26</span> Survival analysis</a></li>
<li><a class="" href="gis-basics.html"><span class="header-section-number">27</span> GIS basics</a></li>
<li class="book-part">Data Visualization</li>
<li><a class="" href="tables-for-presentation.html"><span class="header-section-number">28</span> Tables for presentation</a></li>
<li><a class="" href="ggplot-basics.html"><span class="header-section-number">29</span> ggplot basics</a></li>
<li><a class="" href="plot-continuous-data.html"><span class="header-section-number">30</span> Plot continuous data</a></li>
<li><a class="" href="plot-categorical-data.html"><span class="header-section-number">31</span> Plot categorical data</a></li>
<li><a class="" href="ggplot-tips.html"><span class="header-section-number">32</span> ggplot tips</a></li>
<li><a class="" href="epidemic-curves.html"><span class="header-section-number">33</span> Epidemic curves</a></li>
<li><a class="" href="demographic-pyramids-and-likert-scales.html"><span class="header-section-number">34</span> Demographic pyramids and Likert-scales</a></li>
<li><a class="" href="diagrams-and-charts.html"><span class="header-section-number">35</span> Diagrams and charts</a></li>
<li><a class="" href="combinations-analysis.html"><span class="header-section-number">36</span> Combinations analysis</a></li>
<li><a class="" href="heat-plots.html"><span class="header-section-number">37</span> Heat plots</a></li>
<li><a class="" href="transmission-chains.html"><span class="header-section-number">38</span> Transmission chains</a></li>
<li><a class="" href="phylogenetic-trees-1.html"><span class="header-section-number">39</span> Phylogenetic trees</a></li>
<li><a class="" href="interactive-plots.html"><span class="header-section-number">40</span> Interactive plots</a></li>
<li class="book-part">Reports and dashboards</li>
<li><a class="active" href="r-markdown-reports.html"><span class="header-section-number">41</span> R Markdown reports</a></li>
<li><a class="" href="organizing-routine-reports.html"><span class="header-section-number">42</span> Organizing routine reports</a></li>
<li><a class="" href="dashboards-with-r-markdown.html"><span class="header-section-number">43</span> Dashboards with R Markdown</a></li>
<li><a class="" href="dashboards-with-shiny.html"><span class="header-section-number">44</span> Dashboards with Shiny</a></li>
<li class="book-part">Miscellaneous</li>
<li><a class="" href="writing-functions-1.html"><span class="header-section-number">45</span> Writing functions</a></li>
<li><a class="" href="version-control-and-collaboration-with-github.html"><span class="header-section-number">46</span> Version control and collaboration with Github</a></li>
<li><a class="" href="directory-interactions.html"><span class="header-section-number">47</span> Directory interactions</a></li>
<li><a class="" href="errors-help.html"><span class="header-section-number">48</span> Errors &amp; help</a></li>
<li><a class="" href="relational-databases.html"><span class="header-section-number">49</span> Relational databases</a></li>
<li><a class="" href="r-on-network-drives.html"><span class="header-section-number">50</span> R on network drives</a></li>
<li><a class="" href="data-table.html"><span class="header-section-number">51</span> Data Table</a></li>
<li><a class="" href="advanced-rstudio.html"><span class="header-section-number">52</span> Advanced RStudio</a></li>
</ul>

        <div class="book-extra">
          
        </div>
      </nav>
</div>
  </header><main class="col-sm-12 col-md-9 col-lg-7" id="content"><div id="r-markdown-reports" class="section level1" number="41">
<h1>
<span class="header-section-number">41</span> R Markdown reports<a class="anchor" aria-label="anchor" href="#r-markdown-reports"><i class="fas fa-link"></i></a>
</h1>
<div class="inline-figure"><img src="images/markdown/rmarkdown_overview.png" width="100%" style="display: block; margin: auto;"></div>
<p>R Markdown is a widely-used tool for creating automated, reproducible, and share-worthy outputs, such as reports. It can generate static or interactive outputs, in Word, pdf, html, powerpoint, and other formats.</p>
<p>An R Markdown script intersperces R code and text such that the script actually <em>becomes your output document</em>. You can create an entire formatted document, including narrative text (can be dynamic to change based on your data), tables, figures, bullets/numbers, bibliographies, etc.</p>
<p>Such documents can be produced to update on a routine basis (e.g. daily surveillance reports) and/or run on subsets of data (e.g. reports for each jurisdiction).</p>
<p>Other pages in this handbook expand on this topic:</p>
<ul>
<li>The page <a href="organizing-routine-reports.html#organizing-routine-reports">Organizing routine reports</a> demonstrates how to routinize your report production with auto-generated time-stamped folders.<br>
</li>
<li>The page [Dashboards with M Markdown] explains how to format a R Markdown report as a dashboard.</li>
</ul>
<!-- ======================================================= --><div id="preparation-33" class="section level2" number="41.1">
<h2>
<span class="header-section-number">41.1</span> Preparation<a class="anchor" aria-label="anchor" href="#preparation-33"><i class="fas fa-link"></i></a>
</h2>
<p><strong>Background to R Markdown</strong></p>
<p>To explain some of the concepts and packages involved:</p>
<ul>
<li>
<strong>Markdown</strong> is a “language” that allows you to write a document using plain text, that can be converted to html and other formats. It is not specific to R. Files written in Markdown have a ‘.md’ extension.</li>
<li>
<strong>R Markdown</strong>: is a variation on markdown that <em>is specific to R</em> - it allows you to write a document using markdown to produce text <em>and to embed R code and display their outputs</em>. R Markdown files have ‘.Rmd’ extension.<br>
</li>
<li>
<strong>rmarkdown - the package</strong>: This is used by R to render the .Rmd file into the desired output. It’s focus is converting the markdown (text) syntax, so we also need…</li>
<li>
<strong>knitr</strong>: This R package will read the code chunks, execute it, and ‘knit’ it back into the document. This is how tables and graphs are included alongside the text.</li>
<li>
<strong>Pandoc</strong>: Finally, pandoc actually convert the output into word/pdf/powerpoint etc. It is a software separate from R but is installed automatically with RStudio.</li>
</ul>
<p>In sum, the process involves feeding the .Rmd file to <strong>knitr</strong>, which executes the R code chunks and creates a new .md (markdown) file which includes the R code and its rendered output. The .md file is then processed by pandoc to create the finished product: a Microsoft Word document, HTML file, powerpoint document, pdf, etc.</p>
<div class="inline-figure"><img src="images/markdown/0_rmd.png" width="100%" style="display: block; margin: auto;"></div>
<p>(source: <a href="https://rmarkdown.rstudio.com/authoring_quick_tour.html" class="uri">https://rmarkdown.rstudio.com/authoring_quick_tour.html</a>):</p>
<p><strong>Installation</strong></p>
<p>To create a R Markdown output, you need to have the following installed:</p>
<ul>
<li>The <strong>rmarkdown</strong> package (<strong>knitr</strong> will also be installed automatically)<br>
</li>
<li>Pandoc, which should come installed with RStudio. If you are not using RStudio, you can download it here: <a href="http://pandoc.org" class="uri">http://pandoc.org</a>.</li>
<li>If you want to generate PDF output (a bit trickier), you will need to install LaTeX. For R Markdown users who have not installed LaTeX before, we recommend that you install TinyTeX (<a href="https://yihui.name/tinytex/" class="uri">https://yihui.name/tinytex/</a>). You can use the following commands:</li>
</ul>
<div class="sourceCode" id="cb1672"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">pacman</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/pacman/man/p_load.html">p_load</a></span><span class="op">(</span><span class="va">tinytex</span><span class="op">)</span>     <span class="co"># install tinytex package</span>
<span class="fu">tinytex</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/tinytex/man/install_tinytex.html">install_tinytex</a></span><span class="op">(</span><span class="op">)</span>  <span class="co"># R command to install TinyTeX software</span></code></pre></div>
<!-- ======================================================= -->
</div>
<div id="getting-started" class="section level2" number="41.2">
<h2>
<span class="header-section-number">41.2</span> Getting started<a class="anchor" aria-label="anchor" href="#getting-started"><i class="fas fa-link"></i></a>
</h2>
<div id="install-rmarkdown-r-package" class="section level3 unnumbered">
<h3>Install rmarkdown R package<a class="anchor" aria-label="anchor" href="#install-rmarkdown-r-package"><i class="fas fa-link"></i></a>
</h3>
<p>Install the <strong>rmarkdown</strong> R package. In this handbook we emphasize <code>p_load()</code> from <strong>pacman</strong>, which installs the package if necessary <em>and</em> loads it for use. You can also load installed packages with <code><a href="https://rdrr.io/r/base/library.html">library()</a></code> from <strong>base</strong> R. See the page on <a href="r-basics.html#r-basics">R basics</a> for more information on R packages.</p>
<div class="sourceCode" id="cb1673"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">pacman</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/pacman/man/p_load.html">p_load</a></span><span class="op">(</span><span class="va">rmarkdown</span><span class="op">)</span></code></pre></div>
</div>
<div id="starting-a-new-rmd-file" class="section level3 unnumbered">
<h3>Starting a new Rmd file<a class="anchor" aria-label="anchor" href="#starting-a-new-rmd-file"><i class="fas fa-link"></i></a>
</h3>
<p>In RStudio, open a new R markdown file, starting with ‘File’, then ‘New file’ then ‘R markdown…’.</p>
<div class="inline-figure"><img src="images/markdown/1_gettingstarted.png" width="50%" style="display: block; margin: auto;"></div>
<p>R Studio will give you some output options to pick from. In the example below we select “HTML” because we want to create an html document. The title and the author names are not important. If the output document type you want is not one of these, don’t worry - you can just pick any one and change it in the script later.</p>
<div class="inline-figure"><img src="images/markdown/1_gettingstartedB.png" width="50%" style="display: block; margin: auto;"></div>
<p>This will open up a new .Rmd script.</p>
</div>
<div id="important-to-know" class="section level3 unnumbered">
<h3>Important to know<a class="anchor" aria-label="anchor" href="#important-to-know"><i class="fas fa-link"></i></a>
</h3>
<p><strong>The working directory</strong></p>
<p>The working directory of a markdown file is wherever the Rmd file itself is saved. For instance, if the R project is within <code>~/Documents/projectX</code> and the Rmd file itself is in a subfolder <code>~/Documents/projectX/markdownfiles/markdown.Rmd</code>, the code <code>read.csv(“data.csv”)</code> within the markdown will look for a csv file in the <code>markdownfiles</code> folder, and not the root project folder where scripts within projects would normally automatically look.</p>
<p>To refer to files elsewhere, you will either need to use the full file path or use the <strong>here</strong> package. The <strong>here</strong> package sets the working directory to the root folder of the R project and is explained in detail in the <a href="r-projects.html#r-projects">R projects</a> and <a href="import-and-export.html#import-and-export">Import and export</a> pages of this handbook. For instance, to import a file called “data.csv” from within the <code>projectX</code> folder, the code would be <code>import(here(“data.csv”))</code>.</p>
<p>Note that use of <code><a href="https://rdrr.io/r/base/getwd.html">setwd()</a></code> in R Markdown scripts is not recommended – it only applies to the code chunk that it is written in.</p>
<p><strong>Working on a drive vs your computer</strong></p>
<p>Because R Markdown can run into pandoc issues when running on a shared network drive, it is recommended that your folder is on your local machine, e.g. in a project within ‘My Documents’. If you use Git (much recommended!), this will be familiar. For more details, see the handbook pages on <a href="r-on-network-drives.html#r-on-network-drives">R on network drives</a> and [Errors and help].</p>
<!-- ======================================================= -->
</div>
</div>
<div id="r-markdown-components" class="section level2" number="41.3">
<h2>
<span class="header-section-number">41.3</span> R Markdown components<a class="anchor" aria-label="anchor" href="#r-markdown-components"><i class="fas fa-link"></i></a>
</h2>
<p>An R Markdown document can be edited in RStudio just like a standard R script. When you start a new R Markdown script, RStudio tries to be helpful by showing a template which explains the different section of an R Markdown script.</p>
<p>The below is what appears when starting a new Rmd script intended to produce an html output (as per previous section).</p>
<div class="inline-figure"><img src="images/markdown/2_defaultRMD.png" width="100%" style="display: block; margin: auto;"></div>
<p>As you can see, there are three basic components to an Rmd file: YAML, Markdown text, and R code chunks.</p>
<p>These will <em>create and become your document output</em>. See the diagram below:</p>
<div class="inline-figure"><img src="images/markdown/rmarkdown_translation.png" width="100%" height="150%" style="display: block; margin: auto;"></div>
<div id="yaml-metadata" class="section level3 unnumbered">
<h3>YAML metadata<a class="anchor" aria-label="anchor" href="#yaml-metadata"><i class="fas fa-link"></i></a>
</h3>
<p>Referred to as the ‘YAML metadata’ or just ‘YAML’, this is at the top of the R Markdown document. This section of the script will tell your Rmd file what type of output to produce, formatting preferences, and other metadata such as document title, author, and date. There are other uses not mentioned here (but referred to in ‘Producing an output’). Note that indentation matters; tabs are not accepted but spaces are.</p>
<p>This section must begin with a line containing just three dashes <code>---</code> and must close with a line containing just three dashes <code>---</code>. YAML parameters comes in <code>key:value</code> pairs. The placement of colons in YAML is important - the <code>key:value</code> pairs are separated by colons (not equals signs!).</p>
<p>The YAML should begin with metadata for the document. The order of these primary YAML parameters (not indented) does not matter. For example:</p>
<div class="sourceCode" id="cb1674"><pre class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb1674-1"><a href="r-markdown-reports.html#cb1674-1" aria-hidden="true" tabindex="-1"></a><span class="fu">title</span><span class="kw">:</span><span class="at"> </span><span class="st">"My document"</span></span>
<span id="cb1674-2"><a href="r-markdown-reports.html#cb1674-2" aria-hidden="true" tabindex="-1"></a><span class="fu">author</span><span class="kw">:</span><span class="at"> </span><span class="st">"Me"</span></span>
<span id="cb1674-3"><a href="r-markdown-reports.html#cb1674-3" aria-hidden="true" tabindex="-1"></a><span class="fu">date</span><span class="kw">:</span><span class="at"> </span><span class="st">"2021-04-27"</span></span></code></pre></div>
<p>You can use R code in YAML values by writing it as in-line code (preceded by <code>r</code> within back-ticks) but also within quotes (see above example for <code>date:</code>).</p>
<p>In the image above, because we clicked that our default output would be an html file, we can see that the YAML says <code>output: html_document</code>. However we can also change this to say <code>powerpoint_presentation</code> or <code>word_document</code> or even <code>pdf_document</code>.</p>
</div>
<div id="text" class="section level3 unnumbered">
<h3>Text<a class="anchor" aria-label="anchor" href="#text"><i class="fas fa-link"></i></a>
</h3>
<p>This is the narrative of your document, including the titles and headings. It is written in the “markdown” language, which is used across many different software.</p>
<p>Below are the core ways to write this text. See more extensive documentation available on R Markdown “cheatsheet” at the <a href="https://rstudio.com/resources/cheatsheets/">RStudio website</a>.</p>
<div id="new-lines" class="section level4 unnumbered">
<h4>New lines<a class="anchor" aria-label="anchor" href="#new-lines"><i class="fas fa-link"></i></a>
</h4>
<p>Uniquely in R Markdown, to initiate a new line, enter *two spaces** at the end of the previous line and then Enter/Return.</p>
</div>
<div id="case" class="section level4 unnumbered">
<h4>Case<a class="anchor" aria-label="anchor" href="#case"><i class="fas fa-link"></i></a>
</h4>
<p>Surround your normal text with these character to change how it appears in the output.</p>
<ul>
<li>Underscores (<code>_text_</code>) or single asterisk (<code>*text*</code>) to <em>italicise</em>
</li>
<li>Double asterisks (<code>**text**</code>) for <strong>bold text</strong>
</li>
<li>Back-ticks (<code>text</code>) to display text as code</li>
</ul>
<p>The actual appearance of the font can be set by using specific templates (specified in the YAML metadata; see example tabs).</p>
</div>
<div id="color" class="section level4 unnumbered">
<h4>Color<a class="anchor" aria-label="anchor" href="#color"><i class="fas fa-link"></i></a>
</h4>
<p>There is no simple mechanism to change the color of text in R Markdown. One work-around, <em>IF your output is an HTML file</em>, is to add an HTML line into the markdown text. The below HTML code will print a line of text in bold red.</p>
<div class="sourceCode" id="cb1675"><pre class="sourceCode md"><code class="sourceCode markdown"><span id="cb1675-1"><a href="r-markdown-reports.html#cb1675-1" aria-hidden="true" tabindex="-1"></a><span class="kw">&lt;span</span><span class="ot"> style=</span><span class="st">"color: red;"</span><span class="kw">&gt;</span>**_DANGER:_** This is a warning.<span class="kw">&lt;/span&gt;</span>  </span></code></pre></div>
</div>
<div id="titles-and-headings" class="section level4 unnumbered">
<h4>Titles and headings<a class="anchor" aria-label="anchor" href="#titles-and-headings"><i class="fas fa-link"></i></a>
</h4>
<p>A hash symbol in a text portion of a R Markdown script creates a heading. This is different than in a chunk of R code in the script, in which a hash symbol is a mechanism to comment/annotate/de-activate, as in a normal R script.</p>
<p>Different heading levels are established with different numbers of hash symbols at the start of a new line. One hash symbol is a title or primary heading. Two hash symbols are a second-level heading. Third- and fourth-level headings can be made with successively more hash symbols.</p>
<div class="sourceCode" id="cb1676"><pre class="sourceCode md"><code class="sourceCode markdown"><span id="cb1676-1"><a href="r-markdown-reports.html#cb1676-1" aria-hidden="true" tabindex="-1"></a><span class="fu"># First-level heading / title</span></span>
<span id="cb1676-2"><a href="r-markdown-reports.html#cb1676-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1676-3"><a href="r-markdown-reports.html#cb1676-3" aria-hidden="true" tabindex="-1"></a><span class="fu">## Second level heading  </span></span>
<span id="cb1676-4"><a href="r-markdown-reports.html#cb1676-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1676-5"><a href="r-markdown-reports.html#cb1676-5" aria-hidden="true" tabindex="-1"></a><span class="fu">### Third-level heading</span></span></code></pre></div>
</div>
<div id="bullets-and-numbering" class="section level4 unnumbered">
<h4>Bullets and numbering<a class="anchor" aria-label="anchor" href="#bullets-and-numbering"><i class="fas fa-link"></i></a>
</h4>
<p>Use asterisks (<code><a href="https://rdrr.io/r/base/Arithmetic.html">*</a></code>) to created a bullets list. Finish the previous sentence, enter two spaces, Enter/Return <em>twice</em>, and then start your bullets. Include a space between the asterisk and your bullet text. After each bullet enter two spaces and then Enter/Return. Sub-bullets work the same way but are indented. Numbers work the same way but instead of an asterisk, write 1), 2), etc. Below is how your R Markdown script text might look.</p>
<div class="sourceCode" id="cb1677"><pre class="sourceCode md"><code class="sourceCode markdown"><span id="cb1677-1"><a href="r-markdown-reports.html#cb1677-1" aria-hidden="true" tabindex="-1"></a>Here are my bullets (there are two spaces after this colon):  </span>
<span id="cb1677-2"><a href="r-markdown-reports.html#cb1677-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1677-3"><a href="r-markdown-reports.html#cb1677-3" aria-hidden="true" tabindex="-1"></a><span class="ss">* </span>Bullet 1 (followed by two spaces and Enter/Return)  </span>
<span id="cb1677-4"><a href="r-markdown-reports.html#cb1677-4" aria-hidden="true" tabindex="-1"></a><span class="ss">* </span>Bullet 2 (followed by two spaces and Enter/Return)  </span>
<span id="cb1677-5"><a href="r-markdown-reports.html#cb1677-5" aria-hidden="true" tabindex="-1"></a><span class="ss">  * </span>Sub-bullet 1 (followed by two spaces and Enter/Return)  </span>
<span id="cb1677-6"><a href="r-markdown-reports.html#cb1677-6" aria-hidden="true" tabindex="-1"></a><span class="ss">  * </span>Sub-bullet 2 (followed by two spaces and Enter/Return)  </span>
<span id="cb1677-7"><a href="r-markdown-reports.html#cb1677-7" aria-hidden="true" tabindex="-1"></a>  </span></code></pre></div>
</div>
<div id="comment-out-text" class="section level4 unnumbered">
<h4>Comment out text<a class="anchor" aria-label="anchor" href="#comment-out-text"><i class="fas fa-link"></i></a>
</h4>
<p>You can “comment out” R Markdown text just as you can use the “#” to comment out a line of R code in an R chunk. Simply highlight the text and press Ctrl+Shift+c (Cmd+Shift+c for Mac). The text will be surrounded by arrows and turn green. It will not appear in your output.</p>
<div class="inline-figure"><img src="images/markdown/rmarkdown_hide_text.png" width="100%" style="display: block; margin: auto;"></div>
</div>
</div>
<div id="code-chunks" class="section level3 unnumbered">
<h3>Code chunks<a class="anchor" aria-label="anchor" href="#code-chunks"><i class="fas fa-link"></i></a>
</h3>
<p>Sections of the script that are dedicated to running R code are called “chunks”. This is where you may load packages, import data, and perform the actual data management and visualisation. There may be many code chunks, so they can help you organize your R code into parts, perhaps interspersed with text. To note:
These ‘chunks’ will appear to have a slightly different background colour from the narrative part of the document.</p>
<p>Each chunk is opened with a line that starts with three back-ticks, and curly brackets that contain parameters for the chunk (<code>{ }</code>). The chunk ends with three more back-ticks.</p>
<p>You can create a new chunk by typing it out yourself, by using the keyboard shortcut “Ctrl + Alt + i” (or Cmd + Shift + r in Mac), or by clicking the green ‘insert a new code chunk’ icon at the top of your script editor.</p>
<p>Some notes about the contents of the curly brackets <code>{ }</code>:</p>
<ul>
<li>They start with ‘r’ to indicate that the language name within the chunk is R</li>
<li>After the r you can optionally write a chunk “name” – these are not necessary but can help you organise your work. Note that if you name your chunks, you should ALWAYS use unique names or else R will complain when you try to render.<br>
</li>
<li>The curly brackets can include other options too, written as <code>tag=value</code>, such as:<br>
</li>
<li>
<code>eval = FALSE</code> to not run the R code<br>
</li>
<li>
<code>echo = FALSE</code> to not print the chunk’s R source code in the output document<br>
</li>
<li>
<code>warning = FALSE</code> to not print warnings produced by the R code<br>
</li>
<li>
<code>message = FALSE</code> to not print any messages produced by the R code<br>
</li>
<li>
<code>include =</code> either TRUE/FALSE whether to include chunk outputs (e.g. plots) in the document</li>
<li>
<code>out.width =</code> and <code>out.height =</code> - provide in style <code>out.width = "75%"</code><br>
</li>
<li>
<code>fig.align = "center"</code> adjust how a figure is aligned across the page<br>
</li>
<li>
<code>fig.show='hold'</code> if your chunk prints multiple figures and you want them printed next to each other (pair with <code>out.width = c("33%", "67%")</code>. Can also set as <code>fig.show='asis'</code> to show them below the code that generates them, <code>'hide'</code> to hide, or <code>'animate'</code> to concatenate multiple into an animation.<br>
</li>
<li>A chunk header must be written in <em>one line</em><br>
</li>
<li>Try to avoid periods, underscores, and spaces. Use hyphens ( - ) instead if you need a separator.</li>
</ul>
<p>Read more extensively about the <strong>knitr</strong> options <a href="https://yihui.org/knitr/options/">here</a>.</p>
<p>Some of the above options can be configured with point-and-click using the setting buttons at the top right of the chunk. Here, you can specify which parts of the chunk you want the rendered document to include, namely the code, the outputs, and the warnings. This will come out as written preferences within the curly brackets, e.g. ‘echo=FALSE’ if you specify you want to ‘Show output only’.</p>
<div class="inline-figure"><img src="images/markdown/3_chunk.png" width="80%" style="display: block; margin: auto;"></div>
<p>There are also two arrows at the top right of each chunk, which are useful to run code within a chunk, or all code in prior chunks. Hover over them to see what they do.</p>
<p>For global options to be applied to all chunks in the script, you can set this up within your very first R code chunk in the script. For instance, so that only the outputs are shown for each code chunk and not the code itself, you can include this command in the R code chunk:</p>
<div class="sourceCode" id="cb1678"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">knitr</span><span class="fu">::</span><span class="va"><a href="https://rdrr.io/pkg/knitr/man/opts_chunk.html">opts_chunk</a></span><span class="op">$</span><span class="fu">set</span><span class="op">(</span>echo <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span> </code></pre></div>
<div id="in-text-r-code" class="section level4 unnumbered">
<h4>In-text R code<a class="anchor" aria-label="anchor" href="#in-text-r-code"><i class="fas fa-link"></i></a>
</h4>
<p>You can also include minimal R code within back-ticks. Within the back-ticks, begin the code with “r” and a space, so RStudio knows to evaluate the code as R code. See the example below.</p>
<p>The example below shows multiple heading levels, bullets, and uses R code for the current date (<code><a href="https://rdrr.io/r/base/Sys.time.html">Sys.Date()</a></code>) to evaluate into a printed date.</p>
<div class="inline-figure">
<img src="images/markdown/2_text.png" width="80%" style="display: block; margin: auto;">
The example above is simple (showing the current date), but using the same syntax you can display values produced by more complex R code (e.g. to calculate the min, median, max of a column). You can also integrate R objects or values that were created in R code chunks earlier in the script.</div>
<p>As an example, the script below calculates the proportion of cases that are aged less than 18 years old, using <strong>tidyverse</strong> functions, and creates the objects <code>less18</code>, <code>total</code>, and <code>less18prop</code>. This dynamic value is inserted into subsequent text. We see how it looks when knitted to a word document.</p>
<div class="inline-figure"><img src="images/markdown/3_chunktext.png" width="100%" style="display: block; margin: auto;"></div>
</div>
</div>
<div id="images" class="section level3 unnumbered">
<h3>Images<a class="anchor" aria-label="anchor" href="#images"><i class="fas fa-link"></i></a>
</h3>
<p>You can include images in your R Markdown one of two ways:</p>
<div class="sourceCode" id="cb1679"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1679-1"><a href="r-markdown-reports.html#cb1679-1" aria-hidden="true" tabindex="-1"></a><span class="sc">!</span>[](<span class="st">"path/to/image.png"</span>)  </span></code></pre></div>
<p>If the above does not work, try using <code><a href="https://rdrr.io/pkg/knitr/man/include_graphics.html">knitr::include_graphics()</a></code></p>
<div class="sourceCode" id="cb1680"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/include_graphics.html">include_graphics</a></span><span class="op">(</span><span class="st">"path/to/image.png"</span><span class="op">)</span></code></pre></div>
<p>(remember, your file path could be written using the <strong>here</strong> package)</p>
<div class="sourceCode" id="cb1681"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/include_graphics.html">include_graphics</a></span><span class="op">(</span><span class="fu">here</span><span class="fu">::</span><span class="fu"><a href="https://here.r-lib.org//reference/here.html">here</a></span><span class="op">(</span><span class="st">"path"</span>, <span class="st">"to"</span>, <span class="st">"image.png"</span><span class="op">)</span><span class="op">)</span></code></pre></div>
</div>
<div id="tables" class="section level3 unnumbered">
<h3>Tables<a class="anchor" aria-label="anchor" href="#tables"><i class="fas fa-link"></i></a>
</h3>
<p>Create a table using hyphens ( - ) and bars ( | ). The number of hyphens before/between bars allow the number of spaces in the cell before the text begins to wrap.</p>
<div class="sourceCode" id="cb1682"><pre class="sourceCode md"><code class="sourceCode markdown"><span id="cb1682-1"><a href="r-markdown-reports.html#cb1682-1" aria-hidden="true" tabindex="-1"></a>Column 1 |Column  2 |Column 3</span>
<span id="cb1682-2"><a href="r-markdown-reports.html#cb1682-2" aria-hidden="true" tabindex="-1"></a>---------|----------|--------</span>
<span id="cb1682-3"><a href="r-markdown-reports.html#cb1682-3" aria-hidden="true" tabindex="-1"></a>Cell A   |Cell B    |Cell C</span>
<span id="cb1682-4"><a href="r-markdown-reports.html#cb1682-4" aria-hidden="true" tabindex="-1"></a>Cell D   |Cell E    |Cell F</span></code></pre></div>
<p>The above code produces the table below:</p>
<div class="inline-table"><table class="table table-sm">
<thead><tr class="header">
<th>Column 1</th>
<th>Column 2</th>
<th>Column 3</th>
</tr></thead>
<tbody>
<tr class="odd">
<td>Cell A</td>
<td>Cell B</td>
<td>Cell C</td>
</tr>
<tr class="even">
<td>Cell D</td>
<td>Cell E</td>
<td>Cell F</td>
</tr>
</tbody>
</table></div>
</div>
</div>
<div id="producing-the-document" class="section level2" number="41.4">
<h2>
<span class="header-section-number">41.4</span> Producing the document<a class="anchor" aria-label="anchor" href="#producing-the-document"><i class="fas fa-link"></i></a>
</h2>
<p>You can produce the document in the following ways:</p>
<ul>
<li>By command via the <code>render()</code> function from the <strong>rmarkdown</strong> package (executed outside the R Markdown script)<br>
</li>
<li>Manually by pressing the “Knit” button at the top of the RStudio script editor</li>
</ul>
<div id="option-1-render-command" class="section level3 unnumbered">
<h3>Option 1: <code>render()</code> command<a class="anchor" aria-label="anchor" href="#option-1-render-command"><i class="fas fa-link"></i></a>
</h3>
<p>One way to produce your R Markdown output is to run the <code>render()</code> function from the <strong>rmarkdown</strong> package. You must execute this command <em>outside</em> the R Markdown script - so either in a separate R script (often called a “run file”), or as a stand-alone command in the R Console.</p>
<div class="sourceCode" id="cb1683"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">rmarkdown</span><span class="fu">::</span><span class="fu"><a href="https://pkgs.rstudio.com/rmarkdown/reference/render.html">render</a></span><span class="op">(</span>input <span class="op">=</span> <span class="st">"my_report.Rmd"</span><span class="op">)</span></code></pre></div>
<p>With its default settings, running this command will save the Rmd output to the same folder as the Rmd script, with the same file name (aside from the file extension). For instance “my_report.Rmd” when knitted will create “my_report.docx” if you are knitting to a word document.</p>
<p><code>render()</code> can accept other optional arguments, including:</p>
<ul>
<li>
<code>output_format =</code> This is the output format to convert to (e.g. <code>"html_document"</code>, <code>"pdf_document"</code>, <code>"word_document"</code>, or <code>"all"</code>). You can also specify this in the YAML inside the R Markdown script.<br>
</li>
<li>
<code>output_file =</code> This is the name of the output file (and file path). This can be created via R functions like <code><a href="https://here.r-lib.org//reference/here.html">here()</a></code> or <code>str_glue()</code> as demonstrated below.<br>
</li>
<li>
<code>output_dir =</code> This is an output directory (folder) to save the file. This allows you to chose an alternative other than the directory the Rmd file is saved to.<br>
</li>
<li>
<code>output_options =</code> You can provide a list of options that will override those in the script YAML (e.g. )</li>
<li>
<code>output_yaml =</code> You can provide path to a .yml file that contains YAML specifications<br>
</li>
<li>
<code>params =</code> See the section on parameters below<br>
</li>
<li>See the complete list <a href="https://pkgs.rstudio.com/rmarkdown/reference/render.html"></a>
</li>
</ul>
<p>As one example, to improve version control, the following command will save the output file within an ‘outputs’ sub-folder, with the current date in the file name. To create the file name, the function <code>str_glue()</code> from the <strong>stringr</strong> package is use to ‘glue’ together static strings (written plainly) with dynamic R code (written in curly brackets). For instance if it is April 10th 2021, the file name from below will be “Report_2021-04-10.docx”. See the page on <a href="characters-and-strings.html#characters-and-strings">Characters and strings</a> for more details on <code>str_glue()</code>.</p>
<div class="sourceCode" id="cb1684"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">rmarkdown</span><span class="fu">::</span><span class="fu"><a href="https://pkgs.rstudio.com/rmarkdown/reference/render.html">render</a></span><span class="op">(</span>
  input <span class="op">=</span> <span class="st">"create_output.Rmd"</span>,
  output_file <span class="op">=</span> <span class="fu">stringr</span><span class="fu">::</span><span class="fu"><a href="https://stringr.tidyverse.org/reference/str_glue.html">str_glue</a></span><span class="op">(</span><span class="st">"outputs/Report_{Sys.Date()}.docx"</span><span class="op">)</span><span class="op">)</span> </code></pre></div>
<p>As the file renders, the RStudio Console will show you the rendering progress up to 100%, and a final message to indicate that the rendering is complete.</p>
</div>
<div id="option-2-knit-button" class="section level3 unnumbered">
<h3>Option 2: “Knit” button<a class="anchor" aria-label="anchor" href="#option-2-knit-button"><i class="fas fa-link"></i></a>
</h3>
<p>When you have the Rmd file open, press the ‘Knit’ icon/button at the top of the file. This is RStudio’s shortcut button for the <code>render()</code> function of <strong>rmarkdown</strong>. This is only compatible with a self-contained R markdown, where all the needed components exist or are sourced within the file.</p>
<p>Just like knitting with a separate script, R Studio will you show the progress of the Rmd file. Except this time, this will appear within an ‘R Markdown’ tab in the same panel as your console. A complete document will automatically open when complete and this document will be saved in the same folder as your markdown, and with the same file name aside from the file extension. This is obviously not ideal for version control, as you will then need to rename the file yourself.</p>
<div class="inline-figure"><img src="images/markdown/4_progress.png" width="90%" style="display: block; margin: auto;"></div>
<!-- ======================================================= -->
</div>
</div>
<div id="parameterised-reports" class="section level2" number="41.5">
<h2>
<span class="header-section-number">41.5</span> Parameterised reports<a class="anchor" aria-label="anchor" href="#parameterised-reports"><i class="fas fa-link"></i></a>
</h2>
<p>You can use parameterisation to make a report dynamic, such that it can be run with specific setting (e.g. a specific date or place or with certain knitting options). Below, we focus on the basics, but there is more <a href="https://bookdown.org/yihui/rmarkdown/parameterized-reports.html">detail online</a> about parameterized reports.</p>
<p>Using the Ebola linelist as an example, let’s say we want to run a standard surveillance report for each hospital each day. We show how one can do this using parameters.</p>
<p><em>Important: dynamic reports are also possible without the formal parameter structure (without <code>params:</code>), using simple R objects in an adjacent R script. This is explain at the end of this section.</em></p>
<div id="setting-parameters" class="section level3 unnumbered">
<h3>Setting parameters<a class="anchor" aria-label="anchor" href="#setting-parameters"><i class="fas fa-link"></i></a>
</h3>
<p>You have several options for specifying parameter values for your R Markdown output.</p>
<div id="option-1-set-parameters-within-yaml" class="section level4 unnumbered">
<h4>Option 1: Set parameters within YAML<a class="anchor" aria-label="anchor" href="#option-1-set-parameters-within-yaml"><i class="fas fa-link"></i></a>
</h4>
<p>Edit the YAML to include a <code>params:</code> option, with indented statements for each parameter you want to define. In this example we create parameters <code>date</code> and <code>hospital</code>, for which we specify values. These values are subject to change each time the report is run. If you use the “Knit” button to produce the output, the parameters will have these default values. Likewise, if you use <code>render()</code> the parameters will have these default values unless otherwise specified in the <code>render()</code> command.</p>
<div class="sourceCode" id="cb1685"><pre class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb1685-1"><a href="r-markdown-reports.html#cb1685-1" aria-hidden="true" tabindex="-1"></a><span class="pp">---</span></span>
<span id="cb1685-2"><a href="r-markdown-reports.html#cb1685-2" aria-hidden="true" tabindex="-1"></a><span class="fu">title</span><span class="kw">:</span><span class="at"> Surveillance report</span></span>
<span id="cb1685-3"><a href="r-markdown-reports.html#cb1685-3" aria-hidden="true" tabindex="-1"></a><span class="fu">output</span><span class="kw">:</span><span class="at"> html_document</span></span>
<span id="cb1685-4"><a href="r-markdown-reports.html#cb1685-4" aria-hidden="true" tabindex="-1"></a><span class="fu">params</span><span class="kw">:</span></span>
<span id="cb1685-5"><a href="r-markdown-reports.html#cb1685-5" aria-hidden="true" tabindex="-1"></a><span class="at"> </span><span class="fu">date</span><span class="kw">:</span><span class="at"> 2021-04-10</span></span>
<span id="cb1685-6"><a href="r-markdown-reports.html#cb1685-6" aria-hidden="true" tabindex="-1"></a><span class="at"> </span><span class="fu">hospital</span><span class="kw">:</span><span class="at"> Central Hospital</span></span>
<span id="cb1685-7"><a href="r-markdown-reports.html#cb1685-7" aria-hidden="true" tabindex="-1"></a><span class="pp">---</span></span></code></pre></div>
<p>In the background, these parameter values are contained within a read-only list called <code>params</code>. Thus, you can insert the parameter values in R code as you would another R object/value in your environment. Simply type <code>params$</code> followed by the parameter name. For example <code>params$hospital</code> to represent the hospital name (“Central Hospital” by default).</p>
<p>Note that parameters can also hold values <code>true</code> or <code>false</code>, and so these can be included in your <strong>knitr</strong> options for a R chunk. For example, you can set <code>{r, eval=params$run}</code> instead of <code>{r, eval=FALSE}</code>, and now whether the chunk runs or not depends on the value of a parameter <code>run:</code>.</p>
<p>Note that for parameters that are dates, they will be input as a string. So for <code>params$date</code> to be interpreted in R code it will likely need to be wrapped with <code><a href="https://rdrr.io/r/base/as.Date.html">as.Date()</a></code> or a similar function to convert to class Date.</p>
</div>
<div id="option-2-set-parameters-within-render" class="section level4 unnumbered">
<h4>Option 2: Set parameters within <code>render()</code><a class="anchor" aria-label="anchor" href="#option-2-set-parameters-within-render"><i class="fas fa-link"></i></a>
</h4>
<p>As mentioned above, as alternative to pressing the “Knit” button to produce the output is to execute the <code>render()</code> function from a separate script. In this later case, you can specify the parameters to be used in that rendering to the <code>params =</code> argument of <code>render()</code>.</p>
<p>Note than any parameter values provided here will <em>overwrite</em> their default values if written within the YAML. We write the values in quotation marks as in this case they should be defined as character/string values.</p>
<p>The below command renders “surveillance_report.Rmd”, specifies a dynamic output file name and folder, and provides a <code><a href="https://rdrr.io/r/base/list.html">list()</a></code> of two parameters and their values to the argument <code>params =</code>.</p>
<div class="sourceCode" id="cb1686"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu">rmarkdown</span><span class="fu">::</span><span class="fu"><a href="https://pkgs.rstudio.com/rmarkdown/reference/render.html">render</a></span><span class="op">(</span>
  input <span class="op">=</span> <span class="st">"surveillance_report.Rmd"</span>,  
  output_file <span class="op">=</span> <span class="fu">stringr</span><span class="fu">::</span><span class="fu"><a href="https://stringr.tidyverse.org/reference/str_glue.html">str_glue</a></span><span class="op">(</span><span class="st">"outputs/Report_{Sys.Date()}.docx"</span><span class="op">)</span>,
  params <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>date <span class="op">=</span> <span class="st">"2021-04-10"</span>, hospital  <span class="op">=</span> <span class="st">"Central Hospital"</span><span class="op">)</span><span class="op">)</span></code></pre></div>
</div>
<div id="option-3-set-parameters-using-a-graphical-user-interface" class="section level4 unnumbered">
<h4>Option 3: Set parameters using a Graphical User Interface<a class="anchor" aria-label="anchor" href="#option-3-set-parameters-using-a-graphical-user-interface"><i class="fas fa-link"></i></a>
</h4>
<p>For a more interactive feel, you can also use the Graphical User Interface (GUI) to manually select values for parameters. To do this we can click the drop-down menu next to the ‘Knit’ button and choose ‘Knit with parameters’.</p>
<p>A pop-up will appear allowing you to type in values for the parameters that are established in the document’s YAML.</p>
<div class="inline-figure"><img src="images/markdown/5_parametersGUI.png" width="50%" style="display: block; margin: auto;"></div>
<p>You can achieve the same through a <code>render()</code> command by specifying <code>params = "ask"</code>, as demonstrated below.</p>
<div class="sourceCode" id="cb1687"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1687-1"><a href="r-markdown-reports.html#cb1687-1" aria-hidden="true" tabindex="-1"></a>rmarkdown<span class="sc">::</span><span class="fu">render</span>(</span>
<span id="cb1687-2"><a href="r-markdown-reports.html#cb1687-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">input =</span> <span class="st">"surveillance_report.Rmd"</span>,  </span>
<span id="cb1687-3"><a href="r-markdown-reports.html#cb1687-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">output_file =</span> stringr<span class="sc">::</span><span class="fu">str_glue</span>(<span class="st">"outputs/Report_{Sys.Date()}.docx"</span>),</span>
<span id="cb1687-4"><a href="r-markdown-reports.html#cb1687-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">params =</span> “ask”)</span></code></pre></div>
<p>However, typing values into this pop-up window is subject to error and spelling mistakes. You may prefer to add restrictions to the values that can be entered through drop-down menus. You can do this by adding in the YAML several specifications for each <code>params:</code> entry.</p>
<ul>
<li>
<code>label:</code> is how the title for that particular drop-down menu<br>
</li>
<li>
<code>value:</code> is the default (starting) value<br>
</li>
<li>
<code>input:</code> set to <code>select</code> for drop-down menu<br>
</li>
<li>
<code>choices:</code> Give the eligible values in the drop-down menu</li>
</ul>
<p>Below, these specifications are written for the <code>hospital</code> parameter.</p>
<div class="sourceCode" id="cb1688"><pre class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb1688-1"><a href="r-markdown-reports.html#cb1688-1" aria-hidden="true" tabindex="-1"></a><span class="pp">---</span></span>
<span id="cb1688-2"><a href="r-markdown-reports.html#cb1688-2" aria-hidden="true" tabindex="-1"></a><span class="fu">title</span><span class="kw">:</span><span class="at"> Surveillance report</span></span>
<span id="cb1688-3"><a href="r-markdown-reports.html#cb1688-3" aria-hidden="true" tabindex="-1"></a><span class="fu">output</span><span class="kw">:</span><span class="at"> html_document</span></span>
<span id="cb1688-4"><a href="r-markdown-reports.html#cb1688-4" aria-hidden="true" tabindex="-1"></a><span class="fu">params</span><span class="kw">:</span></span>
<span id="cb1688-5"><a href="r-markdown-reports.html#cb1688-5" aria-hidden="true" tabindex="-1"></a><span class="at"> </span><span class="fu">date</span><span class="kw">:</span><span class="at"> 2021-04-10</span></span>
<span id="cb1688-6"><a href="r-markdown-reports.html#cb1688-6" aria-hidden="true" tabindex="-1"></a><span class="at"> </span><span class="fu">hospital</span><span class="kw">:</span><span class="at"> </span></span>
<span id="cb1688-7"><a href="r-markdown-reports.html#cb1688-7" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">label</span><span class="kw">:</span><span class="at"> “Town:”</span></span>
<span id="cb1688-8"><a href="r-markdown-reports.html#cb1688-8" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">value</span><span class="kw">:</span><span class="at"> Central Hospital</span></span>
<span id="cb1688-9"><a href="r-markdown-reports.html#cb1688-9" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">input</span><span class="kw">:</span><span class="at"> select</span></span>
<span id="cb1688-10"><a href="r-markdown-reports.html#cb1688-10" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">choices</span><span class="kw">:</span><span class="at"> </span><span class="kw">[</span><span class="at">Central Hospital</span><span class="kw">,</span><span class="at"> Military Hospital</span><span class="kw">,</span><span class="at"> Port Hospital</span><span class="kw">,</span><span class="at"> St. Mark</span><span class="st">'s Maternity Hospital (SMMH)]</span></span>
<span id="cb1688-11"><a href="r-markdown-reports.html#cb1688-11" aria-hidden="true" tabindex="-1"></a><span class="st">---</span></span></code></pre></div>
<p>When knitting (either via the ‘knit with parameters’ button or by <code>render()</code>), the pop-up window will have drop-down options to select from.</p>
<div class="inline-figure"><img src="images/markdown/5_parametersGUIB.png" width="50%" style="display: block; margin: auto;"></div>
</div>
</div>
<div id="parameterized-example" class="section level3 unnumbered">
<h3>Parameterized example<a class="anchor" aria-label="anchor" href="#parameterized-example"><i class="fas fa-link"></i></a>
</h3>
<p>The following code creates parameters for <code>date</code> and <code>hospital</code>, which are used in the R Markdown as <code>params$date</code> and <code>params$hospital</code>, respectively.</p>
<p>In the resulting report output, see how the data are filtered to the specific hospital, and the plot title refers to the correct hospital and date. We use the “linelist_cleaned.rds” file here, but it would be particularly appropriate if the linelist itself also had a datestamp within it to align with parameterised date.</p>
<div class="inline-figure"><img src="images/markdown/6_Rmdexample.png" width="100%" style="display: block; margin: auto;"></div>
<p>Knitting this produces the final output with the default font and layout.</p>
<div class="inline-figure"><img src="images/markdown/6_RmdexampleB.png" width="80%" style="display: block; margin: auto;"></div>
</div>
<div id="parameterisation-without-params" class="section level3 unnumbered">
<h3>Parameterisation without <code>params</code><a class="anchor" aria-label="anchor" href="#parameterisation-without-params"><i class="fas fa-link"></i></a>
</h3>
<p>If you are rendering a R Markdown file with <code>render()</code> from a separate script, you can actually create the impact of parameterization without using the <code>params:</code> functionality.</p>
<p>For instance, in the <em>R script</em> that contains the <code>render()</code> command, you can simply define <code>hospital</code> and <code>date</code> as two R objects (values) before the <code>render()</code> command. In the R Markdown, you would not need to have a <code>params:</code> section in the YAML, and we would refer to the <code>date</code> object rather than <code>params$date</code> and <code>hospital</code> rather than <code>params$hospital</code>.</p>
<div class="sourceCode" id="cb1689"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># This is a R script that is separate from the R Markdown</span>

<span class="co"># define R objects</span>
<span class="va">hospital</span> <span class="op">&lt;-</span> <span class="st">"Central Hospital"</span>
<span class="va">date</span> <span class="op">&lt;-</span> <span class="st">"2021-04-10"</span>

<span class="co"># Render the R markdown</span>
<span class="fu">rmarkdown</span><span class="fu">::</span><span class="fu"><a href="https://pkgs.rstudio.com/rmarkdown/reference/render.html">render</a></span><span class="op">(</span>input <span class="op">=</span> <span class="st">"create_output.Rmd"</span><span class="op">)</span> </code></pre></div>
<p>Following this approach means means you can not “knit with parameters”, use the GUI, or include knitting options within the parameters. However it allows for simpler code, which may be advantageous.</p>
<!-- ======================================================= -->
</div>
</div>
<div id="looping-reports" class="section level2" number="41.6">
<h2>
<span class="header-section-number">41.6</span> Looping reports<a class="anchor" aria-label="anchor" href="#looping-reports"><i class="fas fa-link"></i></a>
</h2>
<p>We may want to run all options of a report at once, for instance a surveillance report for all hospital of interest within a single run, rather than specifying each hospital one by one. For this we need to work in a separate script outside the Rmd, and create a objects for today’s date and the list of hospital names to loop through.</p>
<div class="sourceCode" id="cb1690"><pre class="sourceCode md"><code class="sourceCode markdown"><span id="cb1690-1"><a href="r-markdown-reports.html#cb1690-1" aria-hidden="true" tabindex="-1"></a>hospital_list &lt;- c(“Central Hospital”, </span>
<span id="cb1690-2"><a href="r-markdown-reports.html#cb1690-2" aria-hidden="true" tabindex="-1"></a>                   “Military Hospital”, </span>
<span id="cb1690-3"><a href="r-markdown-reports.html#cb1690-3" aria-hidden="true" tabindex="-1"></a>                   “Port Hospital”, “</span>
<span id="cb1690-4"><a href="r-markdown-reports.html#cb1690-4" aria-hidden="true" tabindex="-1"></a>                   St. Mark's Maternity Hospital (SMMH)”) </span>
<span id="cb1690-5"><a href="r-markdown-reports.html#cb1690-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1690-6"><a href="r-markdown-reports.html#cb1690-6" aria-hidden="true" tabindex="-1"></a>refdate &lt;- Sys.Date() # today’s date</span></code></pre></div>
<p>We then feed this into the markdown using a loop, where we go through each item of the list. The letter <code>i</code> represents which item of the list is currently being iterated, such that <code>hospital_list[1]</code> would be “Central Hospital”. This information is also fed into the file name, such that the file name of the first iteration produced on April 10th 2021 would be “Report_Central Hospital2021-04-10.docx”, saved in the ‘output’ subfolder. In our examples, four files would be created for each day.</p>
<p>For instance, using the parameterisation discussed earlier:</p>
<div class="sourceCode" id="cb1691"><pre class="sourceCode md"><code class="sourceCode markdown"><span id="cb1691-1"><a href="r-markdown-reports.html#cb1691-1" aria-hidden="true" tabindex="-1"></a>for(i in 1:length(hospital_list)){</span>
<span id="cb1691-2"><a href="r-markdown-reports.html#cb1691-2" aria-hidden="true" tabindex="-1"></a>rmarkdown::render("surveillance_report.Rmd",</span>
<span id="cb1691-3"><a href="r-markdown-reports.html#cb1691-3" aria-hidden="true" tabindex="-1"></a>                  output_file = paste0("output/Report_", hospital_list<span class="co">[</span><span class="ot">i</span><span class="co">]</span>, refdate, ".docx"),</span>
<span id="cb1691-4"><a href="r-markdown-reports.html#cb1691-4" aria-hidden="true" tabindex="-1"></a>                  params = list(date = refdate, hospital  = hospital_list<span class="co">[</span><span class="ot">i</span><span class="co">]</span>))</span>
<span id="cb1691-5"><a href="r-markdown-reports.html#cb1691-5" aria-hidden="true" tabindex="-1"></a>}       </span></code></pre></div>
<p>The text and code within the Rmd itself will again refer to <code>params$date</code> and <code>params$hospital</code> to bring in the date and hospital name. The list items would not need to be referred to again within an interation.</p>
<p>If not using this strict form of parameterisation but saving objects to the environment, as discussed at the end of the parameterisation section, the render function would look like this:</p>
<div class="sourceCode" id="cb1692"><pre class="sourceCode md"><code class="sourceCode markdown"><span id="cb1692-1"><a href="r-markdown-reports.html#cb1692-1" aria-hidden="true" tabindex="-1"></a>for(i in 1:length(hospital_list)){</span>
<span id="cb1692-2"><a href="r-markdown-reports.html#cb1692-2" aria-hidden="true" tabindex="-1"></a>rmarkdown::render("surveillance_report.Rmd",</span>
<span id="cb1692-3"><a href="r-markdown-reports.html#cb1692-3" aria-hidden="true" tabindex="-1"></a>                  output_file = paste0("output/Report_", hospital_list<span class="co">[</span><span class="ot">i</span><span class="co">]</span>, refdate, ".docx")</span>
<span id="cb1692-4"><a href="r-markdown-reports.html#cb1692-4" aria-hidden="true" tabindex="-1"></a>}       </span></code></pre></div>
<p>The text within the markdown would then need to refer to <code>hospital_list[i]</code> and <code>refdate</code>.</p>
<!-- ======================================================= -->
</div>
<div id="file-structure" class="section level2" number="41.7">
<h2>
<span class="header-section-number">41.7</span> File structure<a class="anchor" aria-label="anchor" href="#file-structure"><i class="fas fa-link"></i></a>
</h2>
<p>There are several ways to structure your R Markdown and any associated R scripts. Each has advantages and disadvantages:</p>
<ul>
<li>Self-contained R Markdown - everything needed for the report is imported or created within the R Markdown
<ul>
<li>Source other files - You can run external R scripts with the <code><a href="https://rdrr.io/r/base/source.html">source()</a></code> command and use their outputs in the Rmd<br>
</li>
<li>Child scripts - an alternate mechanism for <code><a href="https://rdrr.io/r/base/source.html">source()</a></code><br>
</li>
</ul>
</li>
<li>Utilize a “runfile” - Run commands in an R script <em>prior to</em> rendering the R Markdown</li>
</ul>
<div id="self-contained-rmd" class="section level3 unnumbered">
<h3>Self-contained Rmd<a class="anchor" aria-label="anchor" href="#self-contained-rmd"><i class="fas fa-link"></i></a>
</h3>
<p>For a relatively simple report, you may elect to organize your R Markdown script such that it is “self-contained” and does not involve any external scripts.</p>
<p>Everything you need to run the R markdown is imported or created within the Rmd file, including all the code chunks and package loading. This “self-contained” approach is appropriate when you do not need to do much data processing (e.g. it brings in a clean or semi-clean data file) and the rendering of the R Markdown will not take too long.</p>
<p>In this scenario, one logical organization of the R Markdown script might be:</p>
<ol style="list-style-type: decimal">
<li>Set global <strong>knitr</strong> options<br>
</li>
<li>Load packages<br>
</li>
<li>Import data<br>
</li>
<li>Process data<br>
</li>
<li>Produce outputs (tables, plots, etc.)<br>
</li>
<li>Save outputs, if applicable (.csv, .png, etc.)</li>
</ol>
<div id="source-other-files" class="section level4 unnumbered">
<h4>Source other files<a class="anchor" aria-label="anchor" href="#source-other-files"><i class="fas fa-link"></i></a>
</h4>
<p>One variation of the “self-contained” approach is to have R Markdown code chunks “source” (run) other R scripts. This can make your R Markdown script less cluttered, more simple, and easier to organize. It can also help if you want to display final figures at the beginning of the report. In this approach, the final R Markdown script simply combines pre-processed outputs into a document.</p>
<p>One way to do this is by providing the R scripts (file path and name with extension) to the <strong>base</strong> R command <code><a href="https://rdrr.io/r/base/source.html">source()</a></code>.</p>
<div class="sourceCode" id="cb1693"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/source.html">source</a></span><span class="op">(</span><span class="st">"your-script.R"</span>, local <span class="op">=</span> <span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/knit_global.html">knit_global</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span>
<span class="co"># or sys.source("your-script.R", envir = knitr::knit_global())</span></code></pre></div>
<p>Note that when using <code><a href="https://rdrr.io/r/base/source.html">source()</a></code> <em>within</em> the R Markdown, the external files will still be run <em>during the course of rendering your Rmd file</em>. Therefore, each script is run every time you render the report. Thus, having these <code><a href="https://rdrr.io/r/base/source.html">source()</a></code> commands <em>within</em> the R Markdown does not speed up your run time, nor does it greatly assist with de-bugging, as error produced will still be printed when producing the R Markdown.</p>
<p>An alternative is to utilize the <code>child =</code> <strong>knitr</strong> option. EXPLAIN MORE TO DO</p>
<p>You must be aware of various R <em>environments</em>. Objects created within an environment will not necessarily be available to the environment used by the R Markdown.</p>
</div>
</div>
<div id="runfile" class="section level3 unnumbered">
<h3>Runfile<a class="anchor" aria-label="anchor" href="#runfile"><i class="fas fa-link"></i></a>
</h3>
<p>This approach involves utilizing the R script that contains the <code>render()</code> command(s) to pre-process objects that feed into the R markdown.</p>
<p>For instance, you can load the packages, load and clean the data, and even create the graphs of interest prior to <code>render()</code>. These steps can occur in the R script, or in other scripts that are sourced. As long as these commands occur in the same RStudio session and objects are saved to the environment, the objects can then be called within the Rmd content. Then the R markdown itself will only be used for the final step - to produce the output with all the pre-processed objects. This is much easier to de-bug if something goes wrong.</p>
<p>This approach is helpful for the following reasons:</p>
<ul>
<li>More informative error messages - these messages will be generated from the R script, not the R Markdown. R Markdown errors tend to tell you which chunk had a problem, but will not tell you which line.<br>
</li>
<li>If applicable, you can run long processing steps in advance of the <code>render()</code> command - they will run only once.</li>
</ul>
<p>In the example below, we have a separate R script in which we pre-process a <code>data</code> object into the R Environment and then render the “create_output.Rmd” using <code>render()</code>.</p>
<div class="sourceCode" id="cb1694"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/rio/man/import.html">import</a></span><span class="op">(</span><span class="st">"datafile.csv"</span><span class="op">)</span> <span class="op">%&gt;%</span>       <span class="co"># Load data and save to environment</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="va">age</span>, <span class="va">hospital</span>, <span class="va">weight</span><span class="op">)</span>          <span class="co"># Select limited columns</span>

<span class="fu">rmarkdown</span><span class="fu">::</span><span class="fu"><a href="https://pkgs.rstudio.com/rmarkdown/reference/render.html">render</a></span><span class="op">(</span>input <span class="op">=</span> <span class="st">"create_output.Rmd"</span><span class="op">)</span>   <span class="co"># Create Rmd file</span></code></pre></div>
</div>
<div id="folder-strucutre" class="section level3 unnumbered">
<h3>Folder strucutre<a class="anchor" aria-label="anchor" href="#folder-strucutre"><i class="fas fa-link"></i></a>
</h3>
<p>Workflow also concerns the overall folder structure, such as having an ‘output’ folder for created documents and figures, and ‘data’ or ‘inputs’ folders for cleaned data. We do not go into further detail here, but check out the <a href="organizing-routine-reports.html#organizing-routine-reports">Organizing routine reports</a> page.</p>
<!-- ======================================================= -->
</div>
</div>
<div id="formatting-and-aesthetics" class="section level2" number="41.8">
<h2>
<span class="header-section-number">41.8</span> Formatting and aesthetics<a class="anchor" aria-label="anchor" href="#formatting-and-aesthetics"><i class="fas fa-link"></i></a>
</h2>
<p>For easy aesthetics, create a template file which contains the desired formatting. You can create for instance an MS word or power point document which contains pages with the desired dimensions, watermarks, backgrounds, and fonts.</p>
<div id="word-documents" class="section level3 unnumbered">
<h3>Word documents<a class="anchor" aria-label="anchor" href="#word-documents"><i class="fas fa-link"></i></a>
</h3>
<p>To create a template, start a new word document (or use an existing output with formatting the suits you), and edit fonts by defining the Styles. In Style,Headings 1, 2, and 3 refer to the various markdown header levels (<code># Header 1</code>, <code>## Header 2</code> and <code>### Header 3</code> respectively). Right click on the style and click ‘modify’ to change the font formatting as well as the paragraph (e.g. you can introduce page breaks before certain styles which can help with spacing). Other aspects of the word document such as margins, page size, headers etc, can be changed like a usual word document you are working directly within.</p>
<div class="inline-figure"><img src="images/markdown/7_template.png" width="100%" style="display: block; margin: auto;"></div>
</div>
<div id="powerpoint-documents" class="section level3 unnumbered">
<h3>Powerpoint documents<a class="anchor" aria-label="anchor" href="#powerpoint-documents"><i class="fas fa-link"></i></a>
</h3>
<p>As above, create a new slideset or use an existing powerpoint file with the desired formatting. For further editing, click on ‘View’ and ‘Slide Master’. From here you can change the ‘master’ slide appearance by editing the text formatting in the text boxes, as well as the background/page dimensions for the overall page.</p>
<div class="inline-figure"><img src="images/markdown/8_ppttemplate.PNG" width="100%" style="display: block; margin: auto;"></div>
<p>Unfortunately, editing powerpoint files is slightly less flexible:</p>
<ul>
<li>A first level header (<code># Header 1</code>) will automatically become the title of a new slide,</li>
<li>A <code>## Header 2</code> text will not come up as a subtitle but text within the slide’s main textbox (unless you find a way to maniuplate the Master view).</li>
<li>Outputted plots and tables will automatically go into new slides. You will need to combine them, for instance the the <strong>patchwork</strong> function to combine ggplots, so that they show up on the same page.</li>
</ul>
</div>
<div id="integrating-templates-into-the-yaml" class="section level3 unnumbered">
<h3>Integrating templates into the YAML<a class="anchor" aria-label="anchor" href="#integrating-templates-into-the-yaml"><i class="fas fa-link"></i></a>
</h3>
<p>Once a template is prepared, the detail of this can be added in the YAML of the Rmd underneath the ‘output’ line and underneath where the document type is specified (which goes to a separate line itself). Note <code>reference_doc</code> can be used for powerpoint slide templates.</p>
<p>It is easiest to save the template in the same folder as where the Rmd file is (as in the example below), or in a subfolder within.</p>
<div class="sourceCode" id="cb1695"><pre class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb1695-1"><a href="r-markdown-reports.html#cb1695-1" aria-hidden="true" tabindex="-1"></a><span class="pp">---</span></span>
<span id="cb1695-2"><a href="r-markdown-reports.html#cb1695-2" aria-hidden="true" tabindex="-1"></a><span class="fu">title</span><span class="kw">:</span><span class="at"> Surveillance report</span></span>
<span id="cb1695-3"><a href="r-markdown-reports.html#cb1695-3" aria-hidden="true" tabindex="-1"></a><span class="fu">output</span><span class="kw">:</span><span class="at"> </span></span>
<span id="cb1695-4"><a href="r-markdown-reports.html#cb1695-4" aria-hidden="true" tabindex="-1"></a><span class="at"> </span><span class="fu">word_document</span><span class="kw">:</span></span>
<span id="cb1695-5"><a href="r-markdown-reports.html#cb1695-5" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">reference_docx</span><span class="kw">:</span><span class="at"> </span><span class="st">"template.docx"</span></span>
<span id="cb1695-6"><a href="r-markdown-reports.html#cb1695-6" aria-hidden="true" tabindex="-1"></a><span class="fu">params</span><span class="kw">:</span></span>
<span id="cb1695-7"><a href="r-markdown-reports.html#cb1695-7" aria-hidden="true" tabindex="-1"></a><span class="at"> </span><span class="fu">date</span><span class="kw">:</span><span class="at"> 2021-04-10</span></span>
<span id="cb1695-8"><a href="r-markdown-reports.html#cb1695-8" aria-hidden="true" tabindex="-1"></a><span class="at"> </span><span class="fu">hospital</span><span class="kw">:</span><span class="at"> Central Hospital</span></span>
<span id="cb1695-9"><a href="r-markdown-reports.html#cb1695-9" aria-hidden="true" tabindex="-1"></a><span class="fu">template</span><span class="kw">:</span></span>
<span id="cb1695-10"><a href="r-markdown-reports.html#cb1695-10" aria-hidden="true" tabindex="-1"></a><span class="at"> </span></span>
<span id="cb1695-11"><a href="r-markdown-reports.html#cb1695-11" aria-hidden="true" tabindex="-1"></a><span class="pp">---</span></span></code></pre></div>
</div>
<div id="formatting-html-files" class="section level3 unnumbered">
<h3>Formatting HTML files<a class="anchor" aria-label="anchor" href="#formatting-html-files"><i class="fas fa-link"></i></a>
</h3>
<p>HTML files do not use templates, but can have the styles configured within the YAML. HTMLs are interactive documents, and are particularly flexible. We cover some basic options here.</p>
<ul>
<li><p>Table of contents: We can add a table of contents with <code>toc: true</code> below, and also specify that it remains viewable (“floats”) as you scroll, with <code>toc_float: true</code>.</p></li>
<li><p>Themes: We can refer to some pre-made themes, which come from a Bootswatch theme library. In the below example we use cerulean. Other options include: journal, flatly, darkly, readable, spacelab, united, cosmo, lumen, paper, sandstone, simplex, and yeti.</p></li>
<li><p>Highlight: Configuring this changes the look of highlighted text (e.g. code within chunks that are shown). Supported styles include default, tango, pygments, kate, monochrome, espresso, zenburn, haddock, breezedark, and textmate.</p></li>
</ul>
<p>Here is an example of how to integrate the above options into the YAML.</p>
<div class="sourceCode" id="cb1696"><pre class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb1696-1"><a href="r-markdown-reports.html#cb1696-1" aria-hidden="true" tabindex="-1"></a><span class="pp">---</span></span>
<span id="cb1696-2"><a href="r-markdown-reports.html#cb1696-2" aria-hidden="true" tabindex="-1"></a><span class="fu">title</span><span class="kw">:</span><span class="at"> </span><span class="st">"HTML example"</span></span>
<span id="cb1696-3"><a href="r-markdown-reports.html#cb1696-3" aria-hidden="true" tabindex="-1"></a><span class="fu">output</span><span class="kw">:</span></span>
<span id="cb1696-4"><a href="r-markdown-reports.html#cb1696-4" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">html_document</span><span class="kw">:</span></span>
<span id="cb1696-5"><a href="r-markdown-reports.html#cb1696-5" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">toc</span><span class="kw">:</span><span class="at"> </span><span class="ch">true</span></span>
<span id="cb1696-6"><a href="r-markdown-reports.html#cb1696-6" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">toc_float</span><span class="kw">:</span><span class="at"> </span><span class="ch">true</span></span>
<span id="cb1696-7"><a href="r-markdown-reports.html#cb1696-7" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">theme</span><span class="kw">:</span><span class="at"> cerulean</span></span>
<span id="cb1696-8"><a href="r-markdown-reports.html#cb1696-8" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">highlight</span><span class="kw">:</span><span class="at"> kate</span></span>
<span id="cb1696-9"><a href="r-markdown-reports.html#cb1696-9" aria-hidden="true" tabindex="-1"></a><span class="at">    </span></span>
<span id="cb1696-10"><a href="r-markdown-reports.html#cb1696-10" aria-hidden="true" tabindex="-1"></a><span class="pp">---</span></span></code></pre></div>
<p>Below are two examples of HTML outputs which both have floating tables of contents, but different theme and highlight styles selected:</p>
<div class="inline-figure"><img src="images/markdown/9_html.png" width="100%" style="display: block; margin: auto;"></div>
</div>
</div>
<div id="dynamic-content" class="section level2" number="41.9">
<h2>
<span class="header-section-number">41.9</span> Dynamic content<a class="anchor" aria-label="anchor" href="#dynamic-content"><i class="fas fa-link"></i></a>
</h2>
<div id="tables-1" class="section level3 unnumbered">
<h3>Tables<a class="anchor" aria-label="anchor" href="#tables-1"><i class="fas fa-link"></i></a>
</h3>
<p>In an HTML report, you can print data frame / tibbles such that the content is dynamic, with filters and scroll bars. There are several packages that offer this capability.</p>
<p>To do this with the <strong>DT</strong> package, as is used throughout this handbook, you can insert a code chunk like this:</p>
<div class="inline-figure"><img src="images/markdown/10_dynamictable.png" width="100%" style="display: block; margin: auto;"></div>
<p>The function <code>datatable()</code> will print the provided data frame as a dynamic table for the reader. You can set <code>rownames = FALSE</code> to simplify the far left-side of the table. <code>filter = "top"</code> provides a filter over each column. In the <code><a href="https://rdrr.io/r/base/options.html">option()</a></code> argument provide a list of other specifications. Below we include two: <code>pageLength = 5</code> set the number of rows that appear as 5 (the remaining rows can be viewed by paging through arrows), and <code>scrollX=TRUE</code> enables a scrollbar on the bottom of the table (for columns that extend too far to the right).</p>
<p>If your dataset is very large, consider only showing the top X rows by wrapping the data frame in <code><a href="https://rdrr.io/r/utils/head.html">head()</a></code>.</p>
<!-- ======================================================= -->
</div>
</div>
<div id="resources-34" class="section level2" number="41.10">
<h2>
<span class="header-section-number">41.10</span> Resources<a class="anchor" aria-label="anchor" href="#resources-34"><i class="fas fa-link"></i></a>
</h2>
<p>Further information can be found via:</p>
<ul>
<li><a href="https://bookdown.org/yihui/rmarkdown/" class="uri">https://bookdown.org/yihui/rmarkdown/</a></li>
<li><a href="https://rmarkdown.rstudio.com/articles_intro.html" class="uri">https://rmarkdown.rstudio.com/articles_intro.html</a></li>
</ul>
<p>A good explainer of markdown vs knitr vs Rmarkdown is here: <a href="https://stackoverflow.com/questions/40563479/relationship-between-r-markdown-knitr-pandoc-and-bookdown" class="uri">https://stackoverflow.com/questions/40563479/relationship-between-r-markdown-knitr-pandoc-and-bookdown</a></p>

</div>
</div>
  <div class="chapter-nav">
<div class="prev"><a href="interactive-plots.html"><span class="header-section-number">40</span> Interactive plots</a></div>
<div class="next"><a href="organizing-routine-reports.html"><span class="header-section-number">42</span> Organizing routine reports</a></div>
</div></main><div class="col-md-3 col-lg-2 d-none d-md-block sidebar sidebar-chapter">
    <nav id="toc" data-toggle="toc" aria-label="On this page"><h2>On this page</h2>
      <ul class="nav navbar-nav">
<li><a class="nav-link" href="#r-markdown-reports"><span class="header-section-number">41</span> R Markdown reports</a></li>
<li><a class="nav-link" href="#preparation-33"><span class="header-section-number">41.1</span> Preparation</a></li>
<li>
<a class="nav-link" href="#getting-started"><span class="header-section-number">41.2</span> Getting started</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#install-rmarkdown-r-package">Install rmarkdown R package</a></li>
<li><a class="nav-link" href="#starting-a-new-rmd-file">Starting a new Rmd file</a></li>
<li><a class="nav-link" href="#important-to-know">Important to know</a></li>
</ul>
</li>
<li>
<a class="nav-link" href="#r-markdown-components"><span class="header-section-number">41.3</span> R Markdown components</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#yaml-metadata">YAML metadata</a></li>
<li><a class="nav-link" href="#text">Text</a></li>
<li><a class="nav-link" href="#code-chunks">Code chunks</a></li>
<li><a class="nav-link" href="#images">Images</a></li>
<li><a class="nav-link" href="#tables">Tables</a></li>
</ul>
</li>
<li>
<a class="nav-link" href="#producing-the-document"><span class="header-section-number">41.4</span> Producing the document</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#option-1-render-command">Option 1: render() command</a></li>
<li><a class="nav-link" href="#option-2-knit-button">Option 2: “Knit” button</a></li>
</ul>
</li>
<li>
<a class="nav-link" href="#parameterised-reports"><span class="header-section-number">41.5</span> Parameterised reports</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#setting-parameters">Setting parameters</a></li>
<li><a class="nav-link" href="#parameterized-example">Parameterized example</a></li>
<li><a class="nav-link" href="#parameterisation-without-params">Parameterisation without params</a></li>
</ul>
</li>
<li><a class="nav-link" href="#looping-reports"><span class="header-section-number">41.6</span> Looping reports</a></li>
<li>
<a class="nav-link" href="#file-structure"><span class="header-section-number">41.7</span> File structure</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#self-contained-rmd">Self-contained Rmd</a></li>
<li><a class="nav-link" href="#runfile">Runfile</a></li>
<li><a class="nav-link" href="#folder-strucutre">Folder strucutre</a></li>
</ul>
</li>
<li>
<a class="nav-link" href="#formatting-and-aesthetics"><span class="header-section-number">41.8</span> Formatting and aesthetics</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#word-documents">Word documents</a></li>
<li><a class="nav-link" href="#powerpoint-documents">Powerpoint documents</a></li>
<li><a class="nav-link" href="#integrating-templates-into-the-yaml">Integrating templates into the YAML</a></li>
<li><a class="nav-link" href="#formatting-html-files">Formatting HTML files</a></li>
</ul>
</li>
<li>
<a class="nav-link" href="#dynamic-content"><span class="header-section-number">41.9</span> Dynamic content</a><ul class="nav navbar-nav"><li><a class="nav-link" href="#tables-1">Tables</a></li></ul>
</li>
<li><a class="nav-link" href="#resources-34"><span class="header-section-number">41.10</span> Resources</a></li>
</ul>

      <div class="book-extra">
        <ul class="list-unstyled">
          
        </ul>
</div>
    </nav>
</div>

</div>
</div> <!-- .container -->

<footer class="bg-primary text-light mt-5"><div class="container"><div class="row">

  <div class="col-12 col-md-6 mt-3">
    <p>"<strong>The Epidemiologist R Handbook</strong>" was written by the handbook team. It was last built on 2021-04-27.</p>
  </div>

  <div class="col-12 col-md-6 mt-3">
    <p>This book was built by the <a class="text-light" href="https://bookdown.org">bookdown</a> R package.</p>
  </div>

</div></div>
</footer><!-- dynamically load mathjax for compatibility with self-contained --><script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>
</html>
