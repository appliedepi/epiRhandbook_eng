<!DOCTYPE html>
<html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>7 Import and export | The Epidemiologist R Handbook</title>
<meta name="author" content="the handbook team">
<meta name="description" content="In this page we describe ways to locate, import, and export files: Use of the rio package to flexibly import() and export() many types of files Use of the here package to locate files relative to...">
<meta name="generator" content="bookdown 0.29 with bs4_book()">
<meta property="og:title" content="7 Import and export | The Epidemiologist R Handbook">
<meta property="og:type" content="book">
<meta property="og:description" content="In this page we describe ways to locate, import, and export files: Use of the rio package to flexibly import() and export() many types of files Use of the here package to locate files relative to...">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="7 Import and export | The Epidemiologist R Handbook">
<meta name="twitter:description" content="In this page we describe ways to locate, import, and export files: Use of the rio package to flexibly import() and export() many types of files Use of the here package to locate files relative to...">
<!-- JS --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://kit.fontawesome.com/6ecbd6c532.js" crossorigin="anonymous"></script><script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="libs/bootstrap-4.6.0/bootstrap.min.css" rel="stylesheet">
<script src="libs/bootstrap-4.6.0/bootstrap.bundle.min.js"></script><script src="libs/bs3compat-0.4.0/transition.js"></script><script src="libs/bs3compat-0.4.0/tabs.js"></script><script src="libs/bs3compat-0.4.0/bs3compat.js"></script><link href="libs/bs4_book-1.0.0/bs4_book.css" rel="stylesheet">
<script src="libs/bs4_book-1.0.0/bs4_book.js"></script><script src="libs/htmlwidgets-1.5.4/htmlwidgets.js"></script><link href="libs/datatables-css-0.0.0/datatables-crosstalk.css" rel="stylesheet">
<script src="libs/datatables-binding-0.24/datatables.js"></script><link href="libs/dt-core-1.11.3/css/jquery.dataTables.min.css" rel="stylesheet">
<link href="libs/dt-core-1.11.3/css/jquery.dataTables.extra.css" rel="stylesheet">
<script src="libs/dt-core-1.11.3/js/jquery.dataTables.min.js"></script><link href="libs/nouislider-7.0.10/jquery.nouislider.min.css" rel="stylesheet">
<script src="libs/nouislider-7.0.10/jquery.nouislider.min.js"></script><link href="libs/selectize-0.12.0/selectize.bootstrap3.css" rel="stylesheet">
<script src="libs/selectize-0.12.0/selectize.min.js"></script><link href="libs/crosstalk-1.2.0/css/crosstalk.min.css" rel="stylesheet">
<script src="libs/crosstalk-1.2.0/js/crosstalk.min.js"></script><!-- Global site tag (gtag.js) - Google Analytics --><script async src="https://www.googletagmanager.com/gtag/js?id=G-QXDW878QLX"></script><script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());

      gtag('config', 'G-QXDW878QLX');
    </script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- CSS --><style type="text/css">
    
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  </style>
<link rel="stylesheet" href="style_bs4.css">
</head>
<body data-spy="scroll" data-target="#toc">

<div class="container-fluid">
<div class="row">
  <header class="col-sm-12 col-lg-3 sidebar sidebar-book"><a class="sr-only sr-only-focusable" href="#content">Skip to main content</a>

    <div class="d-flex align-items-start justify-content-between">
      <h1>
        <a href="index.html" title="">The Epidemiologist R Handbook</a>
      </h1>
      <button class="btn btn-outline-primary d-lg-none ml-2 mt-1" type="button" data-toggle="collapse" data-target="#main-nav" aria-expanded="true" aria-controls="main-nav"><i class="fas fa-bars"></i><span class="sr-only">Show table of contents</span></button>
    </div>

    <div id="main-nav" class="collapse-lg">
      <form role="search">
        <input id="search" class="form-control" type="search" placeholder="Search" aria-label="Search">
</form>

      <nav aria-label="Table of contents"><h2>Table of contents</h2>
        <ul class="book-toc list-unstyled">
<li><a class="" href="index.html"></a></li>
<li class="book-part">About this book</li>
<li><a class="" href="editorial-and-technical-notes.html"><span class="header-section-number">1</span> Editorial and technical notes</a></li>
<li><a class="" href="download-handbook-and-data.html"><span class="header-section-number">2</span> Download handbook and data</a></li>
<li class="book-part">Preview pages</li>
<li><a class="" href="r-basics.html"><span class="header-section-number">3</span> R Basics</a></li>
<li><a class="" href="transition-to-r.html"><span class="header-section-number">4</span> Transition to R</a></li>
<li><a class="" href="suggested-packages-1.html"><span class="header-section-number">5</span> Suggested packages</a></li>
<li><a class="" href="r-projects.html"><span class="header-section-number">6</span> R projects</a></li>
<li><a class="active" href="import-and-export.html"><span class="header-section-number">7</span> Import and export</a></li>
<li class="book-part">Data Management</li>
<li><a class="" href="cleaning-data-and-core-functions.html"><span class="header-section-number">8</span> Cleaning data and core functions</a></li>
</ul>

        <div class="book-extra">
          
        </div>
      </nav>
</div>
  </header><main class="col-sm-12 col-md-9 col-lg-7" id="content"><div id="import-and-export" class="section level1" number="7">
<h1>
<span class="header-section-number">7</span> Import and export<a class="anchor" aria-label="anchor" href="#import-and-export"><i class="fas fa-link"></i></a>
</h1>
<div class="inline-figure"><img src="images/Import_Export_1500x500.png" width="100%"></div>
<p>In this page we describe ways to locate, import, and export files:</p>
<ul>
<li>Use of the <strong>rio</strong> package to flexibly <code><a href="https://rdrr.io/pkg/rio/man/import.html">import()</a></code> and <code><a href="https://rdrr.io/pkg/rio/man/export.html">export()</a></code> many types of files<br>
</li>
<li>Use of the <strong>here</strong> package to locate files relative to an R project root - to prevent complications from file paths that are specific to one computer<br>
</li>
<li>Specific import scenarios, such as:
<ul>
<li>Specific Excel sheets<br>
</li>
<li>Messy headers and skipping rows<br>
</li>
<li>From Google sheets<br>
</li>
<li>From data posted to websites<br>
</li>
<li>With APIs<br>
</li>
<li>Importing the <em>most recent</em> file<br>
</li>
</ul>
</li>
<li>Manual data entry<br>
</li>
<li>R-specific file types such as RDS and RData<br>
</li>
<li>Exporting/saving files and plots</li>
</ul>
<!-- ======================================================= --><div id="overview" class="section level2" number="7.1">
<h2>
<span class="header-section-number">7.1</span> Overview<a class="anchor" aria-label="anchor" href="#overview"><i class="fas fa-link"></i></a>
</h2>
<p>When you import a “dataset” into R, you are generally creating a new <em>data frame</em> object in your R environment and defining it as an imported file (e.g. Excel, CSV, TSV, RDS) that is located in your folder directories at a certain file path/address.</p>
<p>You can import/export many types of files, including those created by other statistical programs (SAS, STATA, SPSS). You can also connect to relational databases.</p>
<p>R even has its own data formats:</p>
<ul>
<li>An RDS file (.rds) stores a single R object such as a data frame. These are useful to store cleaned data, as they maintain R column classes. Read more in <a href="import-and-export.html#import_rds">this section</a>.<br>
</li>
<li>An RData file (.Rdata) can be used to store multiple objects, or even a complete R workspace. Read more in <a href="import-and-export.html#import_rdata">this section</a>.</li>
</ul>
<!-- ======================================================= -->
</div>
<div id="the-rio-package" class="section level2" number="7.2">
<h2>
<span class="header-section-number">7.2</span> The <strong>rio</strong> package<a class="anchor" aria-label="anchor" href="#the-rio-package"><i class="fas fa-link"></i></a>
</h2>
<p>The R package we recommend is: <strong>rio</strong>. The name “rio” is an abbreviation of “R I/O” (input/output).</p>
<p>Its functions <code><a href="https://rdrr.io/pkg/rio/man/import.html">import()</a></code> and <code><a href="https://rdrr.io/pkg/rio/man/export.html">export()</a></code> can handle many different file types (e.g. .xlsx, .csv, .rds, .tsv). When you provide a file path to either of these functions (including the file extension like “.csv”), <strong>rio</strong> will read the extension and use the correct tool to import or export the file.</p>
<p>The alternative to using <strong>rio</strong> is to use functions from many other packages, each of which is specific to a type of file. For example, <code><a href="https://rdrr.io/r/utils/read.table.html">read.csv()</a></code> (<strong>base</strong> R), <code>read.xlsx()</code> (<strong>openxlsx</strong> package), and <code><a href="https://readr.tidyverse.org/reference/write_delim.html">write_csv()</a></code> (<strong>readr</strong> pacakge), etc. These alternatives can be difficult to remember, whereas using <code><a href="https://rdrr.io/pkg/rio/man/import.html">import()</a></code> and <code><a href="https://rdrr.io/pkg/rio/man/export.html">export()</a></code> from <strong>rio</strong> is easy.</p>
<p><strong>rio</strong>’s functions <code><a href="https://rdrr.io/pkg/rio/man/import.html">import()</a></code> and <code><a href="https://rdrr.io/pkg/rio/man/export.html">export()</a></code> use the appropriate package and function for a given file, based on its file extension. See the end of this page for a complete table of which packages/functions <strong>rio</strong> uses in the background. It can also be used to import STATA, SAS, and SPSS files, among dozens of other file types.</p>
<p>Import/export of shapefiles requires other packages, as detailed in the page on [GIS basics].</p>
</div>
<div id="here" class="section level2" number="7.3">
<h2>
<span class="header-section-number">7.3</span> The <strong>here</strong> package<a class="anchor" aria-label="anchor" href="#here"><i class="fas fa-link"></i></a>
</h2>
<p>The package <strong>here</strong> and its function <code><a href="https://here.r-lib.org//reference/here.html">here()</a></code> make it easy to tell R where to find and to save your files - in essence, it builds file paths.</p>
<p>Used in conjunction with an R project, <strong>here</strong> allows you to describe the location of files in your R project in relation to the R project’s <em>root directory</em> (the top-level folder). This is useful when the R project may be shared or accessed by multiple people/computers. It prevents complications due to the unique file paths on different computers (e.g. <code>"C:/Users/Laura/Documents..."</code> by “starting” the file path in a place common to all users (the R project root).</p>
<p>This is how <code><a href="https://here.r-lib.org//reference/here.html">here()</a></code> works within an R project:</p>
<ul>
<li>When the <strong>here</strong> package is first loaded within the R project, it places a small file called “.here” in the root folder of your R project as a “benchmark” or “anchor”<br>
</li>
<li>In your scripts, to reference a file in the R project’s sub-folders, you use the function <code><a href="https://here.r-lib.org//reference/here.html">here()</a></code> to build the file path <em>in relation to that anchor</em>
</li>
<li>To build the file path, write the names of folders beyond the root, within quotes, separated by commas, finally ending with the file name and file extension as shown below<br>
</li>
<li>
<code><a href="https://here.r-lib.org//reference/here.html">here()</a></code> file paths can be used for both importing and exporting</li>
</ul>
<p>For example, below, the function <code><a href="https://rdrr.io/pkg/rio/man/import.html">import()</a></code> is being provided a file path constructed with <code><a href="https://here.r-lib.org//reference/here.html">here()</a></code>.</p>
<div class="sourceCode" id="cb131"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">linelist</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/rio/man/import.html">import</a></span><span class="op">(</span><span class="fu"><a href="https://here.r-lib.org//reference/here.html">here</a></span><span class="op">(</span><span class="st">"data"</span>, <span class="st">"linelists"</span>, <span class="st">"ebola_linelist.xlsx"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>The command <code>here("data", "linelists", "ebola_linelist.xlsx")</code> is actually providing the full file path that is <em>unique to the user’s computer</em>:</p>
<pre><code>"C:/Users/Laura/Documents/my_R_project/data/linelists/ebola_linelist.xlsx"</code></pre>
<p>The beauty is that the R command using <code><a href="https://here.r-lib.org//reference/here.html">here()</a></code> can be successfully run on any computer accessing the R project.</p>
<p><span style="color: darkgreen;"><strong><em>TIP:</em></strong> If you are unsure where the “.here” root is set to, run the function <code><a href="https://here.r-lib.org//reference/here.html">here()</a></code> with empty parentheses.</span></p>
<p>Read more about the <strong>here</strong> package <a href="https://here.r-lib.org/">at this link</a>.</p>
<!-- ======================================================= -->
</div>
<div id="file-paths" class="section level2" number="7.4">
<h2>
<span class="header-section-number">7.4</span> File paths<a class="anchor" aria-label="anchor" href="#file-paths"><i class="fas fa-link"></i></a>
</h2>
<p>When importing or exporting data, you must provide a file path. You can do this one of three ways:</p>
<ol style="list-style-type: decimal">
<li>
<em>Recommended:</em> provide a “relative” file path with the <strong>here</strong> package<br>
</li>
<li>Provide the “full” / “absolute” file path<br>
</li>
<li>Manual file selection</li>
</ol>
<div id="relative-file-paths" class="section level3 unnumbered">
<h3>“Relative” file paths<a class="anchor" aria-label="anchor" href="#relative-file-paths"><i class="fas fa-link"></i></a>
</h3>
<p>In R, “relative” file paths consist of the file path <em>relative to</em> the root of an R project. They allow for more simple file paths that can work on different computers (e.g. if the R project is on a shared drive or is sent by email). As described <a href="import-and-export.html#here">above</a>, relative file paths are facilitated by use of the <strong>here</strong> package.</p>
<p>An example of a relative file path constructed with <code><a href="https://here.r-lib.org//reference/here.html">here()</a></code> is below. We assume the work is in an R project that contains a sub-folder “data” and within that a subfolder “linelists”, in which there is the .xlsx file of interest.</p>
<div class="sourceCode" id="cb133"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">linelist</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/rio/man/import.html">import</a></span><span class="op">(</span><span class="fu"><a href="https://here.r-lib.org//reference/here.html">here</a></span><span class="op">(</span><span class="st">"data"</span>, <span class="st">"linelists"</span>, <span class="st">"ebola_linelist.xlsx"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
</div>
<div id="absolute-file-paths" class="section level3 unnumbered">
<h3>“Absolute” file paths<a class="anchor" aria-label="anchor" href="#absolute-file-paths"><i class="fas fa-link"></i></a>
</h3>
<p>Absolute or “full” file paths can be provided to functions like <code><a href="https://rdrr.io/pkg/rio/man/import.html">import()</a></code> but they are “fragile” as they are unique to the user’s specific computer and therefore <em>not recommended</em>.</p>
<p>Below is an example of an absolute file path, where in Laura’s computer there is a folder “analysis”, a sub-folder “data” and within that a sub-folder “linelists”, in which there is the .xlsx file of interest.</p>
<div class="sourceCode" id="cb134"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">linelist</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/rio/man/import.html">import</a></span><span class="op">(</span><span class="st">"C:/Users/Laura/Documents/analysis/data/linelists/ebola_linelist.xlsx"</span><span class="op">)</span></span></code></pre></div>
<p>A few things to note about absolute file paths:</p>
<ul>
<li>
<strong>Avoid using absolute file paths</strong> as they will break if the script is run on a different computer</li>
<li>Use <em>forward</em> slashes (<code>/</code>), as in the example above (note: this is <em>NOT</em> the default for Windows file paths)<br>
</li>
<li>File paths that begin with double slashes (e.g. “//…”) will likely <strong>not be recognized by R</strong> and will produce an error. Consider moving your work to a “named” or “lettered” drive that begins with a letter (e.g. “J:” or “C:”). See the page on [Directory interactions] for more details on this issue.</li>
</ul>
<p>One scenario where absolute file paths may be appropriate is when you want to import a file from a shared drive that has the same full file path for all users.</p>
<p><span style="color: darkgreen;"><strong><em>TIP:</em></strong> To quickly convert all <code>\</code> to <code>/</code>, highlight the code of interest, use Ctrl+f (in Windows), check the option box for “In selection”, and then use the replace functionality to convert them.</span></p>
<!-- ======================================================= -->
</div>
<div id="select-file-manually" class="section level3 unnumbered">
<h3>Select file manually<a class="anchor" aria-label="anchor" href="#select-file-manually"><i class="fas fa-link"></i></a>
</h3>
<p>You can import data manually via one of these methods:</p>
<ol style="list-style-type: decimal">
<li>Environment RStudio Pane, click “Import Dataset”, and select the type of data</li>
<li>Click File / Import Dataset / (select the type of data)<br>
</li>
<li>To hard-code manual selection, use the <em>base R</em> command <code><a href="https://rdrr.io/r/base/file.choose.html">file.choose()</a></code> (leaving the parentheses empty) to trigger appearance of a <strong>pop-up window</strong> that allows the user to manually select the file from their computer. For example:</li>
</ol>
<div class="sourceCode" id="cb135"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Manual selection of a file. When this command is run, a POP-UP window will appear. </span></span>
<span><span class="co"># The file path selected will be supplied to the import() command.</span></span>
<span></span>
<span><span class="va">my_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/rio/man/import.html">import</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/file.choose.html">file.choose</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><span style="color: darkgreen;"><strong><em>TIP:</em></strong> The <strong>pop-up window</strong> may appear BEHIND your RStudio window.</span></p>
</div>
</div>
<div id="import-data" class="section level2" number="7.5">
<h2>
<span class="header-section-number">7.5</span> Import data<a class="anchor" aria-label="anchor" href="#import-data"><i class="fas fa-link"></i></a>
</h2>
<p>To use <code><a href="https://rdrr.io/pkg/rio/man/import.html">import()</a></code> to import a dataset is quite simple. Simply provide the path to the file (including the file name and file extension) in quotes. If using <code><a href="https://here.r-lib.org//reference/here.html">here()</a></code> to build the file path, follow the instructions above. Below are a few examples:</p>
<p>Importing a csv file that is located in your “working directory” or in the R project root folder:</p>
<div class="sourceCode" id="cb136"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">linelist</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/rio/man/import.html">import</a></span><span class="op">(</span><span class="st">"linelist_cleaned.csv"</span><span class="op">)</span></span></code></pre></div>
<p>Importing the first sheet of an Excel workbook that is located in “data” and “linelists” sub-folders of the R project (the file path built using <code><a href="https://here.r-lib.org//reference/here.html">here()</a></code>):</p>
<div class="sourceCode" id="cb137"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">linelist</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/rio/man/import.html">import</a></span><span class="op">(</span><span class="fu"><a href="https://here.r-lib.org//reference/here.html">here</a></span><span class="op">(</span><span class="st">"data"</span>, <span class="st">"linelists"</span>, <span class="st">"linelist_cleaned.xlsx"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>Importing a data frame (a .rds file) using an absolute file path:</p>
<div class="sourceCode" id="cb138"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">linelist</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/rio/man/import.html">import</a></span><span class="op">(</span><span class="st">"C:/Users/Laura/Documents/tuberculosis/data/linelists/linelist_cleaned.rds"</span><span class="op">)</span></span></code></pre></div>
<div id="specific-excel-sheets" class="section level3 unnumbered">
<h3>Specific Excel sheets<a class="anchor" aria-label="anchor" href="#specific-excel-sheets"><i class="fas fa-link"></i></a>
</h3>
<p>By default, if you provide an Excel workbook (.xlsx) to <code><a href="https://rdrr.io/pkg/rio/man/import.html">import()</a></code>, the workbook’s first sheet will be imported. If you want to import a specific <strong>sheet</strong>, include the sheet name to the <code>which =</code> argument. For example:</p>
<div class="sourceCode" id="cb139"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">my_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/rio/man/import.html">import</a></span><span class="op">(</span><span class="st">"my_excel_file.xlsx"</span>, which <span class="op">=</span> <span class="st">"Sheetname"</span><span class="op">)</span></span></code></pre></div>
<p>If using the <code><a href="https://here.r-lib.org//reference/here.html">here()</a></code> method to provide a relative pathway to <code><a href="https://rdrr.io/pkg/rio/man/import.html">import()</a></code>, you can still indicate a specific sheet by adding the <code>which =</code> argument after the closing parentheses of the <code><a href="https://here.r-lib.org//reference/here.html">here()</a></code> function.</p>
<div class="sourceCode" id="cb140"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb140-1"><a href="import-and-export.html#cb140-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Demonstration: importing a specific Excel sheet when using relative pathways with the 'here' package</span></span>
<span id="cb140-2"><a href="import-and-export.html#cb140-2" aria-hidden="true" tabindex="-1"></a>linelist_raw <span class="ot">&lt;-</span> <span class="fu">import</span>(<span class="fu">here</span>(<span class="st">"data"</span>, <span class="st">"linelist.xlsx"</span>), <span class="at">which =</span> <span class="st">"Sheet1"</span>)<span class="st">`</span><span class="at">  </span></span></code></pre></div>
<p>To <em>export</em> a data frame from R to a specific Excel sheet and have the rest of the Excel workbook remain unchanged, you will have to import, edit, and export with an alternative package catered to this purpose such as <strong>openxlsx</strong>. See more information in the page on [Directory interactions] or <a href="https://ycphs.github.io/openxlsx/">at this github page</a>.</p>
<p>If your Excel workbook is .xlsb (binary format Excel workbook) you may not be able to import it using <strong>rio</strong>. Consider re-saving it as .xlsx, or using a package like <strong>readxlsb</strong> which is built for <a href="https://cran.r-project.org/web/packages/readxlsb/vignettes/read-xlsb-workbook.html">this purpose</a>.</p>
<!-- ======================================================= -->
</div>
<div id="import_missing" class="section level3 unnumbered">
<h3>Missing values<a class="anchor" aria-label="anchor" href="#import_missing"><i class="fas fa-link"></i></a>
</h3>
<p>You may want to designate which value(s) in your dataset should be considered as missing. As explained in the page on [Missing data], the value in R for missing data is <code>NA</code>, but perhaps the dataset you want to import uses 99, “Missing”, or just empty character space “” instead.</p>
<p>Use the <code>na =</code> argument for <code><a href="https://rdrr.io/pkg/rio/man/import.html">import()</a></code> and provide the value(s) within quotes (even if they are numbers). You can specify multiple values by including them within a vector, using <code><a href="https://rdrr.io/r/base/c.html">c()</a></code> as shown below.</p>
<p>Here, the value “99” in the imported dataset is considered missing and converted to <code>NA</code> in R.</p>
<div class="sourceCode" id="cb141"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">linelist</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/rio/man/import.html">import</a></span><span class="op">(</span><span class="fu"><a href="https://here.r-lib.org//reference/here.html">here</a></span><span class="op">(</span><span class="st">"data"</span>, <span class="st">"my_linelist.xlsx"</span><span class="op">)</span>, na <span class="op">=</span> <span class="st">"99"</span><span class="op">)</span></span></code></pre></div>
<p>Here, any of the values “Missing”, “” (empty cell), or ” ” (single space) in the imported dataset are converted to <code>NA</code> in R.</p>
<div class="sourceCode" id="cb142"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">linelist</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/rio/man/import.html">import</a></span><span class="op">(</span><span class="fu"><a href="https://here.r-lib.org//reference/here.html">here</a></span><span class="op">(</span><span class="st">"data"</span>, <span class="st">"my_linelist.csv"</span><span class="op">)</span>, na <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Missing"</span>, <span class="st">""</span>, <span class="st">" "</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<!-- ======================================================= -->
</div>
<div id="skip-rows" class="section level3 unnumbered">
<h3>Skip rows<a class="anchor" aria-label="anchor" href="#skip-rows"><i class="fas fa-link"></i></a>
</h3>
<p>Sometimes, you may want to avoid importing a row of data. You can do this with the argument <code>skip =</code> if using <code><a href="https://rdrr.io/pkg/rio/man/import.html">import()</a></code> from <strong>rio</strong> on a .xlsx or .csv file. Provide the number of rows you want to skip.</p>
<div class="sourceCode" id="cb143"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">linelist_raw</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/rio/man/import.html">import</a></span><span class="op">(</span><span class="st">"linelist_raw.xlsx"</span>, skip <span class="op">=</span> <span class="fl">1</span><span class="op">)</span>  <span class="co"># does not import header row</span></span></code></pre></div>
<p>Unfortunately <code>skip =</code> only accepts one integer value, <em>not</em> a range (e.g. “2:10” does not work). To skip import of specific rows that are not consecutive from the top, consider importing multiple times and using <code><a href="https://dplyr.tidyverse.org/reference/bind.html">bind_rows()</a></code> from <strong>dplyr</strong>. See the example below of skipping only row 2.</p>
</div>
<div id="manage-a-second-header-row" class="section level3 unnumbered">
<h3>Manage a second header row<a class="anchor" aria-label="anchor" href="#manage-a-second-header-row"><i class="fas fa-link"></i></a>
</h3>
<p>Sometimes, your data may have a <em>second</em> row, for example if it is a “data dictionary” row as shown below. This situation can be problematic because it can result in all columns being imported as class “character”.</p>
<p>Below is an example of this kind of dataset (with the first row being the data dictionary).</p>
<div id="htmlwidget-6fbca3ce793574d9c51d" style="width:100%;height:auto;" class="datatables html-widget"></div>
<script type="application/json" data-for="htmlwidget-6fbca3ce793574d9c51d">{"x":{"filter":"top","vertical":false,"filterHTML":"<tr>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n<\/tr>","data":[["case identification number assigned by MOH","5fe599","8689b7","11f8ea","b8812a"],["transmission chain generation number","4","4","2","3"],["estimated date of infection, mm/dd/yyyy","2014-05-08",null,null,"2014-05-04"],["date of symptom onset, YYYY-MM-DD","2014-05-13","2014-05-13","2014-05-16","2014-05-18"],["date of initial hospitalization, mm/dd/yyyy","2014-05-15","2014-05-14","2014-05-18","2014-05-20"],["date of outcome status determination",null,"2014-05-18","2014-05-30",null],["either 'Death' or 'Recovered' or 'Unknown'",null,"Recover","Recover",null],["either 'm' or 'f' or 'unknown'","m","f","m","f"],["age number","2","3","56","18"],["age unit, either 'years' or 'months' or 'days'","years","years","years","years"],[null,"2","3","56","18"],[null,"0-4","0-4","50-69","15-19"],[null,"0-4","0-4","55-59","15-19"],["Name of hospital of first admission","Other","Missing","St. Mark's Maternity Hospital (SMMH)","Port Hospital"],["longitude of residence, approx","-13.2157351064963","-13.2152339775486","-13.212910703914","-13.2363711169728"],["latitude of residence, approx","8.46897295100924","8.45171855856465","8.46481700596819","8.4754761613651"],["case_id of infector","f547d6",null,null,"f90f5f"],["context of known transmission event","other",null,null,"other"],[null,"27","25","91","41"],[null,"48","59","238","135"],[null,"22","22","21","23"],["presence of fever on admission, either 'yes' or 'no'","no",null,null,"no"],["presence of chills on admission, either 'yes' or 'no'","no",null,null,"no"],["presence of cough on admission, either 'yes' or 'no'","yes",null,null,"no"],["presence of aches on admission, either 'yes' or 'no'","no",null,null,"no"],["presence of vomiting on admission, either 'yes' or 'no'","yes",null,null,"no"],[null,"36.8","36.9","36.9","36.8"],["time of hospital admission HH:MM",null,"09:36","16:48","11:22"],[null,"117.1875","71.8184429761563","16.0652496292635","22.4965706447188"],[null,"2","1","2","2"]],"container":"<table class=\"white-space: nowrap\">\n  <thead>\n    <tr>\n      <th>case_id<\/th>\n      <th>generation<\/th>\n      <th>date_infection<\/th>\n      <th>date_onset<\/th>\n      <th>date_hospitalisation<\/th>\n      <th>date_outcome<\/th>\n      <th>outcome<\/th>\n      <th>gender<\/th>\n      <th>age<\/th>\n      <th>age_unit<\/th>\n      <th>age_years<\/th>\n      <th>age_cat<\/th>\n      <th>age_cat5<\/th>\n      <th>hospital<\/th>\n      <th>lon<\/th>\n      <th>lat<\/th>\n      <th>infector<\/th>\n      <th>source<\/th>\n      <th>wt_kg<\/th>\n      <th>ht_cm<\/th>\n      <th>ct_blood<\/th>\n      <th>fever<\/th>\n      <th>chills<\/th>\n      <th>cough<\/th>\n      <th>aches<\/th>\n      <th>vomit<\/th>\n      <th>temp<\/th>\n      <th>time_admission<\/th>\n      <th>bmi<\/th>\n      <th>days_onset_hosp<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"pageLength":4,"scrollX":true,"columnDefs":[],"order":[],"autoWidth":false,"orderClasses":false,"orderCellsTop":true,"lengthMenu":[4,10,25,50,100]}},"evals":[],"jsHooks":[]}</script><div id="remove-the-second-header-row" class="section level4 unnumbered">
<h4>Remove the second header row<a class="anchor" aria-label="anchor" href="#remove-the-second-header-row"><i class="fas fa-link"></i></a>
</h4>
<p>To drop the second header row, you will likely need to import the data twice.</p>
<ol style="list-style-type: decimal">
<li>Import the data in order to store the correct column names<br>
</li>
<li>Import the data again, skipping the first <em>two</em> rows (header and second rows)<br>
</li>
<li>Bind the correct names onto the reduced dataframe</li>
</ol>
<p>The exact argument used to bind the correct column names depends on the type of data file (.csv, .tsv, .xlsx, etc.). This is because <strong>rio</strong> is using a different function for the different file types (see table above).</p>
<p><strong>For Excel files:</strong> (<code>col_names =</code>)</p>
<div class="sourceCode" id="cb144"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># import first time; store the column names</span></span>
<span><span class="va">linelist_raw_names</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/rio/man/import.html">import</a></span><span class="op">(</span><span class="st">"linelist_raw.xlsx"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op">(</span><span class="op">)</span>  <span class="co"># save true column names</span></span>
<span></span>
<span><span class="co"># import second time; skip row 2, and assign column names to argument col_names =</span></span>
<span><span class="va">linelist_raw</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/rio/man/import.html">import</a></span><span class="op">(</span><span class="st">"linelist_raw.xlsx"</span>,</span>
<span>                       skip <span class="op">=</span> <span class="fl">2</span>,</span>
<span>                       col_names <span class="op">=</span> <span class="va">linelist_raw_names</span></span>
<span>                       <span class="op">)</span> </span></code></pre></div>
<p><strong>For CSV files:</strong> (<code>col.names =</code>)</p>
<div class="sourceCode" id="cb145"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># import first time; sotre column names</span></span>
<span><span class="va">linelist_raw_names</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/rio/man/import.html">import</a></span><span class="op">(</span><span class="st">"linelist_raw.csv"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op">(</span><span class="op">)</span> <span class="co"># save true column names</span></span>
<span></span>
<span><span class="co"># note argument for csv files is 'col.names = '</span></span>
<span><span class="va">linelist_raw</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/rio/man/import.html">import</a></span><span class="op">(</span><span class="st">"linelist_raw.csv"</span>,</span>
<span>                       skip <span class="op">=</span> <span class="fl">2</span>,</span>
<span>                       col.names <span class="op">=</span> <span class="va">linelist_raw_names</span></span>
<span>                       <span class="op">)</span> </span></code></pre></div>
<p><strong>Backup option</strong> - changing column names as a separate command</p>
<div class="sourceCode" id="cb146"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># assign/overwrite headers using the base 'colnames()' function</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span><span class="op">(</span><span class="va">linelist_raw</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="va">linelist_raw_names</span></span></code></pre></div>
</div>
<div id="make-a-data-dictionary" class="section level4 unnumbered">
<h4>Make a data dictionary<a class="anchor" aria-label="anchor" href="#make-a-data-dictionary"><i class="fas fa-link"></i></a>
</h4>
<p>Bonus! If you do have a second row that is a data dictionary, you can easily create a proper data dictionary from it. This tip is adapted from this <a href="https://alison.rbind.io/post/2018-02-23-read-multiple-header-rows/">post</a>.</p>
<div class="sourceCode" id="cb147"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">dict</span> <span class="op">&lt;-</span> <span class="va">linelist_2headers</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span>             <span class="co"># begin: linelist with dictionary as first row</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span>                             <span class="co"># keep only column names and first dictionary row                </span></span>
<span>  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_longer.html">pivot_longer</a></span><span class="op">(</span>cols <span class="op">=</span> <span class="fu"><a href="https://tidyselect.r-lib.org/reference/everything.html">everything</a></span><span class="op">(</span><span class="op">)</span>,       <span class="co"># pivot all columns to long format</span></span>
<span>               names_to <span class="op">=</span> <span class="st">"Column"</span>,       <span class="co"># assign new column names</span></span>
<span>               values_to <span class="op">=</span> <span class="st">"Description"</span><span class="op">)</span></span></code></pre></div>
<div id="htmlwidget-b6e841898b1b04515a02" style="width:100%;height:auto;" class="datatables html-widget"></div>
<script type="application/json" data-for="htmlwidget-b6e841898b1b04515a02">{"x":{"filter":"top","vertical":false,"filterHTML":"<tr>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n<\/tr>","data":[["case_id","generation","date_infection","date_onset","date_hospitalisation","date_outcome","outcome","gender","age","age_unit","age_years","age_cat","age_cat5","hospital","lon","lat","infector","source","wt_kg","ht_cm","ct_blood","fever","chills","cough","aches","vomit","temp","time_admission","bmi","days_onset_hosp"],["case identification number assigned by MOH","transmission chain generation number","estimated date of infection, mm/dd/yyyy","date of symptom onset, YYYY-MM-DD","date of initial hospitalization, mm/dd/yyyy","date of outcome status determination","either 'Death' or 'Recovered' or 'Unknown'","either 'm' or 'f' or 'unknown'","age number","age unit, either 'years' or 'months' or 'days'",null,null,null,"Name of hospital of first admission","longitude of residence, approx","latitude of residence, approx","case_id of infector","context of known transmission event",null,null,null,"presence of fever on admission, either 'yes' or 'no'","presence of chills on admission, either 'yes' or 'no'","presence of cough on admission, either 'yes' or 'no'","presence of aches on admission, either 'yes' or 'no'","presence of vomiting on admission, either 'yes' or 'no'",null,"time of hospital admission HH:MM",null,null]],"container":"<table class=\"white-space: nowrap\">\n  <thead>\n    <tr>\n      <th>Column<\/th>\n      <th>Description<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"pageLength":4,"scrollX":true,"columnDefs":[],"order":[],"autoWidth":false,"orderClasses":false,"orderCellsTop":true,"lengthMenu":[4,10,25,50,100]}},"evals":[],"jsHooks":[]}</script>
</div>
<div id="combine-the-two-header-rows" class="section level4 unnumbered">
<h4>Combine the two header rows<a class="anchor" aria-label="anchor" href="#combine-the-two-header-rows"><i class="fas fa-link"></i></a>
</h4>
<p>In some cases when your raw dataset has <em>two</em> header rows (or more specifically, the 2nd row of data is a secondary header), you may want to “combine” them or add the values in the second header row into the first header row.</p>
<p>The command below will define the data frame’s column names as the combination (pasting together) of the first (true) headers with the value immediately underneath (in the first row).</p>
<div class="sourceCode" id="cb148"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op">(</span><span class="va">my_data</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op">(</span><span class="va">my_data</span><span class="op">)</span>, <span class="va">my_data</span><span class="op">[</span><span class="fl">1</span>, <span class="op">]</span>, sep <span class="op">=</span> <span class="st">"_"</span><span class="op">)</span></span></code></pre></div>
<!-- ======================================================= -->
</div>
</div>
<div id="google-sheets" class="section level3 unnumbered">
<h3>Google sheets<a class="anchor" aria-label="anchor" href="#google-sheets"><i class="fas fa-link"></i></a>
</h3>
<p>You can import data from an online Google spreadsheet with the <strong>googlesheet4</strong> package and by authenticating your access to the spreadsheet.</p>
<div class="sourceCode" id="cb149"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">pacman</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/pacman/man/p_load.html">p_load</a></span><span class="op">(</span><span class="st">"googlesheets4"</span><span class="op">)</span></span></code></pre></div>
<p>Below, a demo Google sheet is imported and saved. This command may prompt confirmation of authentification of your Google account. Follow prompts and pop-ups in your internet browser to grant Tidyverse API packages permissions to edit, create, and delete your spreadsheets in Google Drive.</p>
<p>The sheet below is “viewable for anyone with the link” and you can try to import it.</p>
<div class="sourceCode" id="cb150"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">Gsheets_demo</span> <span class="op">&lt;-</span> <span class="fu">read_sheet</span><span class="op">(</span><span class="st">"https://docs.google.com/spreadsheets/d/1scgtzkVLLHAe5a6_eFQEwkZcc14yFUx1KgOMZ4AKUfY/edit#gid=0"</span><span class="op">)</span></span></code></pre></div>
<p>The sheet can also be imported using only the sheet ID, a shorter part of the URL:</p>
<div class="sourceCode" id="cb151"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">Gsheets_demo</span> <span class="op">&lt;-</span> <span class="fu">read_sheet</span><span class="op">(</span><span class="st">"1scgtzkVLLHAe5a6_eFQEwkZcc14yFUx1KgOMZ4AKUfY"</span><span class="op">)</span></span></code></pre></div>
<p>Another package, <strong>googledrive</strong> offers useful functions for writing, editing, and deleting Google sheets. For example, using the <code>gs4_create()</code> and <code>sheet_write()</code> functions found in this package.</p>
<p>Here are some other helpful online tutorials:<br><a href="https://arbor-analytics.com/post/getting-your-data-into-r-from-google-sheets/">basic Google sheets importing tutorial</a><br><a href="https://googlesheets4.tidyverse.org/articles/googlesheets4.html">more detailed tutorial</a><br><a href="https://googlesheets4.tidyverse.org/articles/articles/drive-and-sheets.html">interaction between the googlesheets4 and tidyverse</a></p>
</div>
</div>
<div id="multiple-files---import-export-split-combine" class="section level2" number="7.6">
<h2>
<span class="header-section-number">7.6</span> Multiple files - import, export, split, combine<a class="anchor" aria-label="anchor" href="#multiple-files---import-export-split-combine"><i class="fas fa-link"></i></a>
</h2>
<p>See the page on [Iteration, loops, and lists] for examples of how to import and combine multiple files, or multiple Excel workbook files. That page also has examples on how to split a data frame into parts and export each one separately, or as named sheets in an Excel workbook.</p>
<!-- ======================================================= -->
</div>
<div id="import_github" class="section level2" number="7.7">
<h2>
<span class="header-section-number">7.7</span> Import from Github<a class="anchor" aria-label="anchor" href="#import_github"><i class="fas fa-link"></i></a>
</h2>
<p>Importing data directly from Github into R can be very easy or can require a few steps - depending on the file type. Below are some approaches:</p>
<div id="csv-files" class="section level3 unnumbered">
<h3>CSV files<a class="anchor" aria-label="anchor" href="#csv-files"><i class="fas fa-link"></i></a>
</h3>
<p>It can be easy to import a .csv file directly from Github into R with an R command.</p>
<ol style="list-style-type: decimal">
<li>Go to the Github repo, locate the file of interest, and click on it<br>
</li>
<li>Click on the “Raw” button (you will then see the “raw” csv data, as shown below)<br>
</li>
<li>Copy the URL (web address)<br>
</li>
<li>Place the URL in quotes within the <code><a href="https://rdrr.io/pkg/rio/man/import.html">import()</a></code> R command</li>
</ol>
<div class="inline-figure"><img src="images/download_csv_raw.png" width="100%" style="display: block; margin: auto auto auto 0;"></div>
</div>
<div id="xlsx-files" class="section level3 unnumbered">
<h3>XLSX files<a class="anchor" aria-label="anchor" href="#xlsx-files"><i class="fas fa-link"></i></a>
</h3>
<p>You may not be able to view the “Raw” data for some files (e.g. .xlsx, .rds, .nwk, .shp)</p>
<ol style="list-style-type: decimal">
<li>Go to the Github repo, locate the file of interest, and click on it<br>
</li>
<li>Click the “Download” button, as shown below<br>
</li>
<li>Save the file on your computer, and import it into R</li>
</ol>
<div class="inline-figure"><img src="images/download_xlsx.png" width="100%" style="display: block; margin: auto auto auto 0;"></div>
</div>
<div id="shapefiles" class="section level3 unnumbered">
<h3>Shapefiles<a class="anchor" aria-label="anchor" href="#shapefiles"><i class="fas fa-link"></i></a>
</h3>
<p>Shapefiles have many sub-component files, each with a different file extention. One file will have the “.shp” extension, but others may have “.dbf”, “.prj”, etc. To download a shapefile from Github, you will need to download each of the sub-component files individually, and save them in the <em>same</em> folder on your computer. In Github, click on each file individually and download them by clicking on the “Download” button.</p>
<p>Once saved to your computer you can import the shapefile as shown in the [GIS basics] page using <code>st_read()</code> from the <strong>sf</strong> package. You only need to provide the filepath and name of the “.shp” file - as long as the other related files are within the same folder on your computer.</p>
<p>Below, you can see how the shapefile “sle_adm3” consists of many files - each of which must be downloaded from Github.</p>
<div class="inline-figure"><img src="images/download_shp.png" width="100%" style="display: block; margin: auto auto auto 0;"></div>
<!-- ======================================================= -->
</div>
</div>
<div id="manual-data-entry" class="section level2" number="7.8">
<h2>
<span class="header-section-number">7.8</span> Manual data entry<a class="anchor" aria-label="anchor" href="#manual-data-entry"><i class="fas fa-link"></i></a>
</h2>
<div id="entry-by-rows" class="section level3 unnumbered">
<h3>Entry by rows<a class="anchor" aria-label="anchor" href="#entry-by-rows"><i class="fas fa-link"></i></a>
</h3>
<p>Use the <code>tribble</code> function from the <strong>tibble</strong> package from the tidyverse (<a href="https://tibble.tidyverse.org/reference/tribble.html">online tibble reference</a>).</p>
<p>Note how column headers start with a <em>tilde</em> (<code>~</code>). Also note that each column must contain only one class of data (character, numeric, etc.). You can use tabs, spacing, and new rows to make the data entry more intuitive and readable. Spaces do not matter between values, but each row is represented by a new line of code. For example:</p>
<div class="sourceCode" id="cb152"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># create the dataset manually by row</span></span>
<span><span class="va">manual_entry_rows</span> <span class="op">&lt;-</span> <span class="fu">tibble</span><span class="fu">::</span><span class="fu"><a href="https://tibble.tidyverse.org/reference/tribble.html">tribble</a></span><span class="op">(</span></span>
<span>  <span class="op">~</span><span class="va">colA</span>, <span class="op">~</span><span class="va">colB</span>,</span>
<span>  <span class="st">"a"</span>,   <span class="fl">1</span>,</span>
<span>  <span class="st">"b"</span>,   <span class="fl">2</span>,</span>
<span>  <span class="st">"c"</span>,   <span class="fl">3</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
<p>And now we display the new dataset:</p>
<div id="htmlwidget-2b8415d8643ed4623544" style="width:100%;height:auto;" class="datatables html-widget"></div>
<script type="application/json" data-for="htmlwidget-2b8415d8643ed4623544">{"x":{"filter":"none","vertical":false,"data":[["1","2","3"],["a","b","c"],[1,2,3]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>colA<\/th>\n      <th>colB<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"columnDefs":[{"className":"dt-right","targets":2},{"orderable":false,"targets":0}],"order":[],"autoWidth":false,"orderClasses":false}},"evals":[],"jsHooks":[]}</script>
</div>
<div id="entry-by-columns" class="section level3 unnumbered">
<h3>Entry by columns<a class="anchor" aria-label="anchor" href="#entry-by-columns"><i class="fas fa-link"></i></a>
</h3>
<p>Since a data frame consists of vectors (vertical columns), the <strong>base</strong> approach to manual dataframe creation in R expects you to define each column and then bind them together. This can be counter-intuitive in epidemiology, as we usually think about our data in rows (as above).</p>
<div class="sourceCode" id="cb153"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># define each vector (vertical column) separately, each with its own name</span></span>
<span><span class="va">PatientID</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">235</span>, <span class="fl">452</span>, <span class="fl">778</span>, <span class="fl">111</span><span class="op">)</span></span>
<span><span class="va">Treatment</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Yes"</span>, <span class="st">"No"</span>, <span class="st">"Yes"</span>, <span class="st">"Yes"</span><span class="op">)</span></span>
<span><span class="va">Death</span>     <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">0</span>, <span class="fl">1</span>, <span class="fl">0</span><span class="op">)</span></span></code></pre></div>
<p><span style="color: orange;"><strong><em>CAUTION:</em></strong> All vectors must be the same length (same number of values).</span></p>
<p>The vectors can then be bound together using the function <code><a href="https://rdrr.io/r/base/data.frame.html">data.frame()</a></code>:</p>
<div class="sourceCode" id="cb154"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># combine the columns into a data frame, by referencing the vector names</span></span>
<span><span class="va">manual_entry_cols</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span><span class="va">PatientID</span>, <span class="va">Treatment</span>, <span class="va">Death</span><span class="op">)</span></span></code></pre></div>
<p>And now we display the new dataset:</p>
<div id="htmlwidget-314d69ed6bdc4f6da463" style="width:100%;height:auto;" class="datatables html-widget"></div>
<script type="application/json" data-for="htmlwidget-314d69ed6bdc4f6da463">{"x":{"filter":"none","vertical":false,"data":[["1","2","3","4"],[235,452,778,111],["Yes","No","Yes","Yes"],[1,0,1,0]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>PatientID<\/th>\n      <th>Treatment<\/th>\n      <th>Death<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"columnDefs":[{"className":"dt-right","targets":[1,3]},{"orderable":false,"targets":0}],"order":[],"autoWidth":false,"orderClasses":false}},"evals":[],"jsHooks":[]}</script>
</div>
<div id="pasting-from-clipboard" class="section level3 unnumbered">
<h3>Pasting from clipboard<a class="anchor" aria-label="anchor" href="#pasting-from-clipboard"><i class="fas fa-link"></i></a>
</h3>
<p>If you copy data from elsewhere and have it on your clipboard, you can try one of the two ways below:</p>
<p>From the <strong>clipr</strong> package, you can use <code>read_clip_tbl()</code> to import as a data frame, or just just <code>read_clip()</code> to import as a character vector. In both cases, leave the parentheses empty.</p>
<div class="sourceCode" id="cb155"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">linelist</span> <span class="op">&lt;-</span> <span class="fu">clipr</span><span class="fu">::</span><span class="fu"><a href="http://matthewlincoln.net/clipr/reference/read_clip_tbl.html">read_clip_tbl</a></span><span class="op">(</span><span class="op">)</span>  <span class="co"># imports current clipboard as data frame</span></span>
<span><span class="va">linelist</span> <span class="op">&lt;-</span> <span class="fu">clipr</span><span class="fu">::</span><span class="fu"><a href="http://matthewlincoln.net/clipr/reference/read_clip.html">read_clip</a></span><span class="op">(</span><span class="op">)</span>      <span class="co"># imports as character vector</span></span></code></pre></div>
<p>You can also easily export to your system’s clipboard with <strong>clipr</strong>. See the section below on Export.</p>
<p>Alternatively, you can use the the <code><a href="https://rdrr.io/r/utils/read.table.html">read.table()</a></code> function from <strong>base</strong> R with <code>file = "clipboard")</code> to import as a data frame:</p>
<div class="sourceCode" id="cb156"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">df_from_clipboard</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/utils/read.table.html">read.table</a></span><span class="op">(</span></span>
<span>  file <span class="op">=</span> <span class="st">"clipboard"</span>,  <span class="co"># specify this as "clipboard"</span></span>
<span>  sep <span class="op">=</span> <span class="st">"t"</span>,           <span class="co"># separator could be tab, or commas, etc.</span></span>
<span>  header<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span>         <span class="co"># if there is a header row</span></span></code></pre></div>
</div>
</div>
<div id="import-most-recent-file" class="section level2" number="7.9">
<h2>
<span class="header-section-number">7.9</span> Import most recent file<a class="anchor" aria-label="anchor" href="#import-most-recent-file"><i class="fas fa-link"></i></a>
</h2>
<p>Often you may receive daily updates to your datasets. In this case you will want to write code that imports the most recent file. Below we present two ways to approach this:</p>
<ul>
<li>Selecting the file based on the date in the file name<br>
</li>
<li>Selecting the file based on file metadata (last modification)</li>
</ul>
<div id="dates-in-file-name" class="section level3 unnumbered">
<h3>Dates in file name<a class="anchor" aria-label="anchor" href="#dates-in-file-name"><i class="fas fa-link"></i></a>
</h3>
<p>This approach depends on three premises:</p>
<ol style="list-style-type: decimal">
<li>You trust the dates in the file names<br>
</li>
<li>The dates are numeric and appear in <em>generally</em> the same format (e.g. year then month then day)<br>
</li>
<li>There are no other numbers in the file name</li>
</ol>
<p>We will explain each step, and then show you them combined at the end.</p>
<p>First, use <code><a href="https://rdrr.io/r/base/list.files.html">dir()</a></code> from <strong>base</strong> R to extract just the file names for each file in the folder of interest. See the page on [Directory interactions] for more details about <code><a href="https://rdrr.io/r/base/list.files.html">dir()</a></code>. In this example, the folder of interest is the folder “linelists” within the folder “example” within “data” within the R project.</p>
<div class="sourceCode" id="cb157"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">linelist_filenames</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.files.html">dir</a></span><span class="op">(</span><span class="fu"><a href="https://here.r-lib.org//reference/here.html">here</a></span><span class="op">(</span><span class="st">"data"</span>, <span class="st">"example"</span>, <span class="st">"linelists"</span><span class="op">)</span><span class="op">)</span> <span class="co"># get file names from folder</span></span>
<span><span class="va">linelist_filenames</span>                                              <span class="co"># print</span></span></code></pre></div>
<pre><code>## [1] "20201007linelist.csv"          "case_linelist_2020-10-02.csv"  "case_linelist_2020-10-03.csv" 
## [4] "case_linelist_2020-10-04.csv"  "case_linelist_2020-10-05.csv"  "case_linelist_2020-10-08.xlsx"
## [7] "case_linelist20201006.csv"</code></pre>
<p>Once you have this vector of names, you can extract the dates from them by applying <code><a href="https://stringr.tidyverse.org/reference/str_extract.html">str_extract()</a></code> from <strong>stringr</strong> using this regular expression. It extracts any numbers in the file name (including any other characters in the middle such as dashes or slashes). You can read more about <strong>stringr</strong> in the [Strings and characters] page.</p>
<div class="sourceCode" id="cb159"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">linelist_dates_raw</span> <span class="op">&lt;-</span> <span class="fu">stringr</span><span class="fu">::</span><span class="fu"><a href="https://stringr.tidyverse.org/reference/str_extract.html">str_extract</a></span><span class="op">(</span><span class="va">linelist_filenames</span>, <span class="st">"[0-9].*[0-9]"</span><span class="op">)</span> <span class="co"># extract numbers and any characters in between</span></span>
<span><span class="va">linelist_dates_raw</span>  <span class="co"># print</span></span></code></pre></div>
<pre><code>## [1] "20201007"   "2020-10-02" "2020-10-03" "2020-10-04" "2020-10-05" "2020-10-08" "20201006"</code></pre>
<p>Assuming the dates are written in generally the same date format (e.g. Year then Month then Day) and the years are 4-digits, you can use <strong>lubridate</strong>’s flexible conversion functions (<code>ymd()</code>, <code>dmy()</code>, or <code>mdy()</code>) to convert them to dates. For these functions, the dashes, spaces, or slashes do not matter, only the order of the numbers. Read more in the [Working with dates] page.</p>
<div class="sourceCode" id="cb161"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">linelist_dates_clean</span> <span class="op">&lt;-</span> <span class="fu">lubridate</span><span class="fu">::</span><span class="fu"><a href="https://lubridate.tidyverse.org/reference/ymd.html">ymd</a></span><span class="op">(</span><span class="va">linelist_dates_raw</span><span class="op">)</span></span>
<span><span class="va">linelist_dates_clean</span></span></code></pre></div>
<pre><code>## [1] "2020-10-07" "2020-10-02" "2020-10-03" "2020-10-04" "2020-10-05" "2020-10-08" "2020-10-06"</code></pre>
<p>The <strong>base</strong> R function <code><a href="https://rdrr.io/r/base/which.min.html">which.max()</a></code> can then be used to return the index position (e.g. 1st, 2nd, 3rd, …) of the maximum date value. The latest file is correctly identified as the 6th file - “case_linelist_2020-10-08.xlsx”.</p>
<div class="sourceCode" id="cb163"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">index_latest_file</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/which.min.html">which.max</a></span><span class="op">(</span><span class="va">linelist_dates_clean</span><span class="op">)</span></span>
<span><span class="va">index_latest_file</span></span></code></pre></div>
<pre><code>## [1] 6</code></pre>
<p>If we condense all these commands, the complete code could look like below. Note that the <code>.</code> in the last line is a placeholder for the piped object at that point in the pipe sequence. At that point the value is simply the number 6. This is placed in double brackets to extract the 6th element of the vector of file names produced by <code><a href="https://rdrr.io/r/base/list.files.html">dir()</a></code>.</p>
<div class="sourceCode" id="cb165"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># load packages</span></span>
<span><span class="fu">pacman</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/pacman/man/p_load.html">p_load</a></span><span class="op">(</span></span>
<span>  <span class="va">tidyverse</span>,         <span class="co"># data management</span></span>
<span>  <span class="va">stringr</span>,           <span class="co"># work with strings/characters</span></span>
<span>  <span class="va">lubridate</span>,         <span class="co"># work with dates</span></span>
<span>  <span class="va">rio</span>,               <span class="co"># import / export</span></span>
<span>  <span class="va">here</span>,              <span class="co"># relative file paths</span></span>
<span>  <span class="va">fs</span><span class="op">)</span>                <span class="co"># directory interactions</span></span>
<span></span>
<span><span class="co"># extract the file name of latest file</span></span>
<span><span class="va">latest_file</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.files.html">dir</a></span><span class="op">(</span><span class="fu"><a href="https://here.r-lib.org//reference/here.html">here</a></span><span class="op">(</span><span class="st">"data"</span>, <span class="st">"example"</span>, <span class="st">"linelists"</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span>  <span class="co"># file names from "linelists" sub-folder          </span></span>
<span>  <span class="fu"><a href="https://stringr.tidyverse.org/reference/str_extract.html">str_extract</a></span><span class="op">(</span><span class="st">"[0-9].*[0-9]"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span>                  <span class="co"># pull out dates (numbers)</span></span>
<span>  <span class="fu">ymd</span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span>                                        <span class="co"># convert numbers to dates (assuming year-month-day format)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/which.min.html">which.max</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span>                                  <span class="co"># get index of max date (latest file)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/list.files.html">dir</a></span><span class="op">(</span><span class="fu"><a href="https://here.r-lib.org//reference/here.html">here</a></span><span class="op">(</span><span class="st">"data"</span>, <span class="st">"example"</span>, <span class="st">"linelists"</span><span class="op">)</span><span class="op">)</span><span class="op">[[</span><span class="va">.</span><span class="op">]</span><span class="op">]</span>              <span class="co"># return the filename of latest linelist</span></span>
<span></span>
<span><span class="va">latest_file</span>  <span class="co"># print name of latest file</span></span></code></pre></div>
<pre><code>## [1] "case_linelist_2020-10-08.xlsx"</code></pre>
<p>You can now use this name to finish the relative file path, with <code><a href="https://here.r-lib.org//reference/here.html">here()</a></code>:</p>
<div class="sourceCode" id="cb167"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://here.r-lib.org//reference/here.html">here</a></span><span class="op">(</span><span class="st">"data"</span>, <span class="st">"example"</span>, <span class="st">"linelists"</span>, <span class="va">latest_file</span><span class="op">)</span> </span></code></pre></div>
<p>And you can now import the latest file:</p>
<div class="sourceCode" id="cb168"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># import</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/rio/man/import.html">import</a></span><span class="op">(</span><span class="fu"><a href="https://here.r-lib.org//reference/here.html">here</a></span><span class="op">(</span><span class="st">"data"</span>, <span class="st">"example"</span>, <span class="st">"linelists"</span>, <span class="va">latest_file</span><span class="op">)</span><span class="op">)</span> <span class="co"># import </span></span></code></pre></div>
</div>
<div id="use-the-file-info" class="section level3 unnumbered">
<h3>Use the file info<a class="anchor" aria-label="anchor" href="#use-the-file-info"><i class="fas fa-link"></i></a>
</h3>
<p>If your files do not have dates in their names (or you do not trust those dates), you can try to extract the last modification date from the file metadata. Use functions from the package <strong>fs</strong> to examine the metadata information for each file, which includes the last modification time and the file path.</p>
<p>Below, we provide the folder of interest to <strong>fs</strong>’s <code>dir_info()</code>. In this case, the folder of interest is in the R project in the folder “data”, the sub-folder “example”, and its sub-folder “linelists”. The result is a data frame with one line per file and columns for <code>modification_time</code>, <code>path</code>, etc. You can see a visual example of this in the page on [Directory interactions].</p>
<p>We can sort this data frame of files by the column <code>modification_time</code>, and then keep only the top/latest row (file) with <strong>base</strong> R’s <code><a href="https://rdrr.io/r/utils/head.html">head()</a></code>. Then we can extract the file path of this latest file only with the <strong>dplyr</strong> function <code><a href="https://dplyr.tidyverse.org/reference/pull.html">pull()</a></code> on the column <code>path</code>. Finally we can pass this file path to <code><a href="https://rdrr.io/pkg/rio/man/import.html">import()</a></code>. The imported file is saved as <code>latest_file</code>.</p>
<div class="sourceCode" id="cb169"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">latest_file</span> <span class="op">&lt;-</span> <span class="fu">dir_info</span><span class="op">(</span><span class="fu"><a href="https://here.r-lib.org//reference/here.html">here</a></span><span class="op">(</span><span class="st">"data"</span>, <span class="st">"example"</span>, <span class="st">"linelists"</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span>  <span class="co"># collect file info on all files in directory</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/arrange.html">arrange</a></span><span class="op">(</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/desc.html">desc</a></span><span class="op">(</span><span class="va">modification_time</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span>      <span class="co"># sort by modification time</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span>                               <span class="co"># keep only the top (latest) file</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/pull.html">pull</a></span><span class="op">(</span><span class="va">path</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span>                            <span class="co"># extract only the file path</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/pkg/rio/man/import.html">import</a></span><span class="op">(</span><span class="op">)</span>                                  <span class="co"># import the file</span></span></code></pre></div>
<!-- ======================================================= -->
</div>
</div>
<div id="import_api" class="section level2" number="7.10">
<h2>
<span class="header-section-number">7.10</span> APIs<a class="anchor" aria-label="anchor" href="#import_api"><i class="fas fa-link"></i></a>
</h2>
<p>An “Automated Programming Interface” (API) can be used to directly request data from a website. APIs are a set of rules that allow one software application to interact with another. The client (you) sends a “request” and receives a “response” containing content. The R packages <strong>httr</strong> and <strong>jsonlite</strong> can facilitate this process.</p>
<p>Each API-enabled website will have its own documentation and specifics to become familiar with. Some sites are publicly available and can be accessed by anyone. Others, such as platforms with user IDs and credentials, require authentication to access their data.</p>
<p>Needless to say, it is necessary to have an internet connection to import data via API. We will briefly give examples of use of APIs to import data, and link you to further resources.</p>
<p><em>Note: recall that data may be </em>posted* on a website without an API, which may be easier to retrieve. For example a posted CSV file may be accessible simply by providing the site URL to <code><a href="https://rdrr.io/pkg/rio/man/import.html">import()</a></code> as described in the section on <a href="import-and-export.html#import_github">importing from Github</a>.*</p>
<div id="http-request" class="section level3 unnumbered">
<h3>HTTP request<a class="anchor" aria-label="anchor" href="#http-request"><i class="fas fa-link"></i></a>
</h3>
<p>The API exchange is most commonly done through an HTTP request. HTTP is Hypertext Transfer Protocol, and is the underlying format of a request/response between a client and a server. The exact input and output may vary depending on the type of API but the process is the same - a “Request” (often HTTP Request) from the user, often containing a query, followed by a “Response”, containing status information about the request and possibly the requested content.</p>
<p>Here are a few components of an <em>HTTP request</em>:</p>
<ul>
<li>The URL of the API endpoint<br>
</li>
<li>The “Method” (or “Verb”)<br>
</li>
<li>Headers<br>
</li>
<li>Body</li>
</ul>
<p>The HTTP request “method” is the action your want to perform. The two most common HTTP methods are <code>GET</code> and <code>POST</code> but others could include <code>PUT</code>, <code>DELETE</code>, <code>PATCH</code>, etc. When importing data into R it is most likely that you will use <code>GET</code>.</p>
<p>After your request, your computer will receive a “response” in a format similar to what you sent, including URL, HTTP status (Status 200 is what you want!), file type, size, and the desired content. You will then need to parse this response and turn it into a workable data frame within your R environment.</p>
</div>
<div id="packages-1" class="section level3 unnumbered">
<h3>Packages<a class="anchor" aria-label="anchor" href="#packages-1"><i class="fas fa-link"></i></a>
</h3>
<p>The <strong>httr</strong> package works well for handling HTTP requests in R. It requires little prior knowledge of Web APIs and can be used by people less familiar with software development terminology. In addition, if the HTTP response is .json, you can use <strong>jsonlite</strong> to parse the response.</p>
<div class="sourceCode" id="cb170"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># load packages</span></span>
<span><span class="fu">pacman</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/pacman/man/p_load.html">p_load</a></span><span class="op">(</span><span class="va">httr</span>, <span class="va">jsonlite</span>, <span class="va">tidyverse</span><span class="op">)</span></span></code></pre></div>
</div>
<div id="publicly-available-data" class="section level3 unnumbered">
<h3>Publicly-available data<a class="anchor" aria-label="anchor" href="#publicly-available-data"><i class="fas fa-link"></i></a>
</h3>
<p>Below is an example of an HTTP request, borrowed from a tutorial from <a href="https://www.trafforddatalab.io/open_data_companion/#A_quick_introduction_to_APIs">the Trafford Data Lab</a>. This site has several other resources to learn and API exercises.</p>
<p>Scenario: We want to import a list of fast food outlets in the city of Trafford, UK. The data can be accessed from the API of the Food Standards Agency, which provides food hygiene rating data for the United Kingdom.</p>
<p>Here are the parameters for our request:</p>
<ul>
<li>HTTP verb: GET<br>
</li>
<li>API endpoint URL: <a href="http://api.ratings.food.gov.uk/Establishments" class="uri">http://api.ratings.food.gov.uk/Establishments</a><br>
</li>
<li>Selected parameters: name, address, longitude, latitude, businessTypeId, ratingKey, localAuthorityId<br>
</li>
<li>Headers: “x-api-version”, 2<br>
</li>
<li>Data format(s): JSON, XML<br>
</li>
<li>Documentation: <a href="http://api.ratings.food.gov.uk/help" class="uri">http://api.ratings.food.gov.uk/help</a>
</li>
</ul>
<p>The R code would be as follows:</p>
<div class="sourceCode" id="cb171"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># prepare the request</span></span>
<span><span class="va">path</span> <span class="op">&lt;-</span> <span class="st">"http://api.ratings.food.gov.uk/Establishments"</span></span>
<span><span class="va">request</span> <span class="op">&lt;-</span> <span class="fu">GET</span><span class="op">(</span>url <span class="op">=</span> <span class="va">path</span>,</span>
<span>             query <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span></span>
<span>               localAuthorityId <span class="op">=</span> <span class="fl">188</span>,</span>
<span>               BusinessTypeId <span class="op">=</span> <span class="fl">7844</span>,</span>
<span>               pageNumber <span class="op">=</span> <span class="fl">1</span>,</span>
<span>               pageSize <span class="op">=</span> <span class="fl">5000</span><span class="op">)</span>,</span>
<span>             <span class="fu">add_headers</span><span class="op">(</span><span class="st">"x-api-version"</span> <span class="op">=</span> <span class="st">"2"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># check for any server error ("200" is good!)</span></span>
<span><span class="va">request</span><span class="op">$</span><span class="va">status_code</span></span>
<span></span>
<span><span class="co"># submit the request, parse the response, and convert to a data frame</span></span>
<span><span class="va">response</span> <span class="op">&lt;-</span> <span class="fu">content</span><span class="op">(</span><span class="va">request</span>, as <span class="op">=</span> <span class="st">"text"</span>, encoding <span class="op">=</span> <span class="st">"UTF-8"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu">fromJSON</span><span class="op">(</span>flatten <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://purrr.tidyverse.org/reference/pluck.html">pluck</a></span><span class="op">(</span><span class="st">"establishments"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://tibble.tidyverse.org/reference/as_tibble.html">as_tibble</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p>You can now clean and use the <code>response</code> data frame, which contains one row per fast food facility.</p>
</div>
<div id="authentication-required" class="section level3 unnumbered">
<h3>Authentication required<a class="anchor" aria-label="anchor" href="#authentication-required"><i class="fas fa-link"></i></a>
</h3>
<p>Some APIs require authentication - for you to prove who you are, so you can access restricted data. To import these data, you may need to first use a POST method to provide a username, password, or code. This will return an access token, that can be used for subsequent GET method requests to retrieve the desired data.</p>
<p>Below is an example of querying data from <em>Go.Data</em>, which is an outbreak investigation tool. <em>Go.Data</em> uses an API for all interactions between the web front-end and smartphone applications used for data collection. <em>Go.Data</em> is used throughout the world. Because outbreak data are sensitive and you should only be able to access data for <em>your</em> outbreak, authentication is required.</p>
<p>Below is some sample R code using <strong>httr</strong> and <strong>jsonlite</strong> for connecting to the <em>Go.Data</em> API to import data on contact follow-up from your outbreak.</p>
<div class="sourceCode" id="cb172"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># set credentials for authorization</span></span>
<span><span class="va">url</span> <span class="op">&lt;-</span> <span class="st">"https://godatasampleURL.int/"</span>           <span class="co"># valid Go.Data instance url</span></span>
<span><span class="va">username</span> <span class="op">&lt;-</span> <span class="st">"username"</span>                          <span class="co"># valid Go.Data username </span></span>
<span><span class="va">password</span> <span class="op">&lt;-</span> <span class="st">"password"</span>                          <span class="co"># valid Go,Data password </span></span>
<span><span class="va">outbreak_id</span> <span class="op">&lt;-</span> <span class="st">"xxxxxx-xxxx-xxxx-xxxx-xxxxxxx"</span>  <span class="co"># valid Go.Data outbreak ID</span></span>
<span></span>
<span><span class="co"># get access token</span></span>
<span><span class="va">url_request</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="va">url</span>,<span class="st">"api/oauth/token?access_token=123"</span><span class="op">)</span> <span class="co"># define base URL request</span></span>
<span></span>
<span><span class="co"># prepare request</span></span>
<span><span class="va">response</span> <span class="op">&lt;-</span> <span class="fu">POST</span><span class="op">(</span></span>
<span>  url <span class="op">=</span> <span class="va">url_request</span>,  </span>
<span>  body <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span></span>
<span>    username <span class="op">=</span> <span class="va">username</span>,    <span class="co"># use saved username/password from above to authorize                               </span></span>
<span>    password <span class="op">=</span> <span class="va">password</span><span class="op">)</span>,                                       </span>
<span>    encode <span class="op">=</span> <span class="st">"json"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># execute request and parse response</span></span>
<span><span class="va">content</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu">content</span><span class="op">(</span><span class="va">response</span>, as <span class="op">=</span> <span class="st">"text"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu">fromJSON</span><span class="op">(</span>flatten <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span>          <span class="co"># flatten nested JSON</span></span>
<span>  <span class="fu"><a href="https://pillar.r-lib.org/reference/glimpse.html">glimpse</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Save access token from response</span></span>
<span><span class="va">access_token</span> <span class="op">&lt;-</span> <span class="va">content</span><span class="op">$</span><span class="va">access_token</span>    <span class="co"># save access token to allow subsequent API calls below</span></span>
<span></span>
<span><span class="co"># import outbreak contacts</span></span>
<span><span class="co"># Use the access token </span></span>
<span><span class="va">response_contacts</span> <span class="op">&lt;-</span> <span class="fu">GET</span><span class="op">(</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="va">url</span>,<span class="st">"api/outbreaks/"</span>,<span class="va">outbreak_id</span>,<span class="st">"/contacts"</span><span class="op">)</span>,          <span class="co"># GET request</span></span>
<span>  <span class="fu">add_headers</span><span class="op">(</span></span>
<span>    Authorization <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span><span class="st">"Bearer"</span>, <span class="va">access_token</span>, sep <span class="op">=</span> <span class="st">" "</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">json_contacts</span> <span class="op">&lt;-</span> <span class="fu">content</span><span class="op">(</span><span class="va">response_contacts</span>, as <span class="op">=</span> <span class="st">"text"</span><span class="op">)</span>         <span class="co"># convert to text JSON</span></span>
<span></span>
<span><span class="va">contacts</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://tibble.tidyverse.org/reference/as_tibble.html">as_tibble</a></span><span class="op">(</span><span class="fu">fromJSON</span><span class="op">(</span><span class="va">json_contacts</span>, flatten <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span>   <span class="co"># flatten JSON to tibble</span></span></code></pre></div>
<p><span style="color: orange;"><strong><em>CAUTION:</em></strong> If you are importing large amounts of data from an API requiring authentication, it may time-out. To avoid this, retrieve access_token again before each API GET request and try using filters or limits in the query. </span></p>
<p><span style="color: darkgreen;"><strong><em>TIP:</em></strong> The <code>fromJSON()</code> function in the <strong>jsonlite</strong> package does not fully un-nest the first time it’s executed, so you will likely still have list items in your resulting tibble. You will need to further un-nest for certain variables; depending on how nested your .json is. To view more info on this, view the documentation for the <strong>jsonlite</strong> package, such as the <a href="https://rdrr.io/cran/jsonlite/man/flatten.html"><code>flatten()</code> function</a>. </span></p>
<p>For more details, View documentation on <a href="https://loopback.io/doc/en/lb4/index.html">LoopBack Explorer</a>, the <a href="download-handbook-and-data.html#contact-tracing">Contact Tracing</a> page or API tips on <a href="https://worldhealthorganization.github.io/godata/api-docs">Go.Data Github repository</a></p>
<p>You can read more about the <em>httr</em> package <a href="https://httr.r-lib.org/articles/quickstart.html">here</a></p>
<p>This section was also informed by <a href="https://www.dataquest.io/blog/r-api-tutorial/">this tutorial</a> and <a href="https://medium.com/@traffordDataLab/querying-apis-in-r-39029b73d5f1">this tutorial</a>.</p>
<!-- ======================================================= -->
</div>
</div>
<div id="export" class="section level2" number="7.11">
<h2>
<span class="header-section-number">7.11</span> Export<a class="anchor" aria-label="anchor" href="#export"><i class="fas fa-link"></i></a>
</h2>
<div id="with-rio-package" class="section level3 unnumbered">
<h3>With <strong>rio</strong> package<a class="anchor" aria-label="anchor" href="#with-rio-package"><i class="fas fa-link"></i></a>
</h3>
<p>With <strong>rio</strong>, you can use the <code><a href="https://rdrr.io/pkg/rio/man/export.html">export()</a></code> function in a very similar way to <code><a href="https://rdrr.io/pkg/rio/man/import.html">import()</a></code>. First give the name of the R object you want to save (e.g. <code>linelist</code>) and then in quotes put the file path where you want to save the file, including the desired file name and file extension. For example:</p>
<p>This saves the data frame <code>linelist</code> as an Excel workbook to the working directory/R project root folder:</p>
<div class="sourceCode" id="cb173"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/rio/man/export.html">export</a></span><span class="op">(</span><span class="va">linelist</span>, <span class="st">"my_linelist.xlsx"</span><span class="op">)</span> <span class="co"># will save to working directory</span></span></code></pre></div>
<p>You could save the same data frame as a csv file by changing the extension. For example, we also save it to a file path constructed with <code><a href="https://here.r-lib.org//reference/here.html">here()</a></code>:</p>
<div class="sourceCode" id="cb174"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/rio/man/export.html">export</a></span><span class="op">(</span><span class="va">linelist</span>, <span class="fu"><a href="https://here.r-lib.org//reference/here.html">here</a></span><span class="op">(</span><span class="st">"data"</span>, <span class="st">"clean"</span>, <span class="st">"my_linelist.csv"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
</div>
<div id="to-clipboard" class="section level3 unnumbered">
<h3>To clipboard<a class="anchor" aria-label="anchor" href="#to-clipboard"><i class="fas fa-link"></i></a>
</h3>
<p>To export a data frame to your computer’s “clipboard” (to then paste into another software like Excel, Google Spreadsheets, etc.) you can use <code>write_clip()</code> from the <strong>clipr</strong> package.</p>
<div class="sourceCode" id="cb175"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># export the linelist data frame to your system's clipboard</span></span>
<span><span class="fu">clipr</span><span class="fu">::</span><span class="fu"><a href="http://matthewlincoln.net/clipr/reference/write_clip.html">write_clip</a></span><span class="op">(</span><span class="va">linelist</span><span class="op">)</span></span></code></pre></div>
</div>
</div>
<div id="import_rds" class="section level2" number="7.12">
<h2>
<span class="header-section-number">7.12</span> RDS files<a class="anchor" aria-label="anchor" href="#import_rds"><i class="fas fa-link"></i></a>
</h2>
<p>Along with .csv, .xlsx, etc, you can also export/save R data frames as .rds files. This is a file format specific to R, and is very useful if you know you will work with the exported data again in R.</p>
<p>The classes of columns are stored, so you don’t have do to cleaning again when it is imported (with an Excel or even a CSV file this can be a headache!). It is also a smaller file, which is useful for export and import if your dataset is large.</p>
<p>For example, if you work in an Epidemiology team and need to send files to a GIS team for mapping, and they use R as well, just send them the .rds file! Then all the column classes are retained and they have less work to do.</p>
<div class="sourceCode" id="cb176"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/rio/man/export.html">export</a></span><span class="op">(</span><span class="va">linelist</span>, <span class="fu"><a href="https://here.r-lib.org//reference/here.html">here</a></span><span class="op">(</span><span class="st">"data"</span>, <span class="st">"clean"</span>, <span class="st">"my_linelist.rds"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<!-- ======================================================= -->
</div>
<div id="import_rdata" class="section level2" number="7.13">
<h2>
<span class="header-section-number">7.13</span> Rdata files and lists<a class="anchor" aria-label="anchor" href="#import_rdata"><i class="fas fa-link"></i></a>
</h2>
<p><code>.Rdata</code> files can store multiple R objects - for example multiple data frames, model results, lists, etc. This can be very useful to consolidate or share a lot of your data for a given project.</p>
<p>In the below example, multiple R objects are stored within the exported file “my_objects.Rdata”:</p>
<div class="sourceCode" id="cb177"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">rio</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/rio/man/export.html">export</a></span><span class="op">(</span><span class="va">my_list</span>, <span class="va">my_dataframe</span>, <span class="va">my_vector</span>, <span class="st">"my_objects.Rdata"</span><span class="op">)</span></span></code></pre></div>
<p>Note: if you are trying to <em>import</em> a list, use <code><a href="https://rdrr.io/pkg/rio/man/import_list.html">import_list()</a></code> from <strong>rio</strong> to import it with the complete original structure and contents.</p>
<div class="sourceCode" id="cb178"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">rio</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/rio/man/import_list.html">import_list</a></span><span class="op">(</span><span class="st">"my_list.Rdata"</span><span class="op">)</span></span></code></pre></div>
<!-- ======================================================= -->
</div>
<div id="saving-plots" class="section level2" number="7.14">
<h2>
<span class="header-section-number">7.14</span> Saving plots<a class="anchor" aria-label="anchor" href="#saving-plots"><i class="fas fa-link"></i></a>
</h2>
<p>Instructions on how to save plots, such as those created by <code><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot()</a></code>, are discussed in depth in the [ggplot basics] page.</p>
<p>In brief, run <code>ggsave("my_plot_filepath_and_name.png")</code> after printing your plot. You can either provide a saved plot object to the <code>plot =</code> argument, or only specify the destination file path (with file extension) to save the most recently-displayed plot. You can also control the <code>width =</code>, <code>height =</code>, <code>units =</code>, and <code>dpi =</code>.</p>
<p>How to save a network graph, such as a transmission tree, is addressed in the page on [Transmission chains].</p>
<!-- ======================================================= -->
</div>
<div id="resources-1" class="section level2" number="7.15">
<h2>
<span class="header-section-number">7.15</span> Resources<a class="anchor" aria-label="anchor" href="#resources-1"><i class="fas fa-link"></i></a>
</h2>
<p>The <a href="https://cran.r-project.org/doc/manuals/r-release/R-data.html">R Data Import/Export Manual</a><br><a href="https://r4ds.had.co.nz/data-import.html#data-import">R 4 Data Science chapter on data import</a><br><a href="https://ggplot2.tidyverse.org/reference/ggsave.html">ggsave() documentation</a></p>
<p>Below is a table, taken from the <strong>rio</strong> online <a href="https://cran.r-project.org/web/packages/rio/vignettes/rio.html">vignette</a>. For each type of data it shows: the expected file extension, the package <strong>rio</strong> uses to import or export the data, and whether this functionality is included in the default installed version of <strong>rio</strong>.</p>
<div class="inline-table"><table class="table table-sm">
<colgroup>
<col width="25%">
<col width="17%">
<col width="17%">
<col width="18%">
<col width="19%">
</colgroup>
<thead><tr class="header">
<th>Format</th>
<th>Typical Extension</th>
<th>Import Package</th>
<th>Export Package</th>
<th>Installed by Default</th>
</tr></thead>
<tbody>
<tr class="odd">
<td>Comma-separated data</td>
<td>.csv</td>
<td>data.table <code>fread()</code>
</td>
<td>data.table</td>
<td>Yes</td>
</tr>
<tr class="even">
<td>Pipe-separated data</td>
<td>.psv</td>
<td>data.table <code>fread()</code>
</td>
<td>data.table</td>
<td>Yes</td>
</tr>
<tr class="odd">
<td>Tab-separated data</td>
<td>.tsv</td>
<td>data.table <code>fread()</code>
</td>
<td>data.table</td>
<td>Yes</td>
</tr>
<tr class="even">
<td>SAS</td>
<td>.sas7bdat</td>
<td>haven</td>
<td>haven</td>
<td>Yes</td>
</tr>
<tr class="odd">
<td>SPSS</td>
<td>.sav</td>
<td>haven</td>
<td>haven</td>
<td>Yes</td>
</tr>
<tr class="even">
<td>Stata</td>
<td>.dta</td>
<td>haven</td>
<td>haven</td>
<td>Yes</td>
</tr>
<tr class="odd">
<td>SAS</td>
<td>XPORT</td>
<td>.xpt</td>
<td>haven</td>
<td>haven</td>
</tr>
<tr class="even">
<td>SPSS Portable</td>
<td>.por</td>
<td>haven</td>
<td></td>
<td>Yes</td>
</tr>
<tr class="odd">
<td>Excel</td>
<td>.xls</td>
<td>readxl</td>
<td></td>
<td>Yes</td>
</tr>
<tr class="even">
<td>Excel</td>
<td>.xlsx</td>
<td>readxl</td>
<td>openxlsx</td>
<td>Yes</td>
</tr>
<tr class="odd">
<td>R syntax</td>
<td>.R</td>
<td>base</td>
<td>base</td>
<td>Yes</td>
</tr>
<tr class="even">
<td>Saved R objects</td>
<td>.RData, .rda</td>
<td>base</td>
<td>base</td>
<td>Yes</td>
</tr>
<tr class="odd">
<td>Serialized R objects</td>
<td>.rds</td>
<td>base</td>
<td>base</td>
<td>Yes</td>
</tr>
<tr class="even">
<td>Epiinfo</td>
<td>.rec</td>
<td>foreign</td>
<td></td>
<td>Yes</td>
</tr>
<tr class="odd">
<td>Minitab</td>
<td>.mtp</td>
<td>foreign</td>
<td></td>
<td>Yes</td>
</tr>
<tr class="even">
<td>Systat</td>
<td>.syd</td>
<td>foreign</td>
<td></td>
<td>Yes</td>
</tr>
<tr class="odd">
<td>“XBASE”</td>
<td>database files</td>
<td>.dbf</td>
<td>foreign</td>
<td>foreign</td>
</tr>
<tr class="even">
<td>Weka Attribute-Relation File Format</td>
<td>.arff</td>
<td>foreign</td>
<td>foreign</td>
<td>Yes</td>
</tr>
<tr class="odd">
<td>Data Interchange Format</td>
<td>.dif</td>
<td>utils</td>
<td></td>
<td>Yes</td>
</tr>
<tr class="even">
<td>Fortran data</td>
<td>no recognized extension</td>
<td>utils</td>
<td></td>
<td>Yes</td>
</tr>
<tr class="odd">
<td>Fixed-width format data</td>
<td>.fwf</td>
<td>utils</td>
<td>utils</td>
<td>Yes</td>
</tr>
<tr class="even">
<td>gzip comma-separated data</td>
<td>.csv.gz</td>
<td>utils</td>
<td>utils</td>
<td>Yes</td>
</tr>
<tr class="odd">
<td>CSVY (CSV + YAML metadata header)</td>
<td>.csvy</td>
<td>csvy</td>
<td>csvy</td>
<td>No</td>
</tr>
<tr class="even">
<td>EViews</td>
<td>.wf1</td>
<td>hexView</td>
<td></td>
<td>No</td>
</tr>
<tr class="odd">
<td>Feather R/Python interchange format</td>
<td>.feather</td>
<td>feather</td>
<td>feather</td>
<td>No</td>
</tr>
<tr class="even">
<td>Fast Storage</td>
<td>.fst</td>
<td>fst</td>
<td>fst</td>
<td>No</td>
</tr>
<tr class="odd">
<td>JSON</td>
<td>.json</td>
<td>jsonlite</td>
<td>jsonlite</td>
<td>No</td>
</tr>
<tr class="even">
<td>Matlab</td>
<td>.mat</td>
<td>rmatio</td>
<td>rmatio</td>
<td>No</td>
</tr>
<tr class="odd">
<td>OpenDocument Spreadsheet</td>
<td>.ods</td>
<td>readODS</td>
<td>readODS</td>
<td>No</td>
</tr>
<tr class="even">
<td>HTML Tables</td>
<td>.html</td>
<td>xml2</td>
<td>xml2</td>
<td>No</td>
</tr>
<tr class="odd">
<td>Shallow XML documents</td>
<td>.xml</td>
<td>xml2</td>
<td>xml2</td>
<td>No</td>
</tr>
<tr class="even">
<td>YAML</td>
<td>.yml</td>
<td>yaml</td>
<td>yaml</td>
<td>No</td>
</tr>
<tr class="odd">
<td>Clipboard default is tsv</td>
<td></td>
<td>clipr</td>
<td>clipr</td>
<td>No</td>
</tr>
</tbody>
</table></div>
</div>
</div>



<div class="chapter-nav">
<div class="prev"><a href="r-projects.html"><span class="header-section-number">6</span> R projects</a></div>
<div class="next"><a href="cleaning-data-and-core-functions.html"><span class="header-section-number">8</span> Cleaning data and core functions</a></div>
</div></main><div class="col-md-3 col-lg-2 d-none d-md-block sidebar sidebar-chapter">
    <nav id="toc" data-toggle="toc" aria-label="On this page"><h2>On this page</h2>
      <ul class="nav navbar-nav">
<li><a class="nav-link" href="#import-and-export"><span class="header-section-number">7</span> Import and export</a></li>
<li><a class="nav-link" href="#overview"><span class="header-section-number">7.1</span> Overview</a></li>
<li><a class="nav-link" href="#the-rio-package"><span class="header-section-number">7.2</span> The rio package</a></li>
<li><a class="nav-link" href="#here"><span class="header-section-number">7.3</span> The here package</a></li>
<li>
<a class="nav-link" href="#file-paths"><span class="header-section-number">7.4</span> File paths</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#relative-file-paths">“Relative” file paths</a></li>
<li><a class="nav-link" href="#absolute-file-paths">“Absolute” file paths</a></li>
<li><a class="nav-link" href="#select-file-manually">Select file manually</a></li>
</ul>
</li>
<li>
<a class="nav-link" href="#import-data"><span class="header-section-number">7.5</span> Import data</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#specific-excel-sheets">Specific Excel sheets</a></li>
<li><a class="nav-link" href="#import_missing">Missing values</a></li>
<li><a class="nav-link" href="#skip-rows">Skip rows</a></li>
<li><a class="nav-link" href="#manage-a-second-header-row">Manage a second header row</a></li>
<li><a class="nav-link" href="#google-sheets">Google sheets</a></li>
</ul>
</li>
<li><a class="nav-link" href="#multiple-files---import-export-split-combine"><span class="header-section-number">7.6</span> Multiple files - import, export, split, combine</a></li>
<li>
<a class="nav-link" href="#import_github"><span class="header-section-number">7.7</span> Import from Github</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#csv-files">CSV files</a></li>
<li><a class="nav-link" href="#xlsx-files">XLSX files</a></li>
<li><a class="nav-link" href="#shapefiles">Shapefiles</a></li>
</ul>
</li>
<li>
<a class="nav-link" href="#manual-data-entry"><span class="header-section-number">7.8</span> Manual data entry</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#entry-by-rows">Entry by rows</a></li>
<li><a class="nav-link" href="#entry-by-columns">Entry by columns</a></li>
<li><a class="nav-link" href="#pasting-from-clipboard">Pasting from clipboard</a></li>
</ul>
</li>
<li>
<a class="nav-link" href="#import-most-recent-file"><span class="header-section-number">7.9</span> Import most recent file</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#dates-in-file-name">Dates in file name</a></li>
<li><a class="nav-link" href="#use-the-file-info">Use the file info</a></li>
</ul>
</li>
<li>
<a class="nav-link" href="#import_api"><span class="header-section-number">7.10</span> APIs</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#http-request">HTTP request</a></li>
<li><a class="nav-link" href="#packages-1">Packages</a></li>
<li><a class="nav-link" href="#publicly-available-data">Publicly-available data</a></li>
<li><a class="nav-link" href="#authentication-required">Authentication required</a></li>
</ul>
</li>
<li>
<a class="nav-link" href="#export"><span class="header-section-number">7.11</span> Export</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#with-rio-package">With rio package</a></li>
<li><a class="nav-link" href="#to-clipboard">To clipboard</a></li>
</ul>
</li>
<li><a class="nav-link" href="#import_rds"><span class="header-section-number">7.12</span> RDS files</a></li>
<li><a class="nav-link" href="#import_rdata"><span class="header-section-number">7.13</span> Rdata files and lists</a></li>
<li><a class="nav-link" href="#saving-plots"><span class="header-section-number">7.14</span> Saving plots</a></li>
<li><a class="nav-link" href="#resources-1"><span class="header-section-number">7.15</span> Resources</a></li>
</ul>

      <div class="book-extra">
        <ul class="list-unstyled">
          
        </ul>
</div>
    </nav>
</div>
</div>
  

  

</div>
 <!-- .container -->

<footer class="bg-primary text-light mt-5"><div class="container"><div class="row">

  <div class="col-12 col-md-6 mt-3">
    <p>"<strong>The Epidemiologist R Handbook</strong>" was written by the handbook team. It was last built on 2022-10-23.</p>
  </div>

  <div class="col-12 col-md-6 mt-3">
    <p>This book was built by the <a class="text-light" href="https://bookdown.org">bookdown</a> R package.</p>
  </div>

</div></div>
</footer>
</body>
</html>
