<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <title>44 Writing functions | The Epidemiologist R Handbook</title>

    <meta name="author" content="the handbook team" />
  
  <!-- JS -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>
  <script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.2"></script>
  <script src="https://kit.fontawesome.com/6ecbd6c532.js" crossorigin="anonymous"></script>
    <script src="libs/header-attrs-2.9/header-attrs.js"></script>
    <script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no" />
    <link href="libs/bootstrap-4.6.0/bootstrap.min.css" rel="stylesheet" />
    <script src="libs/bootstrap-4.6.0/bootstrap.bundle.min.js"></script>
    <script src="libs/bs3compat-0.2.5.1/tabs.js"></script>
    <script src="libs/bs3compat-0.2.5.1/bs3compat.js"></script>
    <link href="libs/bs4_book-1.0.0/bs4_book.css" rel="stylesheet" />
    <script src="libs/bs4_book-1.0.0/bs4_book.js"></script>
    <script src="libs/htmlwidgets-1.5.3/htmlwidgets.js"></script>
    <link href="libs/datatables-css-0.0.0/datatables-crosstalk.css" rel="stylesheet" />
    <script src="libs/datatables-binding-0.18/datatables.js"></script>
    <link href="libs/dt-core-1.10.20/css/jquery.dataTables.min.css" rel="stylesheet" />
    <link href="libs/dt-core-1.10.20/css/jquery.dataTables.extra.css" rel="stylesheet" />
    <script src="libs/dt-core-1.10.20/js/jquery.dataTables.min.js"></script>
    <link href="libs/nouislider-7.0.10/jquery.nouislider.min.css" rel="stylesheet" />
    <script src="libs/nouislider-7.0.10/jquery.nouislider.min.js"></script>
    <link href="libs/selectize-0.12.0/selectize.bootstrap3.css" rel="stylesheet" />
    <script src="libs/selectize-0.12.0/selectize.min.js"></script>
    <link href="libs/crosstalk-1.1.1/css/crosstalk.css" rel="stylesheet" />
    <script src="libs/crosstalk-1.1.1/js/crosstalk.min.js"></script>
    <script src="libs/kePrint-0.0.1/kePrint.js"></script>
    <link href="libs/lightable-0.0.1/lightable.css" rel="stylesheet" />
    <link href="libs/tabwid-1.0.0/tabwid.css" rel="stylesheet" />
    <link href="libs/leaflet-1.3.1/leaflet.css" rel="stylesheet" />
    <script src="libs/leaflet-1.3.1/leaflet.js"></script>
    <link href="libs/leafletfix-1.0.0/leafletfix.css" rel="stylesheet" />
    <script src="libs/proj4-2.6.2/proj4.min.js"></script>
    <script src="libs/Proj4Leaflet-1.0.1/proj4leaflet.js"></script>
    <link href="libs/rstudio_leaflet-1.3.1/rstudio_leaflet.css" rel="stylesheet" />
    <script src="libs/leaflet-binding-2.0.4.1/leaflet.js"></script>
    <script src="libs/leaflet-providers-1.9.0/leaflet-providers_1.9.0.js"></script>
    <script src="libs/leaflet-providers-plugin-2.0.4.1/leaflet-providers-plugin.js"></script>
    <script src="libs/viz-1.8.2/viz.js"></script>
    <link href="libs/DiagrammeR-styles-0.2/styles.css" rel="stylesheet" />
    <script src="libs/grViz-binding-1.0.6.1/grViz.js"></script>
    <script src="libs/d3-4.5.0/d3.min.js"></script>
    <script src="libs/sankey-1/sankey.js"></script>
    <script src="libs/sankeyNetwork-binding-0.4/sankeyNetwork.js"></script>
    <script src="libs/plotly-binding-4.9.3/plotly.js"></script>
    <script src="libs/typedarray-0.1/typedarray.min.js"></script>
    <link href="libs/plotly-htmlwidgets-css-1.57.1/plotly-htmlwidgets.css" rel="stylesheet" />
    <script src="libs/plotly-main-1.57.1/plotly-latest.min.js"></script>
    <link href="libs/vis-4.20.1/vis.css" rel="stylesheet" />
    <script src="libs/vis-4.20.1/vis.min.js"></script>
    <script src="libs/visNetwork-binding-2.0.9/visNetwork.js"></script>
    <link href="libs/font-awesome-4.7.0/css/font-awesome.min.css" rel="stylesheet" />
    <script src="libs/plotly-basic-1.57.1/plotly-basic-1.57.1.min.js"></script>
    <script src="libs/plotly-cartesian-1.57.1/plotly-cartesian-1.57.1.min.js"></script>
    <script src="libs/proj4js-2.3.15/proj4.js"></script>
    <link href="libs/highcharts-8.1.2/css/motion.css" rel="stylesheet" />
    <script src="libs/highcharts-8.1.2/highcharts.js"></script>
    <script src="libs/highcharts-8.1.2/highcharts-3d.js"></script>
    <script src="libs/highcharts-8.1.2/highcharts-more.js"></script>
    <script src="libs/highcharts-8.1.2/modules/stock.js"></script>
    <script src="libs/highcharts-8.1.2/modules/map.js"></script>
    <script src="libs/highcharts-8.1.2/modules/annotations.js"></script>
    <script src="libs/highcharts-8.1.2/modules/data.js"></script>
    <script src="libs/highcharts-8.1.2/modules/drilldown.js"></script>
    <script src="libs/highcharts-8.1.2/modules/item-series.js"></script>
    <script src="libs/highcharts-8.1.2/modules/offline-exporting.js"></script>
    <script src="libs/highcharts-8.1.2/modules/overlapping-datalabels.js"></script>
    <script src="libs/highcharts-8.1.2/modules/exporting.js"></script>
    <script src="libs/highcharts-8.1.2/modules/export-data.js"></script>
    <script src="libs/highcharts-8.1.2/modules/funnel.js"></script>
    <script src="libs/highcharts-8.1.2/modules/heatmap.js"></script>
    <script src="libs/highcharts-8.1.2/modules/treemap.js"></script>
    <script src="libs/highcharts-8.1.2/modules/sankey.js"></script>
    <script src="libs/highcharts-8.1.2/modules/dependency-wheel.js"></script>
    <script src="libs/highcharts-8.1.2/modules/organization.js"></script>
    <script src="libs/highcharts-8.1.2/modules/solid-gauge.js"></script>
    <script src="libs/highcharts-8.1.2/modules/streamgraph.js"></script>
    <script src="libs/highcharts-8.1.2/modules/sunburst.js"></script>
    <script src="libs/highcharts-8.1.2/modules/vector.js"></script>
    <script src="libs/highcharts-8.1.2/modules/wordcloud.js"></script>
    <script src="libs/highcharts-8.1.2/modules/xrange.js"></script>
    <script src="libs/highcharts-8.1.2/modules/tilemap.js"></script>
    <script src="libs/highcharts-8.1.2/modules/venn.js"></script>
    <script src="libs/highcharts-8.1.2/modules/gantt.js"></script>
    <script src="libs/highcharts-8.1.2/modules/timeline.js"></script>
    <script src="libs/highcharts-8.1.2/modules/parallel-coordinates.js"></script>
    <script src="libs/highcharts-8.1.2/modules/bullet.js"></script>
    <script src="libs/highcharts-8.1.2/modules/coloraxis.js"></script>
    <script src="libs/highcharts-8.1.2/modules/dumbbell.js"></script>
    <script src="libs/highcharts-8.1.2/modules/lollipop.js"></script>
    <script src="libs/highcharts-8.1.2/modules/series-label.js"></script>
    <script src="libs/highcharts-8.1.2/plugins/motion.js"></script>
    <script src="libs/highcharts-8.1.2/custom/reset.js"></script>
    <script src="libs/highcharts-8.1.2/modules/boost.js"></script>
    <script src="libs/highchart-binding-0.8.2/highchart.js"></script>
    <script src="https://cdn.jsdelivr.net/autocomplete.js/0/autocomplete.jquery.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/mark.js@8.11.1/dist/mark.min.js"></script>

  <!-- CSS -->
    <link rel="stylesheet" href="style_bs4.css" />
    
</head>

<body data-spy="scroll" data-target="#toc">

<div class="container-fluid">
<div class="row">
  <header class="col-sm-12 col-lg-3 sidebar sidebar-book">
    <a class="sr-only sr-only-focusable" href="#content">Skip to main content</a>

    <div class="d-flex align-items-start justify-content-between">
      <h1>
        <a href="index.html" title="">The Epidemiologist R Handbook</a>
      </h1>
      <button class="btn btn-outline-primary d-lg-none ml-2 mt-1" type="button" data-toggle="collapse" data-target="#main-nav" aria-expanded="true" aria-controls="main-nav"><i class="fas fa-bars"></i><span class="sr-only">Show table of contents</span></button>
    </div>

    <div id="main-nav" class="collapse-lg">
      <form role="search">
        <input id="search" class="form-control" type="search" placeholder="Search" aria-label="Search">
      </form>

      <nav aria-label="Table of contents">
        <h2>Table of contents</h2>
        <div id="book-toc"></div>

        <div class="book-extra">
          <p><a id="book-repo" href="#">View book source <i class="fab fa-github"></i></a></li></p>
        </div>
      </nav>
    </div>
  </header>

  <main class="col-sm-12 col-md-9 col-lg-7" id="content">
<div id="writing-functions-1" class="section level1" number="44">
<h1><span class="header-section-number">44</span> Writing functions</h1>
<!-- ======================================================= -->
<div id="preparation-37" class="section level2" number="44.1">
<h2><span class="header-section-number">44.1</span> Preparation</h2>
<div id="load-packages-33" class="section level3 unnumbered">
<h3>Load packages</h3>
<p>This code chunk shows the loading of packages required for the analyses. In this handbook we emphasize <code>p_load()</code> from <strong>pacman</strong>, which installs the package if necessary <em>and</em> loads it for use. You can also load installed packages with <code>library()</code> from <strong>base</strong> R. See the page on <a href="r-basics.html#r-basics">R basics</a> for more information on R packages.</p>
</div>
<div id="import-data-28" class="section level3 unnumbered">
<h3>Import data</h3>
<p>We import the dataset of cases from a simulated Ebola epidemic. If you want to download the data to follow step-by-step, see instructions in the [Download book and data] page. The dataset is imported using the <code>import()</code> function from the <strong>rio</strong> package. See the page on <a href="import-and-export.html#import-and-export">Import and export</a> for various ways to import data.</p>
<p>We will also use in the last part of this page some data on H7N9 flu from 2013.</p>
</div>
</div>
<div id="functions-2" class="section level2" number="44.2">
<h2><span class="header-section-number">44.2</span> Functions</h2>
<p>Functions are helpful in programming since they allow to make codes easier to understand, somehow shorter and less prone to errors (given there were no errors in the function itself).</p>
<p>If you have come so far to this handbook, it means you have came across endless functions since in R, every operation is a function call
<code>+, for, if, [, $, { …</code>. For example <code>x + y</code> is the same as<code>'+'(x, y)</code></p>
<p>R is one the languages that offers the most possibility to work with functions and give enough tools to the user to easily write them. We should not think about functions as fixed at the top or at the end of the programming chain, R offers the possibility to use them as if they were vectors and even to use them inside other functions, lists…</p>
<p>Lot of very advanced resources on functional programming exist and we will only give here an insight to help you start with functional programming with short practical examples. You are then encouraged to visit the links on references to read more about it.</p>
</div>
<div id="why-would-you-use-a-function" class="section level2" number="44.3">
<h2><span class="header-section-number">44.3</span> Why would you use a function?</h2>
<p>Before answering this question, it is important to note that you have already had tips to get to write your very first R functions in the page on <a href="iteration-loops-and-lists.html#iteration-loops-and-lists">Iteration, loops, and lists</a> of this handbook. In fact, use of “if/else” and loops is often a core part of many of our functions since they easily help to either broaden the application of our code allowing multiple conditions or to iterate codes for repeating tasks.</p>
<ul>
<li><p>I am repeating multiple times the same block of code to apply it to a different variable or data?</p></li>
<li><p>Getting rid of it will it substantially shorten my overall code and make it run quicker?</p></li>
<li><p>Is it possible that the code I have written is used again but with a different value at many places of the code?</p></li>
</ul>
<p>If the answer to one of the previous questions is “YES”, then you probably need to write a function</p>
</div>
<div id="how-does-r-build-functions" class="section level2" number="44.4">
<h2><span class="header-section-number">44.4</span> How does R build functions?</h2>
<p>Functions in R have three main components:</p>
<ul>
<li><p>the <code>formals()</code> which is the list of arguments which controls how we can call the function</p></li>
<li><p>the <code>body()</code> that is the code inside the function i.e. within the brackets or following the parenthesis depending on how we write it</p></li>
</ul>
<p>and,</p>
<ul>
<li>the <code>environment()</code> which will help locate the function’s variables and determines how the function finds value.</li>
</ul>
<p>Once you have created your function, you can verify each of these components by calling the function associated.</p>
</div>
<div id="basic-syntax-and-structure" class="section level2" number="44.5">
<h2><span class="header-section-number">44.5</span> Basic syntax and structure</h2>
<ul>
<li><p>A function will need to be named properly so that its job is easily understandable as soon as we read its name. Actually this is already the case with majority of the base R architecture. Functions like <code>mean()</code>, <code>print()</code>, <code>summary()</code> have names that are very straightforward</p></li>
<li><p>A function will need arguments, such as the data to work on and other objects that can be static values among other options</p></li>
<li><p>And finally a function will give an output based on its core task and the arguments it has been given. Usually we will use the built-in functions as <code>print()</code>, <code>return()</code>… to produce the output. The output can be a logical value, a number, a character, a data frame…in short any kind of R object.</p></li>
</ul>
<p>Basically this is the composition of a function:</p>
<div class="sourceCode" id="cb1881"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1881-1"><a href="writing-functions-1.html#cb1881-1" aria-hidden="true" tabindex="-1"></a>function_name <span class="ot">&lt;-</span> <span class="cf">function</span>(argument_1, argument_2, argument_3){</span>
<span id="cb1881-2"><a href="writing-functions-1.html#cb1881-2" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb1881-3"><a href="writing-functions-1.html#cb1881-3" aria-hidden="true" tabindex="-1"></a>           function_task</span>
<span id="cb1881-4"><a href="writing-functions-1.html#cb1881-4" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb1881-5"><a href="writing-functions-1.html#cb1881-5" aria-hidden="true" tabindex="-1"></a>           <span class="fu">return</span>(output)</span>
<span id="cb1881-6"><a href="writing-functions-1.html#cb1881-6" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>We can create our first function that will be called <code>contain_covid19()</code>.</p>
<div class="sourceCode" id="cb1882"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1882-1"><a href="writing-functions-1.html#cb1882-1" aria-hidden="true" tabindex="-1"></a>contain_covid19 <span class="ot">&lt;-</span> <span class="cf">function</span>(barrier_gest, wear_mask, get_vaccine){</span>
<span id="cb1882-2"><a href="writing-functions-1.html#cb1882-2" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb1882-3"><a href="writing-functions-1.html#cb1882-3" aria-hidden="true" tabindex="-1"></a>                            <span class="cf">if</span>(barrier_gest <span class="sc">==</span> <span class="st">&quot;yes&quot;</span> <span class="sc">&amp;</span> wear_mask <span class="sc">==</span> <span class="st">&quot;yes&quot;</span> <span class="sc">&amp;</span> get_vaccine <span class="sc">==</span> <span class="st">&quot;yes&quot;</span> ) </span>
<span id="cb1882-4"><a href="writing-functions-1.html#cb1882-4" aria-hidden="true" tabindex="-1"></a>       </span>
<span id="cb1882-5"><a href="writing-functions-1.html#cb1882-5" aria-hidden="true" tabindex="-1"></a>                            <span class="fu">return</span>(<span class="st">&quot;success&quot;</span>)</span>
<span id="cb1882-6"><a href="writing-functions-1.html#cb1882-6" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb1882-7"><a href="writing-functions-1.html#cb1882-7" aria-hidden="true" tabindex="-1"></a>  <span class="cf">else</span>(<span class="st">&quot;please make sure all are yes, this pandemic has to end!&quot;</span>)</span>
<span id="cb1882-8"><a href="writing-functions-1.html#cb1882-8" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>We can then verify the components of our newly created function.</p>
<div class="sourceCode" id="cb1883"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1883-1"><a href="writing-functions-1.html#cb1883-1" aria-hidden="true" tabindex="-1"></a><span class="fu">formals</span>(contain_covid19)</span></code></pre></div>
<pre><code>## $barrier_gest
## 
## 
## $wear_mask
## 
## 
## $get_vaccine</code></pre>
<div class="sourceCode" id="cb1885"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1885-1"><a href="writing-functions-1.html#cb1885-1" aria-hidden="true" tabindex="-1"></a><span class="fu">body</span>(contain_covid19)</span></code></pre></div>
<pre><code>## {
##     if (barrier_gest == &quot;yes&quot; &amp; wear_mask == &quot;yes&quot; &amp; get_vaccine == 
##         &quot;yes&quot;) 
##         return(&quot;success&quot;)
##     else (&quot;please make sure all are yes, this pandemic has to end!&quot;)
## }</code></pre>
<div class="sourceCode" id="cb1887"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1887-1"><a href="writing-functions-1.html#cb1887-1" aria-hidden="true" tabindex="-1"></a><span class="fu">environment</span>(contain_covid19)</span></code></pre></div>
<pre><code>## &lt;environment: R_GlobalEnv&gt;</code></pre>
<p>Now we will test our function. To call our written function, you use it as you use all R functions i.e by writing the function name and adding the required arguments.</p>
<div class="sourceCode" id="cb1889"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1889-1"><a href="writing-functions-1.html#cb1889-1" aria-hidden="true" tabindex="-1"></a><span class="fu">contain_covid19</span>(<span class="at">barrier_gest =</span> <span class="st">&quot;yes&quot;</span>, <span class="at">wear_mask =</span> <span class="st">&quot;yes&quot;</span>, <span class="at">get_vaccine =</span> <span class="st">&quot;yes&quot;</span>)</span></code></pre></div>
<pre><code>## [1] &quot;success&quot;</code></pre>
<p>We can write again the name of each argument for precautionary reasons. But without specifying them, the code should work since R has in memory the positioning of each argument. So as long as you put the values of the arguments in the correct order, you can skip writing the arguments names when calling the functions.</p>
<div class="sourceCode" id="cb1891"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1891-1"><a href="writing-functions-1.html#cb1891-1" aria-hidden="true" tabindex="-1"></a><span class="fu">contain_covid19</span>(<span class="st">&quot;yes&quot;</span>, <span class="st">&quot;yes&quot;</span>, <span class="st">&quot;yes&quot;</span>)</span></code></pre></div>
<pre><code>## [1] &quot;success&quot;</code></pre>
<p>Then let’s look what happens if one of the values is <code>"no"</code> or <strong>not</strong> <code>"yes"</code>.</p>
<div class="sourceCode" id="cb1893"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1893-1"><a href="writing-functions-1.html#cb1893-1" aria-hidden="true" tabindex="-1"></a><span class="fu">contain_covid19</span>(<span class="at">barrier_gest =</span> <span class="st">&quot;yes&quot;</span>, <span class="at">wear_mask =</span> <span class="st">&quot;yes&quot;</span>, <span class="at">get_vaccine =</span> <span class="st">&quot;no&quot;</span>)</span></code></pre></div>
<pre><code>## [1] &quot;please make sure all are yes, this pandemic has to end!&quot;</code></pre>
<p>If we provide an argument that is not recognized, we get an error:</p>
<div class="sourceCode" id="cb1895"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1895-1"><a href="writing-functions-1.html#cb1895-1" aria-hidden="true" tabindex="-1"></a><span class="fu">contain_covid19</span>(<span class="at">barrier_gest =</span> <span class="st">&quot;sometimes&quot;</span>, <span class="at">wear_mask =</span> <span class="st">&quot;yes&quot;</span>, <span class="at">get_vaccine =</span> <span class="st">&quot;no&quot;</span>)</span></code></pre></div>
<p><code>Error in contain_covid19(barrier_gest = "sometimes", wear_mask = "yes",  :    could not find function "contain_covid19"</code></p>
<p><span style="color: black;"><strong><em>NOTE:</em></strong> Some functions (most of time very short and straightforward) may not need a name and can be used directly on a line of code or inside another function to do quick task. They are called <strong>anonymous functions</strong> .</span></p>
<p>For instance below is a first anonymous function that keeps only character variables the dataset.</p>
<div class="sourceCode" id="cb1896"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1896-1"><a href="writing-functions-1.html#cb1896-1" aria-hidden="true" tabindex="-1"></a>linelist <span class="sc">%&gt;%</span> </span>
<span id="cb1896-2"><a href="writing-functions-1.html#cb1896-2" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">slice_head</span>(<span class="at">n=</span><span class="dv">10</span>) <span class="sc">%&gt;%</span>  <span class="co">#equivalent to R base &quot;head&quot; function and that return first n observation of the  dataset</span></span>
<span id="cb1896-3"><a href="writing-functions-1.html#cb1896-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="cf">function</span>(x) <span class="fu">is.character</span>(x)) </span></code></pre></div>
<div id="htmlwidget-2b1bc3d0cc62cfc850c6" style="width:100%;height:auto;" class="datatables html-widget"></div>
<script type="application/json" data-for="htmlwidget-2b1bc3d0cc62cfc850c6">{"x":{"filter":"top","filterHTML":"<tr>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"disabled\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n<\/tr>","data":[["5fe599","8689b7","11f8ea","b8812a","893f25","be99c8","07e3e8","369449","f393b4","1389ca"],[null,"Recover","Recover",null,"Recover","Recover","Recover","Death","Recover","Death"],["m","f","m","f","m","f","f","f","m","f"],["years","years","years","years","years","years","years","years","years","years"],["Other","Missing","St. Mark's Maternity Hospital (SMMH)","Port Hospital","Military Hospital","Port Hospital","Missing","Missing","Missing","Missing"],["f547d6",null,null,"f90f5f","11f8ea","aec8ec","893f25","133ee7",null,null],["other",null,null,"other","other","other","other","other",null,null],["no",null,null,"no","no","no",null,"no","no","no"],["no",null,null,"no","no","no",null,"no","no","no"],["yes",null,null,"no","yes","yes",null,"yes","yes","yes"],["no",null,null,"no","no","no",null,"no","no","no"],["yes",null,null,"no","yes","yes",null,"yes","yes","no"],[null,"09:36","16:48","11:22","12:60","14:13","14:33","09:25","11:16","10:55"]],"container":"<table class=\"white-space: nowrap\">\n  <thead>\n    <tr>\n      <th>case_id<\/th>\n      <th>outcome<\/th>\n      <th>gender<\/th>\n      <th>age_unit<\/th>\n      <th>hospital<\/th>\n      <th>infector<\/th>\n      <th>source<\/th>\n      <th>fever<\/th>\n      <th>chills<\/th>\n      <th>cough<\/th>\n      <th>aches<\/th>\n      <th>vomit<\/th>\n      <th>time_admission<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"pageLength":10,"scrollX":true,"order":[],"autoWidth":false,"orderClasses":false,"orderCellsTop":true}},"evals":[],"jsHooks":[]}</script>
<p>Then another function that selects every second observation of our dataset (may be relevant when we have longitudinal data with many records per patient for instance after having ordered by date or visit).
In this case, the proper function writing outside dplyr would be <code>function (x) (x%%2 == 0)</code> to apply to the vector containing all row numbers.</p>
<div class="sourceCode" id="cb1897"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1897-1"><a href="writing-functions-1.html#cb1897-1" aria-hidden="true" tabindex="-1"></a>linelist <span class="sc">%&gt;%</span>   </span>
<span id="cb1897-2"><a href="writing-functions-1.html#cb1897-2" aria-hidden="true" tabindex="-1"></a>   <span class="fu">slice_head</span>(<span class="at">n=</span><span class="dv">20</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb1897-3"><a href="writing-functions-1.html#cb1897-3" aria-hidden="true" tabindex="-1"></a>   tibble<span class="sc">::</span><span class="fu">rownames_to_column</span>() <span class="sc">%&gt;%</span> <span class="co"># add indices of each obs as rownames to clearly see the final selection</span></span>
<span id="cb1897-4"><a href="writing-functions-1.html#cb1897-4" aria-hidden="true" tabindex="-1"></a>   <span class="fu">filter</span>(<span class="fu">row_number</span>() <span class="sc">%%</span><span class="dv">2</span> <span class="sc">==</span> <span class="dv">0</span>)</span></code></pre></div>
<div id="htmlwidget-c55b0ea5d7283ab5215a" style="width:100%;height:auto;" class="datatables html-widget"></div>
<script type="application/json" data-for="htmlwidget-c55b0ea5d7283ab5215a">{"x":{"filter":"top","filterHTML":"<tr>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"number\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none; position: absolute; width: 200px;\">\n      <div data-min=\"3\" data-max=\"9\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"date\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none; position: absolute; width: 200px;\">\n      <div data-min=\"1399075200000\" data-max=\"1403049600000\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"date\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none; position: absolute; width: 200px;\">\n      <div data-min=\"1399939200000\" data-max=\"1403740800000\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"date\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none; position: absolute; width: 200px;\">\n      <div data-min=\"1400025600000\" data-max=\"1403913600000\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"date\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none; position: absolute; width: 200px;\">\n      <div data-min=\"1400371200000\" data-max=\"1405036800000\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"number\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none; position: absolute; width: 200px;\">\n      <div data-min=\"0\" data-max=\"42\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"disabled\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"number\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none; position: absolute; width: 200px;\">\n      <div data-min=\"0\" data-max=\"42\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"factor\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"width: 100%; display: none;\">\n      <select multiple=\"multiple\" style=\"width: 100%;\" data-options=\"[&quot;0-4&quot;,&quot;5-9&quot;,&quot;10-14&quot;,&quot;15-19&quot;,&quot;20-29&quot;,&quot;30-49&quot;,&quot;50-69&quot;,&quot;70+&quot;]\"><\/select>\n    <\/div>\n  <\/td>\n  <td data-type=\"factor\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"width: 100%; display: none;\">\n      <select multiple=\"multiple\" style=\"width: 100%;\" data-options=\"[&quot;0-4&quot;,&quot;5-9&quot;,&quot;10-14&quot;,&quot;15-19&quot;,&quot;20-24&quot;,&quot;25-29&quot;,&quot;30-34&quot;,&quot;35-39&quot;,&quot;40-44&quot;,&quot;45-49&quot;,&quot;50-54&quot;,&quot;55-59&quot;,&quot;60-64&quot;,&quot;65-69&quot;,&quot;70-74&quot;,&quot;75-79&quot;,&quot;80-84&quot;,&quot;85+&quot;]\"><\/select>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"number\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none; position: absolute; width: 200px;\">\n      <div data-min=\"-13.2572163655863\" data-max=\"-13.209391925612\" data-scale=\"13\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"number\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none; position: absolute; width: 200px;\">\n      <div data-min=\"8.45171855856465\" data-max=\"8.48528034195779\" data-scale=\"14\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"number\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none; position: absolute; width: 200px;\">\n      <div data-min=\"0\" data-max=\"84\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"number\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none; position: absolute; width: 200px;\">\n      <div data-min=\"11\" data-max=\"186\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"number\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none; position: absolute; width: 200px;\">\n      <div data-min=\"21\" data-max=\"23\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"number\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none; position: absolute; width: 200px;\">\n      <div data-min=\"35.9\" data-max=\"38\" data-scale=\"1\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"number\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none; position: absolute; width: 200px;\">\n      <div data-min=\"0\" data-max=\"71.8184429761563\" data-scale=\"14\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"number\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none; position: absolute; width: 200px;\">\n      <div data-min=\"0\" data-max=\"2\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n<\/tr>","data":[["2","4","6","8","10","12","14","16","18","20"],["8689b7","b8812a","be99c8","369449","1389ca","57a565","2eaa9a","c97dd9","3a7673","ddddee"],[4,3,3,4,4,4,5,9,8,6],[null,"2014-05-04","2014-05-03","2014-05-28",null,"2014-05-28","2014-06-07",null,null,"2014-06-18"],["2014-05-13","2014-05-18","2014-05-22","2014-06-02","2014-06-05","2014-06-13","2014-06-17","2014-06-19","2014-06-23","2014-06-26"],["2014-05-14","2014-05-20","2014-05-23","2014-06-03","2014-06-07","2014-06-15","2014-06-17","2014-06-19","2014-06-24","2014-06-28"],["2014-05-18",null,"2014-05-24","2014-06-07","2014-06-09",null,null,"2014-07-11","2014-06-25","2014-07-02"],["Recover",null,"Recover","Death","Death","Death","Recover","Recover",null,"Death"],["f","f","f","f","f","m","f","m","f","f"],[3,18,16,0,27,42,7,13,17,11],["years","years","years","years","years","years","years","years","years","years"],[3,18,16,0,27,42,7,13,17,11],["0-4","15-19","15-19","0-4","20-29","30-49","5-9","10-14","15-19","10-14"],["0-4","15-19","15-19","0-4","25-29","40-44","5-9","10-14","15-19","10-14"],["Missing","Port Hospital","Port Hospital","Missing","Missing","Military Hospital","Missing","Port Hospital","Port Hospital","Other"],[-13.2152339775486,-13.2363711169728,-13.222625321098,-13.2320975453153,-13.2572163655863,-13.253989309478,-13.209391925612,-13.2243437095992,-13.21422143145,-13.2535640411465],[8.45171855856465,8.4754761613651,8.46183062600728,8.46144367534271,8.47292327643506,8.45837125340844,8.47570184950483,8.47145134147474,8.48528034195779,8.45957352078114],[null,"f90f5f","aec8ec","133ee7",null,"133ee7","9f6884",null,null,"8e104d"],[null,"other","other","other",null,"other","other",null,null,"other"],[25,41,56,0,69,84,44,66,47,47],[59,135,116,11,174,186,90,152,137,131],[22,23,21,22,22,22,21,22,21,23],[null,"no","no","no","no","no","no","no","no","no"],[null,"no","no","no","no","no","no","no","no","no"],[null,"no","yes","yes","yes","yes","yes","yes","yes","yes"],[null,"no","no","no","no","no","no","yes","no","no"],[null,"no","yes","yes","no","no","no","no","no","no"],[36.9,36.8,37.6,37,35.9,36.9,37.1,37.3,38,36],["09:36","11:22","14:13","09:25","10:55","11:14","11:06","08:45","15:41","18:58"],[71.8184429761563,22.4965706447188,41.6171224732461,0,22.7903289734443,24.2802636142907,54.320987654321,28.5664819944598,25.0412914912888,27.3876813705495],[1,2,1,1,2,2,0,0,1,2]],"container":"<table class=\"white-space: nowrap\">\n  <thead>\n    <tr>\n      <th>rowname<\/th>\n      <th>case_id<\/th>\n      <th>generation<\/th>\n      <th>date_infection<\/th>\n      <th>date_onset<\/th>\n      <th>date_hospitalisation<\/th>\n      <th>date_outcome<\/th>\n      <th>outcome<\/th>\n      <th>gender<\/th>\n      <th>age<\/th>\n      <th>age_unit<\/th>\n      <th>age_years<\/th>\n      <th>age_cat<\/th>\n      <th>age_cat5<\/th>\n      <th>hospital<\/th>\n      <th>lon<\/th>\n      <th>lat<\/th>\n      <th>infector<\/th>\n      <th>source<\/th>\n      <th>wt_kg<\/th>\n      <th>ht_cm<\/th>\n      <th>ct_blood<\/th>\n      <th>fever<\/th>\n      <th>chills<\/th>\n      <th>cough<\/th>\n      <th>aches<\/th>\n      <th>vomit<\/th>\n      <th>temp<\/th>\n      <th>time_admission<\/th>\n      <th>bmi<\/th>\n      <th>days_onset_hosp<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"pageLength":10,"scrollX":true,"columnDefs":[{"className":"dt-right","targets":[2,9,11,15,16,19,20,21,27,29,30]}],"order":[],"autoWidth":false,"orderClasses":false,"orderCellsTop":true}},"evals":[],"jsHooks":[]}</script>
<p>A possible base R code for the same task would be:</p>
<div class="sourceCode" id="cb1898"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1898-1"><a href="writing-functions-1.html#cb1898-1" aria-hidden="true" tabindex="-1"></a>linelist_firstobs <span class="ot">&lt;-</span> <span class="fu">head</span>(linelist, <span class="dv">20</span>)</span>
<span id="cb1898-2"><a href="writing-functions-1.html#cb1898-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1898-3"><a href="writing-functions-1.html#cb1898-3" aria-hidden="true" tabindex="-1"></a>linelist_firstobs[base<span class="sc">::</span><span class="fu">Filter</span>(<span class="cf">function</span>(x) (x<span class="sc">%%</span><span class="dv">2</span> <span class="sc">==</span> <span class="dv">0</span>), <span class="fu">seq</span>(<span class="fu">nrow</span>(linelist_firstobs))),]</span></code></pre></div>
<div id="htmlwidget-918d1170cb674c60dd74" style="width:100%;height:auto;" class="datatables html-widget"></div>
<script type="application/json" data-for="htmlwidget-918d1170cb674c60dd74">{"x":{"filter":"top","filterHTML":"<tr>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"number\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none; position: absolute; width: 200px;\">\n      <div data-min=\"3\" data-max=\"9\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"date\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none; position: absolute; width: 200px;\">\n      <div data-min=\"1399075200000\" data-max=\"1403049600000\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"date\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none; position: absolute; width: 200px;\">\n      <div data-min=\"1399939200000\" data-max=\"1403740800000\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"date\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none; position: absolute; width: 200px;\">\n      <div data-min=\"1400025600000\" data-max=\"1403913600000\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"date\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none; position: absolute; width: 200px;\">\n      <div data-min=\"1400371200000\" data-max=\"1405036800000\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"number\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none; position: absolute; width: 200px;\">\n      <div data-min=\"0\" data-max=\"42\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"disabled\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"number\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none; position: absolute; width: 200px;\">\n      <div data-min=\"0\" data-max=\"42\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"factor\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"width: 100%; display: none;\">\n      <select multiple=\"multiple\" style=\"width: 100%;\" data-options=\"[&quot;0-4&quot;,&quot;5-9&quot;,&quot;10-14&quot;,&quot;15-19&quot;,&quot;20-29&quot;,&quot;30-49&quot;,&quot;50-69&quot;,&quot;70+&quot;]\"><\/select>\n    <\/div>\n  <\/td>\n  <td data-type=\"factor\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"width: 100%; display: none;\">\n      <select multiple=\"multiple\" style=\"width: 100%;\" data-options=\"[&quot;0-4&quot;,&quot;5-9&quot;,&quot;10-14&quot;,&quot;15-19&quot;,&quot;20-24&quot;,&quot;25-29&quot;,&quot;30-34&quot;,&quot;35-39&quot;,&quot;40-44&quot;,&quot;45-49&quot;,&quot;50-54&quot;,&quot;55-59&quot;,&quot;60-64&quot;,&quot;65-69&quot;,&quot;70-74&quot;,&quot;75-79&quot;,&quot;80-84&quot;,&quot;85+&quot;]\"><\/select>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"number\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none; position: absolute; width: 200px;\">\n      <div data-min=\"-13.2572163655863\" data-max=\"-13.209391925612\" data-scale=\"13\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"number\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none; position: absolute; width: 200px;\">\n      <div data-min=\"8.45171855856465\" data-max=\"8.48528034195779\" data-scale=\"14\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"number\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none; position: absolute; width: 200px;\">\n      <div data-min=\"0\" data-max=\"84\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"number\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none; position: absolute; width: 200px;\">\n      <div data-min=\"11\" data-max=\"186\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"number\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none; position: absolute; width: 200px;\">\n      <div data-min=\"21\" data-max=\"23\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"number\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none; position: absolute; width: 200px;\">\n      <div data-min=\"35.9\" data-max=\"38\" data-scale=\"1\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"character\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"number\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none; position: absolute; width: 200px;\">\n      <div data-min=\"0\" data-max=\"71.8184429761563\" data-scale=\"14\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n  <td data-type=\"number\" style=\"vertical-align: top;\">\n    <div class=\"form-group has-feedback\" style=\"margin-bottom: auto;\">\n      <input type=\"search\" placeholder=\"All\" class=\"form-control\" style=\"width: 100%;\"/>\n      <span class=\"glyphicon glyphicon-remove-circle form-control-feedback\"><\/span>\n    <\/div>\n    <div style=\"display: none; position: absolute; width: 200px;\">\n      <div data-min=\"0\" data-max=\"2\"><\/div>\n      <span style=\"float: left;\"><\/span>\n      <span style=\"float: right;\"><\/span>\n    <\/div>\n  <\/td>\n<\/tr>","data":[["8689b7","b8812a","be99c8","369449","1389ca","57a565","2eaa9a","c97dd9","3a7673","ddddee"],[4,3,3,4,4,4,5,9,8,6],[null,"2014-05-04","2014-05-03","2014-05-28",null,"2014-05-28","2014-06-07",null,null,"2014-06-18"],["2014-05-13","2014-05-18","2014-05-22","2014-06-02","2014-06-05","2014-06-13","2014-06-17","2014-06-19","2014-06-23","2014-06-26"],["2014-05-14","2014-05-20","2014-05-23","2014-06-03","2014-06-07","2014-06-15","2014-06-17","2014-06-19","2014-06-24","2014-06-28"],["2014-05-18",null,"2014-05-24","2014-06-07","2014-06-09",null,null,"2014-07-11","2014-06-25","2014-07-02"],["Recover",null,"Recover","Death","Death","Death","Recover","Recover",null,"Death"],["f","f","f","f","f","m","f","m","f","f"],[3,18,16,0,27,42,7,13,17,11],["years","years","years","years","years","years","years","years","years","years"],[3,18,16,0,27,42,7,13,17,11],["0-4","15-19","15-19","0-4","20-29","30-49","5-9","10-14","15-19","10-14"],["0-4","15-19","15-19","0-4","25-29","40-44","5-9","10-14","15-19","10-14"],["Missing","Port Hospital","Port Hospital","Missing","Missing","Military Hospital","Missing","Port Hospital","Port Hospital","Other"],[-13.2152339775486,-13.2363711169728,-13.222625321098,-13.2320975453153,-13.2572163655863,-13.253989309478,-13.209391925612,-13.2243437095992,-13.21422143145,-13.2535640411465],[8.45171855856465,8.4754761613651,8.46183062600728,8.46144367534271,8.47292327643506,8.45837125340844,8.47570184950483,8.47145134147474,8.48528034195779,8.45957352078114],[null,"f90f5f","aec8ec","133ee7",null,"133ee7","9f6884",null,null,"8e104d"],[null,"other","other","other",null,"other","other",null,null,"other"],[25,41,56,0,69,84,44,66,47,47],[59,135,116,11,174,186,90,152,137,131],[22,23,21,22,22,22,21,22,21,23],[null,"no","no","no","no","no","no","no","no","no"],[null,"no","no","no","no","no","no","no","no","no"],[null,"no","yes","yes","yes","yes","yes","yes","yes","yes"],[null,"no","no","no","no","no","no","yes","no","no"],[null,"no","yes","yes","no","no","no","no","no","no"],[36.9,36.8,37.6,37,35.9,36.9,37.1,37.3,38,36],["09:36","11:22","14:13","09:25","10:55","11:14","11:06","08:45","15:41","18:58"],[71.8184429761563,22.4965706447188,41.6171224732461,0,22.7903289734443,24.2802636142907,54.320987654321,28.5664819944598,25.0412914912888,27.3876813705495],[1,2,1,1,2,2,0,0,1,2]],"container":"<table class=\"white-space: nowrap\">\n  <thead>\n    <tr>\n      <th>case_id<\/th>\n      <th>generation<\/th>\n      <th>date_infection<\/th>\n      <th>date_onset<\/th>\n      <th>date_hospitalisation<\/th>\n      <th>date_outcome<\/th>\n      <th>outcome<\/th>\n      <th>gender<\/th>\n      <th>age<\/th>\n      <th>age_unit<\/th>\n      <th>age_years<\/th>\n      <th>age_cat<\/th>\n      <th>age_cat5<\/th>\n      <th>hospital<\/th>\n      <th>lon<\/th>\n      <th>lat<\/th>\n      <th>infector<\/th>\n      <th>source<\/th>\n      <th>wt_kg<\/th>\n      <th>ht_cm<\/th>\n      <th>ct_blood<\/th>\n      <th>fever<\/th>\n      <th>chills<\/th>\n      <th>cough<\/th>\n      <th>aches<\/th>\n      <th>vomit<\/th>\n      <th>temp<\/th>\n      <th>time_admission<\/th>\n      <th>bmi<\/th>\n      <th>days_onset_hosp<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"pageLength":10,"scrollX":true,"columnDefs":[{"className":"dt-right","targets":[1,8,10,14,15,18,19,20,26,28,29]}],"order":[],"autoWidth":false,"orderClasses":false,"orderCellsTop":true}},"evals":[],"jsHooks":[]}</script>
<p><span style="color: orange;"><strong><em>CAUTION:</em></strong> Though it is true that using functions can help us with our code, it can nevertheless be time consuming to write some functions or to fix one if it has not been thought thoroughly, written adequately and is returning errors as a result. For this reason it is often recommended to first write the R code, make sure it does what we intend it to do, and then transform it into a function with its three main components as listed above. </span></p>
</div>
<div id="examples-2" class="section level2" number="44.6">
<h2><span class="header-section-number">44.6</span> Examples</h2>
<div id="return-proportion-tables-for-several-columns" class="section level3 unnumbered">
<h3>Return proportion tables for several columns</h3>
<p>Yes, we already have nice functions in many packages allowing to summarize information in a very easy and nice way. But we will still try to make our own, in our first steps to getting used to writing functions.</p>
<p>In this example we want to show how writing a simple function would avoid you copy-pasting the same code multiple times.</p>
<div class="sourceCode" id="cb1899"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1899-1"><a href="writing-functions-1.html#cb1899-1" aria-hidden="true" tabindex="-1"></a>proptab_multiple <span class="ot">&lt;-</span> <span class="cf">function</span>(my_data, var_to_tab){</span>
<span id="cb1899-2"><a href="writing-functions-1.html#cb1899-2" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb1899-3"><a href="writing-functions-1.html#cb1899-3" aria-hidden="true" tabindex="-1"></a>  <span class="co">#print the name of each variable of interest before doing the tabulation</span></span>
<span id="cb1899-4"><a href="writing-functions-1.html#cb1899-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(var_to_tab)</span>
<span id="cb1899-5"><a href="writing-functions-1.html#cb1899-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1899-6"><a href="writing-functions-1.html#cb1899-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">with</span>(my_data,</span>
<span id="cb1899-7"><a href="writing-functions-1.html#cb1899-7" aria-hidden="true" tabindex="-1"></a>       <span class="fu">rbind</span>( <span class="co">#bind the results of the two following function by row</span></span>
<span id="cb1899-8"><a href="writing-functions-1.html#cb1899-8" aria-hidden="true" tabindex="-1"></a>        <span class="co">#tabulate the variable of interest: gives only numbers</span></span>
<span id="cb1899-9"><a href="writing-functions-1.html#cb1899-9" aria-hidden="true" tabindex="-1"></a>          <span class="fu">table</span>(my_data[[var_to_tab]], <span class="at">useNA =</span> <span class="st">&quot;no&quot;</span>),</span>
<span id="cb1899-10"><a href="writing-functions-1.html#cb1899-10" aria-hidden="true" tabindex="-1"></a>          <span class="co">#calculate the proportions for each variable of interest and round the value to 2 decimals</span></span>
<span id="cb1899-11"><a href="writing-functions-1.html#cb1899-11" aria-hidden="true" tabindex="-1"></a>         <span class="fu">round</span>(<span class="fu">prop.table</span>(<span class="fu">table</span>(my_data[[var_to_tab]]))<span class="sc">*</span><span class="dv">100</span>,<span class="dv">2</span>)</span>
<span id="cb1899-12"><a href="writing-functions-1.html#cb1899-12" aria-hidden="true" tabindex="-1"></a>         )</span>
<span id="cb1899-13"><a href="writing-functions-1.html#cb1899-13" aria-hidden="true" tabindex="-1"></a>       )</span>
<span id="cb1899-14"><a href="writing-functions-1.html#cb1899-14" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb1899-15"><a href="writing-functions-1.html#cb1899-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1899-16"><a href="writing-functions-1.html#cb1899-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1899-17"><a href="writing-functions-1.html#cb1899-17" aria-hidden="true" tabindex="-1"></a><span class="fu">proptab_multiple</span>(linelist, <span class="st">&quot;gender&quot;</span>)</span></code></pre></div>
<pre><code>## [1] &quot;gender&quot;</code></pre>
<pre><code>##            f       m
## [1,] 2807.00 2803.00
## [2,]   50.04   49.96</code></pre>
<div class="sourceCode" id="cb1902"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1902-1"><a href="writing-functions-1.html#cb1902-1" aria-hidden="true" tabindex="-1"></a><span class="fu">proptab_multiple</span>(linelist, <span class="st">&quot;age_cat&quot;</span>)</span></code></pre></div>
<pre><code>## [1] &quot;age_cat&quot;</code></pre>
<pre><code>##          0-4     5-9  10-14  15-19   20-29 30-49 50-69 70+
## [1,] 1095.00 1095.00 941.00 743.00 1073.00   754 95.00 6.0
## [2,]   18.87   18.87  16.22  12.81   18.49    13  1.64 0.1</code></pre>
<div class="sourceCode" id="cb1905"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1905-1"><a href="writing-functions-1.html#cb1905-1" aria-hidden="true" tabindex="-1"></a><span class="fu">proptab_multiple</span>(linelist, <span class="st">&quot;outcome&quot;</span>)</span></code></pre></div>
<pre><code>## [1] &quot;outcome&quot;</code></pre>
<pre><code>##        Death Recover
## [1,] 2582.00 1983.00
## [2,]   56.56   43.44</code></pre>
<p><span style="color: darkgreen;"><strong><em>TIP:</em></strong> As shown above, it is very important to comment your functions as you would do for the general programming. Bear in mind that a function’s aim is to make a code ready to read, shorter and more efficient. Then one should be able to understand what the function does just by reading its name and should have more details reading the comments.</span></p>
<p>A second option is to use this function in another one via a loop to make the process at once:</p>
<div class="sourceCode" id="cb1908"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1908-1"><a href="writing-functions-1.html#cb1908-1" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(var_to_tab <span class="cf">in</span> <span class="fu">c</span>(<span class="st">&quot;gender&quot;</span>,<span class="st">&quot;age_cat&quot;</span>,  <span class="st">&quot;outcome&quot;</span>)){</span>
<span id="cb1908-2"><a href="writing-functions-1.html#cb1908-2" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb1908-3"><a href="writing-functions-1.html#cb1908-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(<span class="fu">proptab_multiple</span>(linelist, var_to_tab))</span>
<span id="cb1908-4"><a href="writing-functions-1.html#cb1908-4" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb1908-5"><a href="writing-functions-1.html#cb1908-5" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<pre><code>## [1] &quot;gender&quot;
##            f       m
## [1,] 2807.00 2803.00
## [2,]   50.04   49.96
## [1] &quot;age_cat&quot;
##          0-4     5-9  10-14  15-19   20-29 30-49 50-69 70+
## [1,] 1095.00 1095.00 941.00 743.00 1073.00   754 95.00 6.0
## [2,]   18.87   18.87  16.22  12.81   18.49    13  1.64 0.1
## [1] &quot;outcome&quot;
##        Death Recover
## [1,] 2582.00 1983.00
## [2,]   56.56   43.44</code></pre>
<p>A simpler way could be using the base R “apply” instead of a “for loop” as expressed below:</p>
<p><span style="color: darkgreen;"><strong><em>TIP:</em></strong> R is often defined as a functional programming language and almost anytime you run a line of code you are using some built-in functions. A good habit to be more comfortable with writing functions is to often have an internal look at how the basic functions you are using daily are built. The shortcut to do so is selecting the function name and then clicking on<code>Ctrl+F2</code> or <code>fn+F2</code> or <code>Cmd+F2</code> (depending on your computer) .</span></p>
</div>
</div>
<div id="using-purrr-writing-functions-that-can-be-iteratively-applied" class="section level2" number="44.7">
<h2><span class="header-section-number">44.7</span> Using <strong>purrr</strong>: writing functions that can be iteratively applied</h2>
<div id="modify-class-of-multiple-columns-in-a-dataset" class="section level3 unnumbered">
<h3>Modify class of multiple columns in a dataset</h3>
<p>Let’s say many character variables in the original <code>linelist</code> data need to be changes to “factor” for analysis and plotting purposes. Instead of repeating the step several times, we can just use <code>lapply()</code> to do the transformation of all variables concerned on a single line of code.</p>
<p><span style="color: orange;"><strong><em>CAUTION:</em></strong> <code>lapply()</code> returns a list, thus its use may require an additional modification as a last step.</span></p>
<p>The same step can be done using <code>map_if()</code> function from the <strong>purrr</strong> package</p>
<div class="sourceCode" id="cb1910"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1910-1"><a href="writing-functions-1.html#cb1910-1" aria-hidden="true" tabindex="-1"></a>linelist_factor2 <span class="ot">&lt;-</span> linelist <span class="sc">%&gt;%</span></span>
<span id="cb1910-2"><a href="writing-functions-1.html#cb1910-2" aria-hidden="true" tabindex="-1"></a>  purrr<span class="sc">::</span><span class="fu">map_if</span>(is.character, as.factor)</span>
<span id="cb1910-3"><a href="writing-functions-1.html#cb1910-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1910-4"><a href="writing-functions-1.html#cb1910-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1910-5"><a href="writing-functions-1.html#cb1910-5" aria-hidden="true" tabindex="-1"></a>linelist_factor2 <span class="sc">%&gt;%</span></span>
<span id="cb1910-6"><a href="writing-functions-1.html#cb1910-6" aria-hidden="true" tabindex="-1"></a>        <span class="fu">glimpse</span>()</span></code></pre></div>
<pre><code>## List of 30
##  $ case_id             : Factor w/ 5888 levels &quot;00031d&quot;,&quot;00086d&quot;,..: 2134 3022 396 4203 3084 4347 179 1241 5594 430 ...
##  $ generation          : num [1:5888] 4 4 2 3 3 3 4 4 4 4 ...
##  $ date_infection      : Date[1:5888], format: &quot;2014-05-08&quot; NA NA &quot;2014-05-04&quot; ...
##  $ date_onset          : Date[1:5888], format: &quot;2014-05-13&quot; &quot;2014-05-13&quot; &quot;2014-05-16&quot; &quot;2014-05-18&quot; ...
##  $ date_hospitalisation: Date[1:5888], format: &quot;2014-05-15&quot; &quot;2014-05-14&quot; &quot;2014-05-18&quot; &quot;2014-05-20&quot; ...
##  $ date_outcome        : Date[1:5888], format: NA &quot;2014-05-18&quot; &quot;2014-05-30&quot; NA ...
##  $ outcome             : Factor w/ 2 levels &quot;Death&quot;,&quot;Recover&quot;: NA 2 2 NA 2 2 2 1 2 1 ...
##  $ gender              : Factor w/ 2 levels &quot;f&quot;,&quot;m&quot;: 2 1 2 1 2 1 1 1 2 1 ...
##  $ age                 : num [1:5888] 2 3 56 18 3 16 16 0 61 27 ...
##  $ age_unit            : Factor w/ 2 levels &quot;months&quot;,&quot;years&quot;: 2 2 2 2 2 2 2 2 2 2 ...
##  $ age_years           : num [1:5888] 2 3 56 18 3 16 16 0 61 27 ...
##  $ age_cat             : Factor w/ 8 levels &quot;0-4&quot;,&quot;5-9&quot;,&quot;10-14&quot;,..: 1 1 7 4 1 4 4 1 7 5 ...
##  $ age_cat5            : Factor w/ 18 levels &quot;0-4&quot;,&quot;5-9&quot;,&quot;10-14&quot;,..: 1 1 12 4 1 4 4 1 13 6 ...
##  $ hospital            : Factor w/ 6 levels &quot;Central Hospital&quot;,..: 4 3 6 5 2 5 3 3 3 3 ...
##  $ lon                 : num [1:5888] -13.2 -13.2 -13.2 -13.2 -13.2 ...
##  $ lat                 : num [1:5888] 8.47 8.45 8.46 8.48 8.46 ...
##  $ infector            : Factor w/ 2697 levels &quot;00031d&quot;,&quot;002e6c&quot;,..: 2594 NA NA 2635 180 1799 1407 195 NA NA ...
##  $ source              : Factor w/ 2 levels &quot;funeral&quot;,&quot;other&quot;: 2 NA NA 2 2 2 2 2 NA NA ...
##  $ wt_kg               : num [1:5888] 27 25 91 41 36 56 47 0 86 69 ...
##  $ ht_cm               : num [1:5888] 48 59 238 135 71 116 87 11 226 174 ...
##  $ ct_blood            : num [1:5888] 22 22 21 23 23 21 21 22 22 22 ...
##  $ fever               : Factor w/ 2 levels &quot;no&quot;,&quot;yes&quot;: 1 NA NA 1 1 1 NA 1 1 1 ...
##  $ chills              : Factor w/ 2 levels &quot;no&quot;,&quot;yes&quot;: 1 NA NA 1 1 1 NA 1 1 1 ...
##  $ cough               : Factor w/ 2 levels &quot;no&quot;,&quot;yes&quot;: 2 NA NA 1 2 2 NA 2 2 2 ...
##  $ aches               : Factor w/ 2 levels &quot;no&quot;,&quot;yes&quot;: 1 NA NA 1 1 1 NA 1 1 1 ...
##  $ vomit               : Factor w/ 2 levels &quot;no&quot;,&quot;yes&quot;: 2 NA NA 1 2 2 NA 2 2 1 ...
##  $ temp                : num [1:5888] 36.8 36.9 36.9 36.8 36.9 37.6 37.3 37 36.4 35.9 ...
##  $ time_admission      : Factor w/ 1072 levels &quot;00:10&quot;,&quot;00:29&quot;,..: NA 308 746 415 514 589 609 297 409 387 ...
##  $ bmi                 : num [1:5888] 117.2 71.8 16.1 22.5 71.4 ...
##  $ days_onset_hosp     : num [1:5888] 2 1 2 2 1 1 2 1 1 2 ...</code></pre>
</div>
<div id="iteratively-produce-graphs-for-different-levels-of-a-variable" class="section level3 unnumbered">
<h3>Iteratively produce graphs for different levels of a variable</h3>
<p>We will produce here pie chart to look at the distribution of patient’s outcome in China during the H7N9 outbreak for each province. Instead of repeating the code for each of them, we will just apply a function that we will create.</p>
<div class="sourceCode" id="cb1912"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1912-1"><a href="writing-functions-1.html#cb1912-1" aria-hidden="true" tabindex="-1"></a><span class="co">#precising options for the use of highchart</span></span>
<span id="cb1912-2"><a href="writing-functions-1.html#cb1912-2" aria-hidden="true" tabindex="-1"></a><span class="fu">options</span>(<span class="at">highcharter.theme =</span>   highcharter<span class="sc">::</span><span class="fu">hc_theme_smpl</span>(<span class="at">tooltip =</span> <span class="fu">list</span>(<span class="at">valueDecimals =</span> <span class="dv">2</span>)))</span>
<span id="cb1912-3"><a href="writing-functions-1.html#cb1912-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1912-4"><a href="writing-functions-1.html#cb1912-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1912-5"><a href="writing-functions-1.html#cb1912-5" aria-hidden="true" tabindex="-1"></a><span class="co">#create a function called &quot;chart_outcome_province&quot; that takes as argument the dataset and the name of the province for which to plot the distribution of the outcome.</span></span>
<span id="cb1912-6"><a href="writing-functions-1.html#cb1912-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1912-7"><a href="writing-functions-1.html#cb1912-7" aria-hidden="true" tabindex="-1"></a>chart_outcome_province <span class="ot">&lt;-</span> <span class="cf">function</span>(data_used, prov){</span>
<span id="cb1912-8"><a href="writing-functions-1.html#cb1912-8" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb1912-9"><a href="writing-functions-1.html#cb1912-9" aria-hidden="true" tabindex="-1"></a>  tab_prov <span class="ot">&lt;-</span> data_used <span class="sc">%&gt;%</span> </span>
<span id="cb1912-10"><a href="writing-functions-1.html#cb1912-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(province <span class="sc">==</span> prov,</span>
<span id="cb1912-11"><a href="writing-functions-1.html#cb1912-11" aria-hidden="true" tabindex="-1"></a>           <span class="sc">!</span><span class="fu">is.na</span>(outcome))<span class="sc">%&gt;%</span> </span>
<span id="cb1912-12"><a href="writing-functions-1.html#cb1912-12" aria-hidden="true" tabindex="-1"></a>    <span class="fu">group_by</span>(outcome) <span class="sc">%&gt;%</span> </span>
<span id="cb1912-13"><a href="writing-functions-1.html#cb1912-13" aria-hidden="true" tabindex="-1"></a>    <span class="fu">count</span>() <span class="sc">%&gt;%</span></span>
<span id="cb1912-14"><a href="writing-functions-1.html#cb1912-14" aria-hidden="true" tabindex="-1"></a>    <span class="fu">adorn_totals</span>(<span class="at">where =</span> <span class="st">&quot;row&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb1912-15"><a href="writing-functions-1.html#cb1912-15" aria-hidden="true" tabindex="-1"></a>    <span class="fu">adorn_percentages</span>(<span class="at">denominator =</span> <span class="st">&quot;col&quot;</span>, )<span class="sc">%&gt;%</span></span>
<span id="cb1912-16"><a href="writing-functions-1.html#cb1912-16" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(</span>
<span id="cb1912-17"><a href="writing-functions-1.html#cb1912-17" aria-hidden="true" tabindex="-1"></a>        <span class="at">perc_outcome=</span> <span class="fu">round</span>(n<span class="sc">*</span><span class="dv">100</span>,<span class="dv">2</span>))</span>
<span id="cb1912-18"><a href="writing-functions-1.html#cb1912-18" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb1912-19"><a href="writing-functions-1.html#cb1912-19" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb1912-20"><a href="writing-functions-1.html#cb1912-20" aria-hidden="true" tabindex="-1"></a>  tab_prov <span class="sc">%&gt;%</span></span>
<span id="cb1912-21"><a href="writing-functions-1.html#cb1912-21" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(outcome <span class="sc">!=</span> <span class="st">&quot;Total&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb1912-22"><a href="writing-functions-1.html#cb1912-22" aria-hidden="true" tabindex="-1"></a>  highcharter<span class="sc">::</span><span class="fu">hchart</span>(</span>
<span id="cb1912-23"><a href="writing-functions-1.html#cb1912-23" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;pie&quot;</span>, <span class="fu">hcaes</span>(<span class="at">x =</span> outcome, <span class="at">y =</span> perc_outcome),</span>
<span id="cb1912-24"><a href="writing-functions-1.html#cb1912-24" aria-hidden="true" tabindex="-1"></a>    <span class="at">name =</span> <span class="fu">paste0</span>(<span class="st">&quot;Distibution of the outcome in:&quot;</span>, prov)</span>
<span id="cb1912-25"><a href="writing-functions-1.html#cb1912-25" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb1912-26"><a href="writing-functions-1.html#cb1912-26" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb1912-27"><a href="writing-functions-1.html#cb1912-27" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb1912-28"><a href="writing-functions-1.html#cb1912-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1912-29"><a href="writing-functions-1.html#cb1912-29" aria-hidden="true" tabindex="-1"></a><span class="fu">chart_outcome_province</span>(flu_china, <span class="st">&quot;Shanghai&quot;</span>)</span></code></pre></div>
<div id="htmlwidget-69f7aff7b77f2b800044" style="width:100%;height:500px;" class="highchart html-widget"></div>
<script type="application/json" data-for="htmlwidget-69f7aff7b77f2b800044">{"x":{"hc_opts":{"chart":{"reflow":true},"title":{"text":null},"yAxis":{"title":{"text":"perc_outcome"},"type":"linear"},"credits":{"enabled":false},"exporting":{"enabled":false},"boost":{"enabled":false},"plotOptions":{"series":{"label":{"enabled":false},"turboThreshold":0,"showInLegend":false},"treemap":{"layoutAlgorithm":"squarified"},"scatter":{"marker":{"symbol":"circle"}}},"series":[{"group":"group","data":[{"outcome":"Death","n":0.533333333333333,"perc_outcome":53.33,"y":53.33,"name":"Death"},{"outcome":"Recover","n":0.466666666666667,"perc_outcome":46.67,"y":46.67,"name":"Recover"}],"type":"pie","name":"Distibution of the outcome in:Shanghai"}],"xAxis":{"type":"category","title":{"text":"outcome"},"categories":null}},"theme":{"colors":["#d35400","#2980b9","#2ecc71","#f1c40f","#2c3e50","#7f8c8d"],"chart":{"style":{"fontFamily":"Roboto","color":"#666666"}},"title":{"align":"left","style":{"fontFamily":"Roboto Condensed","fontWeight":"bold"}},"subtitle":{"align":"left","style":{"fontFamily":"Roboto Condensed"}},"legend":{"align":"right","verticalAlign":"bottom"},"xAxis":{"gridLineWidth":1,"gridLineColor":"#F3F3F3","lineColor":"#F3F3F3","minorGridLineColor":"#F3F3F3","tickColor":"#F3F3F3","tickWidth":1},"yAxis":{"gridLineColor":"#F3F3F3","lineColor":"#F3F3F3","minorGridLineColor":"#F3F3F3","tickColor":"#F3F3F3","tickWidth":1},"plotOptions":{"line":{"marker":{"enabled":false}},"spline":{"marker":{"enabled":false}},"area":{"marker":{"enabled":false}},"areaspline":{"marker":{"enabled":false}},"arearange":{"marker":{"enabled":false}},"bubble":{"maxSize":"10%"}},"tooltip":{"valueDecimals":2}},"conf_opts":{"global":{"Date":null,"VMLRadialGradientURL":"http =//code.highcharts.com/list(version)/gfx/vml-radial-gradient.png","canvasToolsURL":"http =//code.highcharts.com/list(version)/modules/canvas-tools.js","getTimezoneOffset":null,"timezoneOffset":0,"useUTC":true},"lang":{"contextButtonTitle":"Chart context menu","decimalPoint":".","downloadJPEG":"Download JPEG image","downloadPDF":"Download PDF document","downloadPNG":"Download PNG image","downloadSVG":"Download SVG vector image","drillUpText":"Back to {series.name}","invalidDate":null,"loading":"Loading...","months":["January","February","March","April","May","June","July","August","September","October","November","December"],"noData":"No data to display","numericSymbols":["k","M","G","T","P","E"],"printChart":"Print chart","resetZoom":"Reset zoom","resetZoomTitle":"Reset zoom level 1:1","shortMonths":["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],"thousandsSep":" ","weekdays":["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"]}},"type":"chart","fonts":["Roboto","Roboto+Condensed"],"debug":false},"evals":[],"jsHooks":[]}</script>
<div class="sourceCode" id="cb1913"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1913-1"><a href="writing-functions-1.html#cb1913-1" aria-hidden="true" tabindex="-1"></a><span class="fu">chart_outcome_province</span>(flu_china,<span class="st">&quot;Zhejiang&quot;</span>)</span></code></pre></div>
<div id="htmlwidget-7765dd6c4b676141b60c" style="width:100%;height:500px;" class="highchart html-widget"></div>
<script type="application/json" data-for="htmlwidget-7765dd6c4b676141b60c">{"x":{"hc_opts":{"chart":{"reflow":true},"title":{"text":null},"yAxis":{"title":{"text":"perc_outcome"},"type":"linear"},"credits":{"enabled":false},"exporting":{"enabled":false},"boost":{"enabled":false},"plotOptions":{"series":{"label":{"enabled":false},"turboThreshold":0,"showInLegend":false},"treemap":{"layoutAlgorithm":"squarified"},"scatter":{"marker":{"symbol":"circle"}}},"series":[{"group":"group","data":[{"outcome":"Death","n":0.428571428571429,"perc_outcome":42.86,"y":42.86,"name":"Death"},{"outcome":"Recover","n":0.571428571428571,"perc_outcome":57.14,"y":57.14,"name":"Recover"}],"type":"pie","name":"Distibution of the outcome in:Zhejiang"}],"xAxis":{"type":"category","title":{"text":"outcome"},"categories":null}},"theme":{"colors":["#d35400","#2980b9","#2ecc71","#f1c40f","#2c3e50","#7f8c8d"],"chart":{"style":{"fontFamily":"Roboto","color":"#666666"}},"title":{"align":"left","style":{"fontFamily":"Roboto Condensed","fontWeight":"bold"}},"subtitle":{"align":"left","style":{"fontFamily":"Roboto Condensed"}},"legend":{"align":"right","verticalAlign":"bottom"},"xAxis":{"gridLineWidth":1,"gridLineColor":"#F3F3F3","lineColor":"#F3F3F3","minorGridLineColor":"#F3F3F3","tickColor":"#F3F3F3","tickWidth":1},"yAxis":{"gridLineColor":"#F3F3F3","lineColor":"#F3F3F3","minorGridLineColor":"#F3F3F3","tickColor":"#F3F3F3","tickWidth":1},"plotOptions":{"line":{"marker":{"enabled":false}},"spline":{"marker":{"enabled":false}},"area":{"marker":{"enabled":false}},"areaspline":{"marker":{"enabled":false}},"arearange":{"marker":{"enabled":false}},"bubble":{"maxSize":"10%"}},"tooltip":{"valueDecimals":2}},"conf_opts":{"global":{"Date":null,"VMLRadialGradientURL":"http =//code.highcharts.com/list(version)/gfx/vml-radial-gradient.png","canvasToolsURL":"http =//code.highcharts.com/list(version)/modules/canvas-tools.js","getTimezoneOffset":null,"timezoneOffset":0,"useUTC":true},"lang":{"contextButtonTitle":"Chart context menu","decimalPoint":".","downloadJPEG":"Download JPEG image","downloadPDF":"Download PDF document","downloadPNG":"Download PNG image","downloadSVG":"Download SVG vector image","drillUpText":"Back to {series.name}","invalidDate":null,"loading":"Loading...","months":["January","February","March","April","May","June","July","August","September","October","November","December"],"noData":"No data to display","numericSymbols":["k","M","G","T","P","E"],"printChart":"Print chart","resetZoom":"Reset zoom","resetZoomTitle":"Reset zoom level 1:1","shortMonths":["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],"thousandsSep":" ","weekdays":["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"]}},"type":"chart","fonts":["Roboto","Roboto+Condensed"],"debug":false},"evals":[],"jsHooks":[]}</script>
<div class="sourceCode" id="cb1914"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1914-1"><a href="writing-functions-1.html#cb1914-1" aria-hidden="true" tabindex="-1"></a><span class="fu">chart_outcome_province</span>(flu_china,<span class="st">&quot;Jiangsu&quot;</span>)</span></code></pre></div>
<div id="htmlwidget-b9a280ca5e3feac99a2e" style="width:100%;height:500px;" class="highchart html-widget"></div>
<script type="application/json" data-for="htmlwidget-b9a280ca5e3feac99a2e">{"x":{"hc_opts":{"chart":{"reflow":true},"title":{"text":null},"yAxis":{"title":{"text":"perc_outcome"},"type":"linear"},"credits":{"enabled":false},"exporting":{"enabled":false},"boost":{"enabled":false},"plotOptions":{"series":{"label":{"enabled":false},"turboThreshold":0,"showInLegend":false},"treemap":{"layoutAlgorithm":"squarified"},"scatter":{"marker":{"symbol":"circle"}}},"series":[{"group":"group","data":[{"outcome":"Death","n":0.285714285714286,"perc_outcome":28.57,"y":28.57,"name":"Death"},{"outcome":"Recover","n":0.714285714285714,"perc_outcome":71.43,"y":71.43,"name":"Recover"}],"type":"pie","name":"Distibution of the outcome in:Jiangsu"}],"xAxis":{"type":"category","title":{"text":"outcome"},"categories":null}},"theme":{"colors":["#d35400","#2980b9","#2ecc71","#f1c40f","#2c3e50","#7f8c8d"],"chart":{"style":{"fontFamily":"Roboto","color":"#666666"}},"title":{"align":"left","style":{"fontFamily":"Roboto Condensed","fontWeight":"bold"}},"subtitle":{"align":"left","style":{"fontFamily":"Roboto Condensed"}},"legend":{"align":"right","verticalAlign":"bottom"},"xAxis":{"gridLineWidth":1,"gridLineColor":"#F3F3F3","lineColor":"#F3F3F3","minorGridLineColor":"#F3F3F3","tickColor":"#F3F3F3","tickWidth":1},"yAxis":{"gridLineColor":"#F3F3F3","lineColor":"#F3F3F3","minorGridLineColor":"#F3F3F3","tickColor":"#F3F3F3","tickWidth":1},"plotOptions":{"line":{"marker":{"enabled":false}},"spline":{"marker":{"enabled":false}},"area":{"marker":{"enabled":false}},"areaspline":{"marker":{"enabled":false}},"arearange":{"marker":{"enabled":false}},"bubble":{"maxSize":"10%"}},"tooltip":{"valueDecimals":2}},"conf_opts":{"global":{"Date":null,"VMLRadialGradientURL":"http =//code.highcharts.com/list(version)/gfx/vml-radial-gradient.png","canvasToolsURL":"http =//code.highcharts.com/list(version)/modules/canvas-tools.js","getTimezoneOffset":null,"timezoneOffset":0,"useUTC":true},"lang":{"contextButtonTitle":"Chart context menu","decimalPoint":".","downloadJPEG":"Download JPEG image","downloadPDF":"Download PDF document","downloadPNG":"Download PNG image","downloadSVG":"Download SVG vector image","drillUpText":"Back to {series.name}","invalidDate":null,"loading":"Loading...","months":["January","February","March","April","May","June","July","August","September","October","November","December"],"noData":"No data to display","numericSymbols":["k","M","G","T","P","E"],"printChart":"Print chart","resetZoom":"Reset zoom","resetZoomTitle":"Reset zoom level 1:1","shortMonths":["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],"thousandsSep":" ","weekdays":["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"]}},"type":"chart","fonts":["Roboto","Roboto+Condensed"],"debug":false},"evals":[],"jsHooks":[]}</script>
</div>
<div id="iteratively-produce-tables-for-different-levels-of-a-variable" class="section level3 unnumbered">
<h3>Iteratively produce tables for different levels of a variable</h3>
<p>Here we will create three indicators to summarize in a table and we would like to produce this table for each of the provinces. Our indicators are the delay between onset and hospitalization, the percentage of recovery and the median age of cases.</p>
<div class="sourceCode" id="cb1915"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1915-1"><a href="writing-functions-1.html#cb1915-1" aria-hidden="true" tabindex="-1"></a>indic_1 <span class="ot">&lt;-</span> flu_china <span class="sc">%&gt;%</span> </span>
<span id="cb1915-2"><a href="writing-functions-1.html#cb1915-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(province) <span class="sc">%&gt;%</span> </span>
<span id="cb1915-3"><a href="writing-functions-1.html#cb1915-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb1915-4"><a href="writing-functions-1.html#cb1915-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">date_hosp=</span> <span class="fu">strptime</span>(date_of_hospitalisation, <span class="at">format =</span> <span class="st">&quot;%m/%d/%Y&quot;</span>),</span>
<span id="cb1915-5"><a href="writing-functions-1.html#cb1915-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">date_ons=</span> <span class="fu">strptime</span>(date_of_onset, <span class="at">format =</span> <span class="st">&quot;%m/%d/%Y&quot;</span>), </span>
<span id="cb1915-6"><a href="writing-functions-1.html#cb1915-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">delay_onset_hosp=</span> <span class="fu">as.numeric</span>(date_hosp <span class="sc">-</span> date_ons)<span class="sc">/</span><span class="dv">86400</span>,</span>
<span id="cb1915-7"><a href="writing-functions-1.html#cb1915-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">mean_delay_onset_hosp =</span> <span class="fu">round</span>(<span class="fu">mean</span>(delay_onset_hosp, <span class="at">na.rm=</span><span class="cn">TRUE</span> ), <span class="dv">0</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb1915-8"><a href="writing-functions-1.html#cb1915-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(province, mean_delay_onset_hosp)  <span class="sc">%&gt;%</span> </span>
<span id="cb1915-9"><a href="writing-functions-1.html#cb1915-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">distinct</span>()</span>
<span id="cb1915-10"><a href="writing-functions-1.html#cb1915-10" aria-hidden="true" tabindex="-1"></a>     </span>
<span id="cb1915-11"><a href="writing-functions-1.html#cb1915-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1915-12"><a href="writing-functions-1.html#cb1915-12" aria-hidden="true" tabindex="-1"></a>indic_2 <span class="ot">&lt;-</span>  flu_china <span class="sc">%&gt;%</span> </span>
<span id="cb1915-13"><a href="writing-functions-1.html#cb1915-13" aria-hidden="true" tabindex="-1"></a>            <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(outcome)) <span class="sc">%&gt;%</span> </span>
<span id="cb1915-14"><a href="writing-functions-1.html#cb1915-14" aria-hidden="true" tabindex="-1"></a>            <span class="fu">group_by</span>(province, outcome) <span class="sc">%&gt;%</span> </span>
<span id="cb1915-15"><a href="writing-functions-1.html#cb1915-15" aria-hidden="true" tabindex="-1"></a>            <span class="fu">count</span>() <span class="sc">%&gt;%</span></span>
<span id="cb1915-16"><a href="writing-functions-1.html#cb1915-16" aria-hidden="true" tabindex="-1"></a>            <span class="fu">pivot_wider</span>(<span class="at">names_from =</span> outcome, <span class="at">values_from =</span> n) <span class="sc">%&gt;%</span> </span>
<span id="cb1915-17"><a href="writing-functions-1.html#cb1915-17" aria-hidden="true" tabindex="-1"></a>    <span class="fu">adorn_totals</span>(<span class="at">where =</span> <span class="st">&quot;col&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb1915-18"><a href="writing-functions-1.html#cb1915-18" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(</span>
<span id="cb1915-19"><a href="writing-functions-1.html#cb1915-19" aria-hidden="true" tabindex="-1"></a>        <span class="at">perc_recovery=</span> <span class="fu">round</span>((Recover<span class="sc">/</span>Total)<span class="sc">*</span><span class="dv">100</span>,<span class="dv">2</span>))<span class="sc">%&gt;%</span> </span>
<span id="cb1915-20"><a href="writing-functions-1.html#cb1915-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(province, perc_recovery)</span>
<span id="cb1915-21"><a href="writing-functions-1.html#cb1915-21" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb1915-22"><a href="writing-functions-1.html#cb1915-22" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb1915-23"><a href="writing-functions-1.html#cb1915-23" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb1915-24"><a href="writing-functions-1.html#cb1915-24" aria-hidden="true" tabindex="-1"></a>indic_3 <span class="ot">&lt;-</span>  flu_china <span class="sc">%&gt;%</span> </span>
<span id="cb1915-25"><a href="writing-functions-1.html#cb1915-25" aria-hidden="true" tabindex="-1"></a>            <span class="fu">group_by</span>(province) <span class="sc">%&gt;%</span> </span>
<span id="cb1915-26"><a href="writing-functions-1.html#cb1915-26" aria-hidden="true" tabindex="-1"></a>            <span class="fu">mutate</span>(</span>
<span id="cb1915-27"><a href="writing-functions-1.html#cb1915-27" aria-hidden="true" tabindex="-1"></a>                    <span class="at">median_age_cases =</span> <span class="fu">median</span>(<span class="fu">as.numeric</span>(age), <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb1915-28"><a href="writing-functions-1.html#cb1915-28" aria-hidden="true" tabindex="-1"></a>            ) <span class="sc">%&gt;%</span> </span>
<span id="cb1915-29"><a href="writing-functions-1.html#cb1915-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(province, median_age_cases)  <span class="sc">%&gt;%</span> </span>
<span id="cb1915-30"><a href="writing-functions-1.html#cb1915-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">distinct</span>()</span></code></pre></div>
<pre><code>## Warning in median(as.numeric(age), na.rm = TRUE): NAs introduced by coercion</code></pre>
<div class="sourceCode" id="cb1917"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1917-1"><a href="writing-functions-1.html#cb1917-1" aria-hidden="true" tabindex="-1"></a><span class="co">#join the three indicator datasets</span></span>
<span id="cb1917-2"><a href="writing-functions-1.html#cb1917-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1917-3"><a href="writing-functions-1.html#cb1917-3" aria-hidden="true" tabindex="-1"></a>table_indic_all <span class="ot">&lt;-</span> indic_1 <span class="sc">%&gt;%</span> </span>
<span id="cb1917-4"><a href="writing-functions-1.html#cb1917-4" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">left_join</span>(indic_2, <span class="at">by =</span> <span class="st">&quot;province&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb1917-5"><a href="writing-functions-1.html#cb1917-5" aria-hidden="true" tabindex="-1"></a>        <span class="fu">left_join</span>(indic_3, <span class="at">by =</span> <span class="st">&quot;province&quot;</span>)</span>
<span id="cb1917-6"><a href="writing-functions-1.html#cb1917-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1917-7"><a href="writing-functions-1.html#cb1917-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1917-8"><a href="writing-functions-1.html#cb1917-8" aria-hidden="true" tabindex="-1"></a><span class="co">#print the indicators in a flextable</span></span>
<span id="cb1917-9"><a href="writing-functions-1.html#cb1917-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1917-10"><a href="writing-functions-1.html#cb1917-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1917-11"><a href="writing-functions-1.html#cb1917-11" aria-hidden="true" tabindex="-1"></a>print_indic_prov <span class="ot">&lt;-</span>  <span class="cf">function</span>(table_used, prov){</span>
<span id="cb1917-12"><a href="writing-functions-1.html#cb1917-12" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb1917-13"><a href="writing-functions-1.html#cb1917-13" aria-hidden="true" tabindex="-1"></a>  <span class="co">#first transform a bit the dataframe for printing ease</span></span>
<span id="cb1917-14"><a href="writing-functions-1.html#cb1917-14" aria-hidden="true" tabindex="-1"></a>  indic_prov <span class="ot">&lt;-</span> table_used <span class="sc">%&gt;%</span></span>
<span id="cb1917-15"><a href="writing-functions-1.html#cb1917-15" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(province<span class="sc">==</span>prov) <span class="sc">%&gt;%</span></span>
<span id="cb1917-16"><a href="writing-functions-1.html#cb1917-16" aria-hidden="true" tabindex="-1"></a>    <span class="fu">pivot_longer</span>(<span class="at">names_to =</span> <span class="st">&quot;Indicateurs&quot;</span>, <span class="at">cols =</span> <span class="dv">2</span><span class="sc">:</span><span class="dv">4</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb1917-17"><a href="writing-functions-1.html#cb1917-17" aria-hidden="true" tabindex="-1"></a>   <span class="fu">mutate</span>( <span class="at">indic_label =</span> <span class="fu">factor</span>(Indicateurs,</span>
<span id="cb1917-18"><a href="writing-functions-1.html#cb1917-18" aria-hidden="true" tabindex="-1"></a>   <span class="at">levels=</span> <span class="fu">c</span>(<span class="st">&quot;mean_delay_onset_hosp&quot;</span>,<span class="st">&quot;perc_recovery&quot;</span>,<span class="st">&quot;median_age_cases&quot;</span>),</span>
<span id="cb1917-19"><a href="writing-functions-1.html#cb1917-19" aria-hidden="true" tabindex="-1"></a>   <span class="at">labels=</span><span class="fu">c</span>(<span class="st">&quot;Mean delay onset-hosp&quot;</span>,<span class="st">&quot;Percentage of recovery&quot;</span>, <span class="st">&quot;Median age of the cases&quot;</span>))</span>
<span id="cb1917-20"><a href="writing-functions-1.html#cb1917-20" aria-hidden="true" tabindex="-1"></a>   ) <span class="sc">%&gt;%</span> </span>
<span id="cb1917-21"><a href="writing-functions-1.html#cb1917-21" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ungroup</span>(province) <span class="sc">%&gt;%</span> </span>
<span id="cb1917-22"><a href="writing-functions-1.html#cb1917-22" aria-hidden="true" tabindex="-1"></a>    <span class="fu">select</span>(indic_label, value)</span>
<span id="cb1917-23"><a href="writing-functions-1.html#cb1917-23" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb1917-24"><a href="writing-functions-1.html#cb1917-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1917-25"><a href="writing-functions-1.html#cb1917-25" aria-hidden="true" tabindex="-1"></a>    tab_print <span class="ot">&lt;-</span> <span class="fu">flextable</span>(indic_prov)  <span class="sc">%&gt;%</span></span>
<span id="cb1917-26"><a href="writing-functions-1.html#cb1917-26" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_vanilla</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb1917-27"><a href="writing-functions-1.html#cb1917-27" aria-hidden="true" tabindex="-1"></a>    flextable<span class="sc">::</span><span class="fu">fontsize</span>(<span class="at">part =</span> <span class="st">&quot;body&quot;</span>, <span class="at">size =</span> <span class="dv">10</span>) </span>
<span id="cb1917-28"><a href="writing-functions-1.html#cb1917-28" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb1917-29"><a href="writing-functions-1.html#cb1917-29" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb1917-30"><a href="writing-functions-1.html#cb1917-30" aria-hidden="true" tabindex="-1"></a>     tab_print <span class="ot">&lt;-</span> tab_print <span class="sc">%&gt;%</span> </span>
<span id="cb1917-31"><a href="writing-functions-1.html#cb1917-31" aria-hidden="true" tabindex="-1"></a>                  <span class="fu">autofit</span>()   <span class="sc">%&gt;%</span></span>
<span id="cb1917-32"><a href="writing-functions-1.html#cb1917-32" aria-hidden="true" tabindex="-1"></a>                  <span class="fu">set_header_labels</span>( </span>
<span id="cb1917-33"><a href="writing-functions-1.html#cb1917-33" aria-hidden="true" tabindex="-1"></a>                <span class="at">indic_label=</span> <span class="st">&quot;Indicateurs&quot;</span>, <span class="at">value=</span> <span class="st">&quot;Estimation&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb1917-34"><a href="writing-functions-1.html#cb1917-34" aria-hidden="true" tabindex="-1"></a>    flextable<span class="sc">::</span><span class="fu">bg</span>( <span class="at">bg =</span> <span class="st">&quot;darkblue&quot;</span>, <span class="at">part =</span> <span class="st">&quot;header&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb1917-35"><a href="writing-functions-1.html#cb1917-35" aria-hidden="true" tabindex="-1"></a>    flextable<span class="sc">::</span><span class="fu">bold</span>(<span class="at">part =</span> <span class="st">&quot;header&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb1917-36"><a href="writing-functions-1.html#cb1917-36" aria-hidden="true" tabindex="-1"></a>    flextable<span class="sc">::</span><span class="fu">color</span>(<span class="at">color =</span> <span class="st">&quot;white&quot;</span>, <span class="at">part =</span> <span class="st">&quot;header&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb1917-37"><a href="writing-functions-1.html#cb1917-37" aria-hidden="true" tabindex="-1"></a>    <span class="fu">add_header_lines</span>(<span class="at">values =</span> <span class="fu">paste0</span>(<span class="st">&quot;Indicateurs pour la province de: &quot;</span>, prov)) <span class="sc">%&gt;%</span> </span>
<span id="cb1917-38"><a href="writing-functions-1.html#cb1917-38" aria-hidden="true" tabindex="-1"></a><span class="fu">bold</span>(<span class="at">part =</span> <span class="st">&quot;header&quot;</span>)</span>
<span id="cb1917-39"><a href="writing-functions-1.html#cb1917-39" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb1917-40"><a href="writing-functions-1.html#cb1917-40" aria-hidden="true" tabindex="-1"></a> tab_print <span class="ot">&lt;-</span> <span class="fu">set_formatter_type</span>(tab_print,</span>
<span id="cb1917-41"><a href="writing-functions-1.html#cb1917-41" aria-hidden="true" tabindex="-1"></a>   <span class="at">fmt_double =</span> <span class="st">&quot;%.2f&quot;</span>,</span>
<span id="cb1917-42"><a href="writing-functions-1.html#cb1917-42" aria-hidden="true" tabindex="-1"></a>   <span class="at">na_str =</span> <span class="st">&quot;-&quot;</span>)</span>
<span id="cb1917-43"><a href="writing-functions-1.html#cb1917-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1917-44"><a href="writing-functions-1.html#cb1917-44" aria-hidden="true" tabindex="-1"></a>tab_print </span>
<span id="cb1917-45"><a href="writing-functions-1.html#cb1917-45" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb1917-46"><a href="writing-functions-1.html#cb1917-46" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb1917-47"><a href="writing-functions-1.html#cb1917-47" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1917-48"><a href="writing-functions-1.html#cb1917-48" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1917-49"><a href="writing-functions-1.html#cb1917-49" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1917-50"><a href="writing-functions-1.html#cb1917-50" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1917-51"><a href="writing-functions-1.html#cb1917-51" aria-hidden="true" tabindex="-1"></a><span class="fu">print_indic_prov</span>(table_indic_all, <span class="st">&quot;Shanghai&quot;</span>)</span></code></pre></div>
<template id="d1a86821-bfc7-4536-bb28-ba517988891f"><style>
.tabwid table{
  border-collapse:collapse;
  line-height:1;
  margin-left:auto;
  margin-right:auto;
  border-width: 0;
  display: table;
  margin-top: 1.275em;
  margin-bottom: 1.275em;
  border-spacing: 0;
  border-color: transparent;
}
.tabwid_left table{
  margin-left:0;
}
.tabwid_right table{
  margin-right:0;
}
.tabwid td {
    padding: 0;
}
.tabwid a {
  text-decoration: none;
}
.tabwid thead {
    background-color: transparent;
}
.tabwid tfoot {
    background-color: transparent;
}
.tabwid table tr {
background-color: transparent;
}
</style><div class="tabwid"><style>.cl-e30efe98{border-collapse:collapse;}.cl-e30820a0{font-family:'Arial';font-size:11pt;font-weight:bold;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-e30820a1{font-family:'Arial';font-size:11pt;font-weight:bold;font-style:normal;text-decoration:none;color:rgba(255, 255, 255, 1.00);background-color:transparent;}.cl-e30847b0{font-family:'Arial';font-size:10pt;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-e30847b1{margin:0;text-align:left;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-e30847b2{margin:0;text-align:right;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-e3086f10{width:48.7pt;background-color:transparent;vertical-align: middle;border-bottom: 0.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-e3086f11{width:129.5pt;background-color:transparent;vertical-align: middle;border-bottom: 0.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-e3086f12{width:48.7pt;background-color:transparent;vertical-align: middle;border-bottom: 0.5pt solid rgba(102, 102, 102, 1.00);border-top: 0.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-e3086f13{width:129.5pt;background-color:transparent;vertical-align: middle;border-bottom: 0.5pt solid rgba(102, 102, 102, 1.00);border-top: 0.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-e3086f14{width:129.5pt;background-color:transparent;vertical-align: middle;border-bottom: 2pt solid rgba(102, 102, 102, 1.00);border-top: 0.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-e3086f15{width:48.7pt;background-color:transparent;vertical-align: middle;border-bottom: 2pt solid rgba(102, 102, 102, 1.00);border-top: 0.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-e3086f16{width:129.5pt;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(255, 255, 255, 0.00);border-top: 0 solid rgba(255, 255, 255, 0.00);border-left: 0 solid rgba(255, 255, 255, 0.00);border-right: 0 solid rgba(255, 255, 255, 0.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-e3086f17{width:48.7pt;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(255, 255, 255, 0.00);border-top: 0 solid rgba(255, 255, 255, 0.00);border-left: 0 solid rgba(255, 255, 255, 0.00);border-right: 0 solid rgba(255, 255, 255, 0.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-e3086f18{width:48.7pt;background-clip: padding-box;background-color:rgba(0, 0, 139, 1.00);vertical-align: middle;border-bottom: 2pt solid rgba(102, 102, 102, 1.00);border-top: 2pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-e3086f19{width:129.5pt;background-clip: padding-box;background-color:rgba(0, 0, 139, 1.00);vertical-align: middle;border-bottom: 2pt solid rgba(102, 102, 102, 1.00);border-top: 2pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}</style><table class='cl-e30efe98'>
<thead><tr style="overflow-wrap:break-word;"><td  colspan="2"class="cl-e3086f16"><p class="cl-e30847b1"><span class="cl-e30820a0">Indicateurs pour la province de: Shanghai</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-e3086f19"><p class="cl-e30847b1"><span class="cl-e30820a1">Indicateurs</span></p></td><td class="cl-e3086f18"><p class="cl-e30847b2"><span class="cl-e30820a1">Estimation</span></p></td></tr></thead><tbody><tr style="overflow-wrap:break-word;"><td class="cl-e3086f11"><p class="cl-e30847b1"><span class="cl-e30847b0">Mean delay onset-hosp</span></p></td><td class="cl-e3086f10"><p class="cl-e30847b2"><span class="cl-e30847b0">4.0</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-e3086f13"><p class="cl-e30847b1"><span class="cl-e30847b0">Percentage of recovery</span></p></td><td class="cl-e3086f12"><p class="cl-e30847b2"><span class="cl-e30847b0">46.7</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-e3086f14"><p class="cl-e30847b1"><span class="cl-e30847b0">Median age of the cases</span></p></td><td class="cl-e3086f15"><p class="cl-e30847b2"><span class="cl-e30847b0">67.0</span></p></td></tr></tbody></table></div></template>
<div class="flextable-shadow-host" id="065d34c0-9177-4637-a675-39abb39f16eb"></div>
<script>
var dest = document.getElementById("065d34c0-9177-4637-a675-39abb39f16eb");
var template = document.getElementById("d1a86821-bfc7-4536-bb28-ba517988891f");
var caption = template.content.querySelector("caption");
if(caption) {
  caption.style.cssText = "display:block;text-align:center;";
  var newcapt = document.createElement("p");
  newcapt.appendChild(caption)
  dest.parentNode.insertBefore(newcapt, dest.previousSibling);
}
var fantome = dest.attachShadow({mode: 'open'});
var templateContent = template.content;
fantome.appendChild(templateContent);
</script>

<div class="sourceCode" id="cb1918"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1918-1"><a href="writing-functions-1.html#cb1918-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print_indic_prov</span>(table_indic_all, <span class="st">&quot;Jiangsu&quot;</span>)</span></code></pre></div>
<template id="db216f50-9c53-43d8-a440-b2f3b4676b5e"><style>
.tabwid table{
  border-collapse:collapse;
  line-height:1;
  margin-left:auto;
  margin-right:auto;
  border-width: 0;
  display: table;
  margin-top: 1.275em;
  margin-bottom: 1.275em;
  border-spacing: 0;
  border-color: transparent;
}
.tabwid_left table{
  margin-left:0;
}
.tabwid_right table{
  margin-right:0;
}
.tabwid td {
    padding: 0;
}
.tabwid a {
  text-decoration: none;
}
.tabwid thead {
    background-color: transparent;
}
.tabwid tfoot {
    background-color: transparent;
}
.tabwid table tr {
background-color: transparent;
}
</style><div class="tabwid"><style>.cl-e326cdfc{border-collapse:collapse;}.cl-e3201728{font-family:'Arial';font-size:11pt;font-weight:bold;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-e3201729{font-family:'Arial';font-size:11pt;font-weight:bold;font-style:normal;text-decoration:none;color:rgba(255, 255, 255, 1.00);background-color:transparent;}.cl-e320172a{font-family:'Arial';font-size:10pt;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-e320172b{margin:0;text-align:left;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-e320172c{margin:0;text-align:right;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-e3203e2e{width:48.7pt;background-color:transparent;vertical-align: middle;border-bottom: 0.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-e3203e2f{width:129.5pt;background-color:transparent;vertical-align: middle;border-bottom: 0.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-e3203e30{width:48.7pt;background-color:transparent;vertical-align: middle;border-bottom: 0.5pt solid rgba(102, 102, 102, 1.00);border-top: 0.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-e3203e31{width:129.5pt;background-color:transparent;vertical-align: middle;border-bottom: 0.5pt solid rgba(102, 102, 102, 1.00);border-top: 0.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-e3203e32{width:129.5pt;background-color:transparent;vertical-align: middle;border-bottom: 2pt solid rgba(102, 102, 102, 1.00);border-top: 0.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-e3203e33{width:48.7pt;background-color:transparent;vertical-align: middle;border-bottom: 2pt solid rgba(102, 102, 102, 1.00);border-top: 0.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-e3203e34{width:129.5pt;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(255, 255, 255, 0.00);border-top: 0 solid rgba(255, 255, 255, 0.00);border-left: 0 solid rgba(255, 255, 255, 0.00);border-right: 0 solid rgba(255, 255, 255, 0.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-e3203e35{width:48.7pt;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(255, 255, 255, 0.00);border-top: 0 solid rgba(255, 255, 255, 0.00);border-left: 0 solid rgba(255, 255, 255, 0.00);border-right: 0 solid rgba(255, 255, 255, 0.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-e3203e36{width:48.7pt;background-clip: padding-box;background-color:rgba(0, 0, 139, 1.00);vertical-align: middle;border-bottom: 2pt solid rgba(102, 102, 102, 1.00);border-top: 2pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-e3203e37{width:129.5pt;background-clip: padding-box;background-color:rgba(0, 0, 139, 1.00);vertical-align: middle;border-bottom: 2pt solid rgba(102, 102, 102, 1.00);border-top: 2pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}</style><table class='cl-e326cdfc'>
<thead><tr style="overflow-wrap:break-word;"><td  colspan="2"class="cl-e3203e34"><p class="cl-e320172b"><span class="cl-e3201728">Indicateurs pour la province de: Jiangsu</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-e3203e37"><p class="cl-e320172b"><span class="cl-e3201729">Indicateurs</span></p></td><td class="cl-e3203e36"><p class="cl-e320172c"><span class="cl-e3201729">Estimation</span></p></td></tr></thead><tbody><tr style="overflow-wrap:break-word;"><td class="cl-e3203e2f"><p class="cl-e320172b"><span class="cl-e320172a">Mean delay onset-hosp</span></p></td><td class="cl-e3203e2e"><p class="cl-e320172c"><span class="cl-e320172a">6.0</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-e3203e31"><p class="cl-e320172b"><span class="cl-e320172a">Percentage of recovery</span></p></td><td class="cl-e3203e30"><p class="cl-e320172c"><span class="cl-e320172a">71.4</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-e3203e32"><p class="cl-e320172b"><span class="cl-e320172a">Median age of the cases</span></p></td><td class="cl-e3203e33"><p class="cl-e320172c"><span class="cl-e320172a">55.0</span></p></td></tr></tbody></table></div></template>
<div class="flextable-shadow-host" id="5607bca9-6374-4d02-a657-52b546548ef1"></div>
<script>
var dest = document.getElementById("5607bca9-6374-4d02-a657-52b546548ef1");
var template = document.getElementById("db216f50-9c53-43d8-a440-b2f3b4676b5e");
var caption = template.content.querySelector("caption");
if(caption) {
  caption.style.cssText = "display:block;text-align:center;";
  var newcapt = document.createElement("p");
  newcapt.appendChild(caption)
  dest.parentNode.insertBefore(newcapt, dest.previousSibling);
}
var fantome = dest.attachShadow({mode: 'open'});
var templateContent = template.content;
fantome.appendChild(templateContent);
</script>

</div>
</div>
<div id="tips-and-best-practices-for-well-functioning-functions" class="section level2" number="44.8">
<h2><span class="header-section-number">44.8</span> Tips and best Practices for well functioning functions</h2>
<p>Functional programming is meant to ease code and facilitates its reading. It should produce the contrary. The tips below will help you having a clean code and easy to read code.</p>
<div id="naming-and-syntax" class="section level3 unnumbered">
<h3>Naming and syntax</h3>
<ul>
<li><p>Avoid using character that could have been easily already taken by other functions already existing in your environment</p></li>
<li><p>It is recommended for the function name to be short and straightforward to understand for another reader</p></li>
<li><p>It is preferred to use verbs as the function name and nouns for the argument names.</p></li>
</ul>
</div>
<div id="column-names-and-tidy-evaluation" class="section level3 unnumbered">
<h3>Column names and tidy evaluation</h3>
<p>If you want to know how to reference <em>column names</em> that are provided to your code as arguments, read this <a href="https://dplyr.tidyverse.org/articles/programming.html">tidyverse programming guidance</a>. Among the topics covered are <em>tidy evaluation</em> and use of the <em>embrace</em> <code>{{ }}</code> “double braces”</p>
<p>For example, here is a quick skeleton template code from page tutorial mentioned just above:</p>
<div class="sourceCode" id="cb1919"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1919-1"><a href="writing-functions-1.html#cb1919-1" aria-hidden="true" tabindex="-1"></a>var_summary <span class="ot">&lt;-</span> <span class="cf">function</span>(data, var) {</span>
<span id="cb1919-2"><a href="writing-functions-1.html#cb1919-2" aria-hidden="true" tabindex="-1"></a>  data <span class="sc">%&gt;%</span></span>
<span id="cb1919-3"><a href="writing-functions-1.html#cb1919-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">summarise</span>(<span class="at">n =</span> <span class="fu">n</span>(), <span class="at">min =</span> <span class="fu">min</span>({{ var }}), <span class="at">max =</span> <span class="fu">max</span>({{ var }}))</span>
<span id="cb1919-4"><a href="writing-functions-1.html#cb1919-4" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb1919-5"><a href="writing-functions-1.html#cb1919-5" aria-hidden="true" tabindex="-1"></a>mtcars <span class="sc">%&gt;%</span> </span>
<span id="cb1919-6"><a href="writing-functions-1.html#cb1919-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(cyl) <span class="sc">%&gt;%</span> </span>
<span id="cb1919-7"><a href="writing-functions-1.html#cb1919-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">var_summary</span>(mpg)</span></code></pre></div>
</div>
<div id="testing-and-error-handling" class="section level3 unnumbered">
<h3>Testing and Error handling</h3>
<p>The more complicated a function’s task the higher the possibility of errors. Thus it is sometimes necessary to add some verification within the funtion to help quickly understand where the error is from and find a way t fix it.</p>
<ul>
<li>It can be more than recommended to introduce a check on the missingness of one argument using <code>missing(argument)</code>. This simple check can return “TRUE” or “FALSE” value.</li>
</ul>
<div class="sourceCode" id="cb1920"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1920-1"><a href="writing-functions-1.html#cb1920-1" aria-hidden="true" tabindex="-1"></a>contain_covid19_missing <span class="ot">&lt;-</span> <span class="cf">function</span>(barrier_gest, wear_mask, get_vaccine){</span>
<span id="cb1920-2"><a href="writing-functions-1.html#cb1920-2" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb1920-3"><a href="writing-functions-1.html#cb1920-3" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">missing</span>(barrier_gest)) (<span class="fu">print</span>(<span class="st">&quot;please provide arg1&quot;</span>))</span>
<span id="cb1920-4"><a href="writing-functions-1.html#cb1920-4" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">missing</span>(wear_mask)) <span class="fu">print</span>(<span class="st">&quot;please provide arg2&quot;</span>)</span>
<span id="cb1920-5"><a href="writing-functions-1.html#cb1920-5" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">missing</span>(get_vaccine)) <span class="fu">print</span>(<span class="st">&quot;please provide arg3&quot;</span>)</span>
<span id="cb1920-6"><a href="writing-functions-1.html#cb1920-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1920-7"><a href="writing-functions-1.html#cb1920-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1920-8"><a href="writing-functions-1.html#cb1920-8" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="sc">!</span>barrier_gest <span class="sc">==</span> <span class="st">&quot;yes&quot;</span> <span class="sc">|</span> wear_mask <span class="sc">==</span><span class="st">&quot;yes&quot;</span> <span class="sc">|</span> get_vaccine <span class="sc">==</span> <span class="st">&quot;yes&quot;</span> ) </span>
<span id="cb1920-9"><a href="writing-functions-1.html#cb1920-9" aria-hidden="true" tabindex="-1"></a>       </span>
<span id="cb1920-10"><a href="writing-functions-1.html#cb1920-10" aria-hidden="true" tabindex="-1"></a>       <span class="fu">return</span> (<span class="st">&quot;you can do better&quot;</span>)</span>
<span id="cb1920-11"><a href="writing-functions-1.html#cb1920-11" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb1920-12"><a href="writing-functions-1.html#cb1920-12" aria-hidden="true" tabindex="-1"></a>  <span class="cf">else</span>(<span class="st">&quot;please make sure all are yes, this pandemic has to end!&quot;</span>)</span>
<span id="cb1920-13"><a href="writing-functions-1.html#cb1920-13" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb1920-14"><a href="writing-functions-1.html#cb1920-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1920-15"><a href="writing-functions-1.html#cb1920-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1920-16"><a href="writing-functions-1.html#cb1920-16" aria-hidden="true" tabindex="-1"></a><span class="fu">contain_covid19_missing</span>(<span class="at">get_vaccine =</span> <span class="st">&quot;yes&quot;</span>)</span></code></pre></div>
<pre><code>## [1] &quot;please provide arg1&quot;
## [1] &quot;please provide arg2&quot;</code></pre>
<pre><code>## Error in contain_covid19_missing(get_vaccine = &quot;yes&quot;): argument &quot;barrier_gest&quot; is missing, with no default</code></pre>
<ul>
<li>Use <code>stop()</code> for more detectable errors.</li>
</ul>
<div class="sourceCode" id="cb1923"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1923-1"><a href="writing-functions-1.html#cb1923-1" aria-hidden="true" tabindex="-1"></a>contain_covid19_stop <span class="ot">&lt;-</span> <span class="cf">function</span>(barrier_gest, wear_mask, get_vaccine){</span>
<span id="cb1923-2"><a href="writing-functions-1.html#cb1923-2" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb1923-3"><a href="writing-functions-1.html#cb1923-3" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span>(<span class="sc">!</span><span class="fu">is.character</span>(barrier_gest)) (<span class="fu">stop</span>(<span class="st">&quot;arg1 should be a character, please enter the value with `yes`, `no` or `sometimes&quot;</span>))</span>
<span id="cb1923-4"><a href="writing-functions-1.html#cb1923-4" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb1923-5"><a href="writing-functions-1.html#cb1923-5" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (barrier_gest <span class="sc">==</span> <span class="st">&quot;yes&quot;</span> <span class="sc">&amp;</span> wear_mask <span class="sc">==</span><span class="st">&quot;yes&quot;</span> <span class="sc">&amp;</span> get_vaccine <span class="sc">==</span> <span class="st">&quot;yes&quot;</span> ) </span>
<span id="cb1923-6"><a href="writing-functions-1.html#cb1923-6" aria-hidden="true" tabindex="-1"></a>       </span>
<span id="cb1923-7"><a href="writing-functions-1.html#cb1923-7" aria-hidden="true" tabindex="-1"></a>       <span class="fu">return</span> (<span class="st">&quot;success&quot;</span>)</span>
<span id="cb1923-8"><a href="writing-functions-1.html#cb1923-8" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb1923-9"><a href="writing-functions-1.html#cb1923-9" aria-hidden="true" tabindex="-1"></a>  <span class="cf">else</span>(<span class="st">&quot;please make sure all are yes, this pandemic has to end!&quot;</span>)</span>
<span id="cb1923-10"><a href="writing-functions-1.html#cb1923-10" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb1923-11"><a href="writing-functions-1.html#cb1923-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1923-12"><a href="writing-functions-1.html#cb1923-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1923-13"><a href="writing-functions-1.html#cb1923-13" aria-hidden="true" tabindex="-1"></a><span class="fu">contain_covid19_stop</span>(<span class="at">barrier_gest=</span><span class="dv">1</span>, <span class="at">wear_mask=</span><span class="st">&quot;yes&quot;</span>, <span class="at">get_vaccine =</span> <span class="st">&quot;no&quot;</span>)</span></code></pre></div>
<pre><code>## Error in contain_covid19_stop(barrier_gest = 1, wear_mask = &quot;yes&quot;, get_vaccine = &quot;no&quot;): arg1 should be a character, please enter the value with `yes`, `no` or `sometimes</code></pre>
<ul>
<li><p>As we see when we run most of the built-in functions, there are messages and warnings that can pop-up in certain conditions. We can integrate those in our written functions by using the functions <code>message()</code> and <code>warning()</code>.</p></li>
<li><p>We can handle errors also by using <code>safely()</code> which takes one function as an argument and executes it in a safe way. In fact the function will execute without stopping if it encounters an error. <code>safely()</code> returns as output a <strong>list</strong> with two objects which are the results and the error it “skipped”.</p></li>
</ul>
<p>We can verify by first running the <code>mean()</code> as function, then run it with <code>safely()</code>.</p>
<div class="sourceCode" id="cb1925"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1925-1"><a href="writing-functions-1.html#cb1925-1" aria-hidden="true" tabindex="-1"></a><span class="fu">map</span>(linelist, mean)</span></code></pre></div>
<pre><code>## $case_id
## [1] NA
## 
## $generation
## [1] 16.56165
## 
## $date_infection
## [1] NA
## 
## $date_onset
## [1] NA
## 
## $date_hospitalisation
## [1] &quot;2014-11-03&quot;
## 
## $date_outcome
## [1] NA
## 
## $outcome
## [1] NA
## 
## $gender
## [1] NA
## 
## $age
## [1] NA
## 
## $age_unit
## [1] NA
## 
## $age_years
## [1] NA
## 
## $age_cat
## [1] NA
## 
## $age_cat5
## [1] NA
## 
## $hospital
## [1] NA
## 
## $lon
## [1] -13.23381
## 
## $lat
## [1] 8.469638
## 
## $infector
## [1] NA
## 
## $source
## [1] NA
## 
## $wt_kg
## [1] 52.64487
## 
## $ht_cm
## [1] 124.9633
## 
## $ct_blood
## [1] 21.20686
## 
## $fever
## [1] NA
## 
## $chills
## [1] NA
## 
## $cough
## [1] NA
## 
## $aches
## [1] NA
## 
## $vomit
## [1] NA
## 
## $temp
## [1] NA
## 
## $time_admission
## [1] NA
## 
## $bmi
## [1] 46.89023
## 
## $days_onset_hosp
## [1] NA</code></pre>
<div class="sourceCode" id="cb1927"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1927-1"><a href="writing-functions-1.html#cb1927-1" aria-hidden="true" tabindex="-1"></a>safe_mean <span class="ot">&lt;-</span> <span class="fu">safely</span>(mean)</span>
<span id="cb1927-2"><a href="writing-functions-1.html#cb1927-2" aria-hidden="true" tabindex="-1"></a>linelist <span class="sc">%&gt;%</span> </span>
<span id="cb1927-3"><a href="writing-functions-1.html#cb1927-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">map</span>(safe_mean)</span></code></pre></div>
<pre><code>## $case_id
## $case_id$result
## [1] NA
## 
## $case_id$error
## NULL
## 
## 
## $generation
## $generation$result
## [1] 16.56165
## 
## $generation$error
## NULL
## 
## 
## $date_infection
## $date_infection$result
## [1] NA
## 
## $date_infection$error
## NULL
## 
## 
## $date_onset
## $date_onset$result
## [1] NA
## 
## $date_onset$error
## NULL
## 
## 
## $date_hospitalisation
## $date_hospitalisation$result
## [1] &quot;2014-11-03&quot;
## 
## $date_hospitalisation$error
## NULL
## 
## 
## $date_outcome
## $date_outcome$result
## [1] NA
## 
## $date_outcome$error
## NULL
## 
## 
## $outcome
## $outcome$result
## [1] NA
## 
## $outcome$error
## NULL
## 
## 
## $gender
## $gender$result
## [1] NA
## 
## $gender$error
## NULL
## 
## 
## $age
## $age$result
## [1] NA
## 
## $age$error
## NULL
## 
## 
## $age_unit
## $age_unit$result
## [1] NA
## 
## $age_unit$error
## NULL
## 
## 
## $age_years
## $age_years$result
## [1] NA
## 
## $age_years$error
## NULL
## 
## 
## $age_cat
## $age_cat$result
## [1] NA
## 
## $age_cat$error
## NULL
## 
## 
## $age_cat5
## $age_cat5$result
## [1] NA
## 
## $age_cat5$error
## NULL
## 
## 
## $hospital
## $hospital$result
## [1] NA
## 
## $hospital$error
## NULL
## 
## 
## $lon
## $lon$result
## [1] -13.23381
## 
## $lon$error
## NULL
## 
## 
## $lat
## $lat$result
## [1] 8.469638
## 
## $lat$error
## NULL
## 
## 
## $infector
## $infector$result
## [1] NA
## 
## $infector$error
## NULL
## 
## 
## $source
## $source$result
## [1] NA
## 
## $source$error
## NULL
## 
## 
## $wt_kg
## $wt_kg$result
## [1] 52.64487
## 
## $wt_kg$error
## NULL
## 
## 
## $ht_cm
## $ht_cm$result
## [1] 124.9633
## 
## $ht_cm$error
## NULL
## 
## 
## $ct_blood
## $ct_blood$result
## [1] 21.20686
## 
## $ct_blood$error
## NULL
## 
## 
## $fever
## $fever$result
## [1] NA
## 
## $fever$error
## NULL
## 
## 
## $chills
## $chills$result
## [1] NA
## 
## $chills$error
## NULL
## 
## 
## $cough
## $cough$result
## [1] NA
## 
## $cough$error
## NULL
## 
## 
## $aches
## $aches$result
## [1] NA
## 
## $aches$error
## NULL
## 
## 
## $vomit
## $vomit$result
## [1] NA
## 
## $vomit$error
## NULL
## 
## 
## $temp
## $temp$result
## [1] NA
## 
## $temp$error
## NULL
## 
## 
## $time_admission
## $time_admission$result
## [1] NA
## 
## $time_admission$error
## NULL
## 
## 
## $bmi
## $bmi$result
## [1] 46.89023
## 
## $bmi$error
## NULL
## 
## 
## $days_onset_hosp
## $days_onset_hosp$result
## [1] NA
## 
## $days_onset_hosp$error
## NULL</code></pre>
<p>As said previously, well commenting our codes is already a good way for having documentation in our work.</p>
<!-- ======================================================= -->
</div>
</div>
<div id="resources-36" class="section level2" number="44.9">
<h2><span class="header-section-number">44.9</span> Resources</h2>
<p><a href="https://r4ds.had.co.nz/functions.html">R for Data Science link</a></p>
<p><a href="https://www.rstudio.com/wp-content/uploads/2016/02/advancedR.pdf">Cheatsheet advance R programming</a></p>
<p><a href="https://purrr.tidyverse.org/">Cheatsheet purr Package</a></p>
<p><a href="https://youtube.videoken.com/embed/bzUmK0Y07ck">Video-ACM talk by Hadley Wickham: The joy of functional programming (how does map_dbl work)</a></p>

</div>
</div>
  </main>

  <div class="col-md-3 col-lg-2 d-none d-md-block sidebar sidebar-chapter">
    <nav id="toc" data-toggle="toc" aria-label="On this page">
      <h2>On this page</h2>
      <div id="book-on-this-page"></div>

      <div class="book-extra">
        <ul class="list-unstyled">
          <li><a id="book-source" href="#">View source <i class="fab fa-github"></i></a></li>
          <li><a id="book-edit" href="#">Edit this page <i class="fab fa-github"></i></a></li>
        </ul>
      </div>
    </nav>
  </div>

</div>
</div> <!-- .container -->

<footer class="bg-primary text-light mt-5">
  <div class="container"><div class="row">

  <div class="col-12 col-md-6 mt-3">
    <p>"<strong>The Epidemiologist R Handbook</strong>" was written by the handbook team. It was last built on 2021-08-31.</p>
  </div>

  <div class="col-12 col-md-6 mt-3">
    <p>This book was built by the <a class="text-light" href="https://bookdown.org">bookdown</a> R package.</p>
  </div>

</div></div>
</footer>


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
