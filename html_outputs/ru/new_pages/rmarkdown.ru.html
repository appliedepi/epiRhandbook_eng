<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="ru" xml:lang="ru"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.4.550">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Справочник эпидемиолога R - 40&nbsp; Отчеты с помощью R Markdown</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<link href="../new_pages/reportfactory.ru.html" rel="next">
<link href="../new_pages/interactive_plots.ru.html" rel="prev">
<link href="../images/Applied_Epi_logo.png" rel="icon" type="image/png">
<script src="../site_libs/quarto-html/quarto.js"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting-dark.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-bootstrap" data-mode="light">
<link href="../site_libs/bootstrap/bootstrap-dark.min.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-bootstrap" data-mode="dark">
<script src="../site_libs/quarto-contrib/glightbox/glightbox.min.js"></script>
<link href="../site_libs/quarto-contrib/glightbox/glightbox.min.css" rel="stylesheet">
<link href="../site_libs/quarto-contrib/glightbox/lightbox.css" rel="stylesheet">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "language": {
    "search-no-results-text": "Поиск не дал результатов",
    "search-matching-documents-text": "Результаты поиска",
    "search-copy-link-title": "Скопировать ссылку",
    "search-hide-matches-text": "Скрыть дополнительные результаты",
    "search-more-match-text": "дополнительный результат в этом документе",
    "search-more-matches-text": "дополнительных результата(-ов) в этом документе",
    "search-clear-button-title": "Очистить",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Отменить",
    "search-submit-button-title": "Найти",
    "search-label": "Поиск"
  }
}</script>
<script async="" src="https://www.googletagmanager.com/gtag/js?id=G-QXDW878QLX"></script>

<script type="text/javascript">

window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'G-QXDW878QLX', { 'anonymize_ip': true});
</script>
<!-- Global site tag (gtag.js) - Google Analytics 
<script async src="https://www.googletagmanager.com/gtag/js?id=G-QXDW878QLX"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-QXDW878QLX');
</script> -->

</head><body class="nav-sidebar floating"><div class="alert alert-info alert-dismissible">
  <!-- <a href="#" class="close" data-dismiss="alert" aria-label="close">&times;</a>
  <strong>Need help learning R?</strong> Enroll in Applied Epi's <a href="https://www.appliedepi.org/live/"
    class="alert-link">intro R course</a>, try our <a href="https://www.appliedepi.org/tutorial/"
    class="alert-link">free R tutorials</a>, post in our <a href="https://community.appliedepi.org/"
    class="alert-link">Community Q&A forum</a>, or ask about our <a href="mailto:contact@appliedepi.org"
    class="alert-link">R Help Desk service</a>. -->
</div>

<script>

  // Function to extract the last two characters from the URL path to determine the language, adjusting for .html extension
  function getLanguageFromURL() {
    let path = window.location.pathname;
    
    // Check if the URL ends with .html and remove it
    if (path.endsWith('.html')) {
      path = path.substring(0, path.length - 5);
    }

    // Extract the last two characters for the language code
    const lang = path.substr(-2);
    return lang;
  }

  const language = getLanguageFromURL();
  const supportedLanguages = ['fr', 'es', 'vn', 'jp', 'pt', 'tr', 'ru'];
  const defaultLanguage = 'en';
  const isSupportedLanguage = supportedLanguages.includes(language);

  // Translations for the content
  const translations = {
    en: '<strong>Need help learning R?</strong> Enroll in Applied Epi\'s <a href="https://www.appliedepi.org/live/" class="alert-link">intro R course</a>, try our <a href="https://www.appliedepi.org/tutorial/" class="alert-link">free R tutorials</a>, post in our <a href="https://community.appliedepi.org/" class="alert-link">Community Q&A forum</a>, or ask about our <a href="mailto:contact@appliedepi.org" class="alert-link">R Help Desk service</a>.',
    fr: '<strong>Besoin d\'aide pour apprendre R ?</strong> Inscrivez-vous au <a href="https://www.appliedepi.org/live/" class="alert-link">cours d\'introduction à R</a> d\'Applied Epi, essayez nos <a href="https://www.appliedepi.org/tutorial/" class="alert-link">tutoriels R gratuits</a>, postez dans notre forum de <a href="https://community.appliedepi.org/" class="alert-link">questions-réponses communautaires</a>, ou demandez-nous des informations sur <a href="mailto:contact@appliedepi.org" class="alert-link"> notre service d\'assistance R</a>.',
    es: '<strong>¿Necesitas ayuda para aprender R?</strong> Inscríbete en el <a href="https://www.appliedepi.org/live/" class="alert-link">Curso de introducción a R</a> de Applied Epi, prueba nuestros <a href="https://www.appliedepi.org/tutorial/" class="alert-link">Tutoriales gratuitos de R</a>, escribe en nuestro <a href="https://community.appliedepi.org/" class="alert-link">Foro de preguntas y respuestas,</a> o pregunta por nuestra <a href="mailto:contact@appliedepi.org" class="alert-link">Asistencia técnica para R</a>.',
    vn: '<strong>Bạn cần giúp đỡ trong việc học R?</strong> Hãy đăng ký khóa học R cơ bản của Applied Epi tại <a href="https://www.appliedepi.org/live/" class="alert-link">đây</a>, hoặc thử các <a href="https://www.appliedepi.org/tutorial/" class="alert-link">hướng dẫn R miễn phí</a>, đăng bài trong <a href="https://community.appliedepi.org/" class="alert-link">diễn đàn cộng đồng</a>, hoặc gửi câu hỏi tới <a href="mailto:contact@appliedepi.org" class="alert-link">dịch vụ Trợ giúp R</a> của chúng tôi.',
    jp: '<strong>Rの学習について助けが必要ですか？</strong>Applied Epiの<a href="https://www.appliedepi.org/live/" class="alert-link">R入門コース</a>に登録するか、<a href="https://www.appliedepi.org/tutorial/" class="alert-link">無料Rチュートリアル</a>を試すか、<a href="https://community.appliedepi.org/" class="alert-link">コミュニティQ＆Aフォーラム</a>に投稿するか、<a href="mailto:contact@appliedepi.org" class="alert-link">Rヘルプデスクサービス</a>についてお問い合わせください。',
    pt: '<strong>Você precisa de ajuda para aprender R??</strong> Inscreva-se no curso de <a href="https://www.appliedepi.org/live/" class="alert-link">introdução ao R da Applied Epi</a>, experimente nossos <a href="https://www.appliedepi.org/tutorial/" class="alert-link">tutoriais gratuitos sobre o R</a>, publique em nosso <a href="https://community.appliedepi.org/" class="alert-link">fórum de perguntas e respostas</a>, ou solicite nosso <a href="mailto:contact@appliedepi.org" class="alert-link">suporte ao R</a>.',
    tr: '<strong>R öğrenmekte yardıma mı ihtiyacınız var?</strong> Applied Epi\'\nin <a href="https://www.appliedepi.org/live/" class="alert-link">R\'ye giriş kursuna</a> kaydolun, <a href="https://www.appliedepi.org/tutorial/" class="alert-link">ücretsiz R derslerimizi</a> deneyin, <a href="https://community.appliedepi.org/" class="alert-link">Topluluk Q&A forumunda</a> soru paylaşın, ya da <a href="mailto:contact@appliedepi.org" class="alert-link">R Yardım Masası hizmetimiz</a> hakkında sorun.',
    ru: '<strong>Нужна помощь в изучении R?</strong> Запишитесь на <a href="https://www.appliedepi.org/live/" class="alert-link">вводный курс по R</a> от Applied Epi, попробуйте наши <a href="https://www.appliedepi.org/tutorial/" class="alert-link">бесплатные учебные материалы по R</a>, задайте вопрос в нашем <a href="https://community.appliedepi.org/" class="alert-link">форуме вопросов и ответов сообщества</a>, или спросите о нашей услуге <a href="mailto:contact@appliedepi.org" class="alert-link">Службы поддержки по R</a>.'
  };

  // Default to English if the detected language is not supported
  const contentToDisplay = translations[isSupportedLanguage ? language : defaultLanguage];


  // Select the element where the content should be displayed
  const alertElement = document.querySelector('.alert');
  if (alertElement) {
    alertElement.innerHTML = contentToDisplay;
    alertElement.style.display = 'block'; // Make sure to display the element
  }

</script>






<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Переключить боковую панель навигации" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../new_pages/rmarkdown.ru.html">Отчеты и информационные панели</a></li><li class="breadcrumb-item"><a href="../new_pages/rmarkdown.ru.html"><span class="chapter-number">40</span>&nbsp; <span class="chapter-title">Отчеты с помощью R Markdown</span></a></li></ol></nav>
        <a class="flex-grow-1" role="button" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Переключить боковую панель навигации" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header sidebar-header-stacked">
      <a href="../index.html" class="sidebar-logo-link">
      <img src="../images/Applied_Epi_logo.png" alt="" class="sidebar-logo py-0 d-lg-inline d-none">
      </a>
    <div class="sidebar-title mb-0 py-0">
      <a href="../">Справочник эпидемиолога R</a> 
        <div class="sidebar-tools-main tools-wide">
    <a href="https://twitter.com/appliedepi" title="" class="quarto-navigation-tool px-1" aria-label=""><i class="bi bi-twitter"></i></a>
    <a href="https://www.linkedin.com/company/appliedepi/" title="" class="quarto-navigation-tool px-1" aria-label=""><i class="bi bi-linkedin"></i></a>
    <a href="https://github.com/appliedepi/epihandbook_quarto" title="Исходный код" class="quarto-navigation-tool px-1" aria-label="Исходный код"><i class="bi bi-github"></i></a>
    <div class="dropdown">
      <a href="" title="Share" id="quarto-navigation-tool-dropdown-0" class="quarto-navigation-tool dropdown-toggle px-1" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Share"><i class="bi bi-share"></i></a>
      <ul class="dropdown-menu" aria-labelledby="quarto-navigation-tool-dropdown-0">
          <li>
            <a class="dropdown-item sidebar-tools-main-item" href="https://twitter.com/intent/tweet?url=|url|">
              <i class="bi bi-bi-twitter pe-1"></i>
            Twitter
            </a>
          </li>
          <li>
            <a class="dropdown-item sidebar-tools-main-item" href="https://www.facebook.com/sharer/sharer.php?u=|url|">
              <i class="bi bi-bi-facebook pe-1"></i>
            Facebook
            </a>
          </li>
          <li>
            <a class="dropdown-item sidebar-tools-main-item" href="https://www.linkedin.com/sharing/share-offsite/?url=|url|">
              <i class="bi bi-bi-linkedin pe-1"></i>
            LinkedIn
            </a>
          </li>
      </ul>
    </div>
  <a href="" class="quarto-color-scheme-toggle quarto-navigation-tool  px-1" onclick="window.quartoToggleColorScheme(); return false;" title="Переключить темный режим"><i class="bi"></i></a>
</div>
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Поиск"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../index.ru.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Добро пожаловать</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true">
 <span class="menu-text">Об этой книге</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true" aria-label="Переключить раздел">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../new_pages/editorial_style.ru.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Редакционные и технические замечания</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../new_pages/data_used.ru.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Скачивание руководства и данных</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true">
 <span class="menu-text">Основы</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true" aria-label="Переключить раздел">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../new_pages/basics.ru.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Основы R</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../new_pages/transition_to_R.ru.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Переход к R</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../new_pages/packages_suggested.ru.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Рекомендованные пакеты</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../new_pages/r_projects.ru.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Проекты R</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../new_pages/importing.ru.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Импорт и экспорт</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="true">
 <span class="menu-text">Управление данными</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="true" aria-label="Переключить раздел">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../new_pages/cleaning.ru.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Вычистка данных и ключевые функции</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../new_pages/dates.ru.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Работа с датами</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../new_pages/characters_strings.ru.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Текст и последовательности</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../new_pages/factors.ru.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Факторы</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../new_pages/pivoting.ru.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">Поворот данных</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../new_pages/grouping.ru.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">Группирование данных</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../new_pages/joining_matching.ru.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">14</span>&nbsp; <span class="chapter-title">Соединение данных</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../new_pages/deduplication.ru.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">15</span>&nbsp; <span class="chapter-title">Дедупликация</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../new_pages/iteration.ru.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">16</span>&nbsp; <span class="chapter-title">Итерации, циклы и списки</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" aria-expanded="true">
 <span class="menu-text">Анализ</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" aria-expanded="true" aria-label="Переключить раздел">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../new_pages/tables_descriptive.ru.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">17</span>&nbsp; <span class="chapter-title">Описательные таблицы</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../new_pages/stat_tests.ru.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">18</span>&nbsp; <span class="chapter-title">Простые статистические тесты</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../new_pages/regression.ru.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">19</span>&nbsp; <span class="chapter-title">Однофакторная и многофакторная регрессия</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../new_pages/missing_data.ru.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">20</span>&nbsp; <span class="chapter-title">Отсутствующие данные</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../new_pages/standardization.ru.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">21</span>&nbsp; <span class="chapter-title">Стандартизированные коэффициенты</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../new_pages/moving_average.ru.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">22</span>&nbsp; <span class="chapter-title">Скользящие средние значения</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../new_pages/time_series.ru.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">23</span>&nbsp; <span class="chapter-title">Временные ряды и обнаружение вспышек</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../new_pages/epidemic_models.ru.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">24</span>&nbsp; <span class="chapter-title">Моделирование эпидемий</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../new_pages/contact_tracing.ru.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">25</span>&nbsp; <span class="chapter-title">Отслеживание контактов</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../new_pages/survey_analysis.ru.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">26</span>&nbsp; <span class="chapter-title">Анализ опросов</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../new_pages/survival_analysis.ru.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">27</span>&nbsp; <span class="chapter-title">Анализ выживаемости</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../new_pages/gis.ru.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">28</span>&nbsp; <span class="chapter-title">Основы ГИС</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" aria-expanded="true">
 <span class="menu-text">Визуализация данных</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" aria-expanded="true" aria-label="Переключить раздел">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-5" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../new_pages/tables_presentation.ru.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">29</span>&nbsp; <span class="chapter-title">Таблицы для презентации</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../new_pages/ggplot_basics.ru.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">30</span>&nbsp; <span class="chapter-title">Основы ggplot</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../new_pages/ggplot_tips.ru.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">31</span>&nbsp; <span class="chapter-title">Советы по использованию ggplot</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../new_pages/epicurves.ru.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">32</span>&nbsp; <span class="chapter-title">Эпидемические кривые</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../new_pages/age_pyramid.ru.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">33</span>&nbsp; <span class="chapter-title">Демографические пирамиды и шкалы Лайкерта</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../new_pages/heatmaps.ru.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">34</span>&nbsp; <span class="chapter-title">Тепловые диаграммы</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../new_pages/diagrams.ru.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">35</span>&nbsp; <span class="chapter-title">Диаграммы и схемы</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../new_pages/combination_analysis.ru.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">36</span>&nbsp; <span class="chapter-title">Анализ комбинаций</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../new_pages/transmission_chains.ru.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">37</span>&nbsp; <span class="chapter-title">Цепочки передачи</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../new_pages/phylogenetic_trees.ru.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">38</span>&nbsp; <span class="chapter-title">Филогенетические деревья</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../new_pages/interactive_plots.ru.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">39</span>&nbsp; <span class="chapter-title">Интерактивные графики</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" aria-expanded="true">
 <span class="menu-text">Отчеты и информационные панели</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" aria-expanded="true" aria-label="Переключить раздел">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-6" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../new_pages/rmarkdown.ru.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">40</span>&nbsp; <span class="chapter-title">Отчеты с помощью R Markdown</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../new_pages/reportfactory.ru.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">41</span>&nbsp; <span class="chapter-title">Структурирование рутинных отчетов</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../new_pages/flexdashboard.ru.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">42</span>&nbsp; <span class="chapter-title">Информационные панели с R Markdown</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../new_pages/shiny_basics.ru.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">43</span>&nbsp; <span class="chapter-title">Информационные панели с Shiny</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-7" aria-expanded="true">
 <span class="menu-text">Разное</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-7" aria-expanded="true" aria-label="Переключить раздел">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-7" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../new_pages/writing_functions.ru.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">44</span>&nbsp; <span class="chapter-title">Написание функций</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../new_pages/directories.ru.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">45</span>&nbsp; <span class="chapter-title">Взаимодействие директорий</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../new_pages/collaboration.ru.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">46</span>&nbsp; <span class="chapter-title">Контроль версий и совместная работа с помощью Git и Github</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../new_pages/errors.ru.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">47</span>&nbsp; <span class="chapter-title">Частые ошибки</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../new_pages/help.ru.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">48</span>&nbsp; <span class="chapter-title">Получение помощи</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../new_pages/network_drives.ru.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">49</span>&nbsp; <span class="chapter-title">R на сетевых дисках</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../new_pages/data_table.ru.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">50</span>&nbsp; <span class="chapter-title">Таблица данных</span></span></a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Содержание</h2>
   
  <ul>
  <li><a href="#подготовка" id="toc-подготовка" class="nav-link active" data-scroll-target="#подготовка"><span class="header-section-number">40.1</span> Подготовка</a></li>
  <li><a href="#начало-работы" id="toc-начало-работы" class="nav-link" data-scroll-target="#начало-работы"><span class="header-section-number">40.2</span> Начало работы</a>
  <ul class="collapse">
  <li><a href="#установка-пакета-rmarkdown-r" id="toc-установка-пакета-rmarkdown-r" class="nav-link" data-scroll-target="#установка-пакета-rmarkdown-r">Установка пакета rmarkdown R</a></li>
  <li><a href="#создание-нового-файла-rmd" id="toc-создание-нового-файла-rmd" class="nav-link" data-scroll-target="#создание-нового-файла-rmd">Создание нового файла Rmd</a></li>
  <li><a href="#важно-знать" id="toc-важно-знать" class="nav-link" data-scroll-target="#важно-знать">Важно знать</a></li>
  </ul></li>
  <li><a href="#компоненты-r-markdown" id="toc-компоненты-r-markdown" class="nav-link" data-scroll-target="#компоненты-r-markdown"><span class="header-section-number">40.3</span> Компоненты R Markdown</a>
  <ul class="collapse">
  <li><a href="#метаданные-yaml" id="toc-метаданные-yaml" class="nav-link" data-scroll-target="#метаданные-yaml">Метаданные YAML</a></li>
  <li><a href="#текст" id="toc-текст" class="nav-link" data-scroll-target="#текст">Текст</a></li>
  <li><a href="#фрагменты-кода" id="toc-фрагменты-кода" class="nav-link" data-scroll-target="#фрагменты-кода">Фрагменты кода</a></li>
  <li><a href="#рисунки" id="toc-рисунки" class="nav-link" data-scroll-target="#рисунки">Рисунки</a></li>
  <li><a href="#таблицы" id="toc-таблицы" class="nav-link" data-scroll-target="#таблицы">Таблицы</a></li>
  <li><a href="#разделы-по-вкладкам" id="toc-разделы-по-вкладкам" class="nav-link" data-scroll-target="#разделы-по-вкладкам">разделы по вкладкам</a></li>
  </ul></li>
  <li><a href="#структура-файла" id="toc-структура-файла" class="nav-link" data-scroll-target="#структура-файла"><span class="header-section-number">40.4</span> Структура файла</a>
  <ul class="collapse">
  <li><a href="#автономный-rmd" id="toc-автономный-rmd" class="nav-link" data-scroll-target="#автономный-rmd">Автономный Rmd</a></li>
  <li><a href="#файл-выполнения" id="toc-файл-выполнения" class="nav-link" data-scroll-target="#файл-выполнения">Файл выполнения</a></li>
  <li><a href="#структура-папок" id="toc-структура-папок" class="nav-link" data-scroll-target="#структура-папок">Структура папок</a></li>
  </ul></li>
  <li><a href="#создание-документа" id="toc-создание-документа" class="nav-link" data-scroll-target="#создание-документа"><span class="header-section-number">40.5</span> Создание документа</a>
  <ul class="collapse">
  <li><a href="#вариант-1-кнопка-knit" id="toc-вариант-1-кнопка-knit" class="nav-link" data-scroll-target="#вариант-1-кнопка-knit">Вариант 1: кнопка “Knit”</a></li>
  <li><a href="#вариант-2-команда-render" id="toc-вариант-2-команда-render" class="nav-link" data-scroll-target="#вариант-2-команда-render">Вариант 2: команда <code>render()</code></a></li>
  <li><a href="#вариант-3-пакет-reportfactory" id="toc-вариант-3-пакет-reportfactory" class="nav-link" data-scroll-target="#вариант-3-пакет-reportfactory">Вариант 3: пакет <strong>reportfactory</strong></a></li>
  </ul></li>
  <li><a href="#параметризированные-отчеты" id="toc-параметризированные-отчеты" class="nav-link" data-scroll-target="#параметризированные-отчеты"><span class="header-section-number">40.6</span> Параметризированные отчеты</a>
  <ul class="collapse">
  <li><a href="#установка-параметров" id="toc-установка-параметров" class="nav-link" data-scroll-target="#установка-параметров">Установка параметров</a></li>
  <li><a href="#параметризованный-пример" id="toc-параметризованный-пример" class="nav-link" data-scroll-target="#параметризованный-пример">Параметризованный пример</a></li>
  <li><a href="#параметризация-без-params" id="toc-параметризация-без-params" class="nav-link" data-scroll-target="#параметризация-без-params">Параметризация без <code>params</code></a></li>
  </ul></li>
  <li><a href="#зацикливаение-отчетов" id="toc-зацикливаение-отчетов" class="nav-link" data-scroll-target="#зацикливаение-отчетов"><span class="header-section-number">40.7</span> Зацикливаение отчетов</a></li>
  <li><a href="#шаблоны" id="toc-шаблоны" class="nav-link" data-scroll-target="#шаблоны"><span class="header-section-number">40.8</span> Шаблоны</a>
  <ul class="collapse">
  <li><a href="#документы-word" id="toc-документы-word" class="nav-link" data-scroll-target="#документы-word">Документы Word</a></li>
  <li><a href="#документы-powerpoint" id="toc-документы-powerpoint" class="nav-link" data-scroll-target="#документы-powerpoint">Документы Powerpoint</a></li>
  <li><a href="#интеграция-шаблонов-в-yaml" id="toc-интеграция-шаблонов-в-yaml" class="nav-link" data-scroll-target="#интеграция-шаблонов-в-yaml">Интеграция шаблонов в YAML</a></li>
  <li><a href="#форматирование-файлов-html" id="toc-форматирование-файлов-html" class="nav-link" data-scroll-target="#форматирование-файлов-html">Форматирование файлов HTML</a></li>
  </ul></li>
  <li><a href="#динамическое-содержимое" id="toc-динамическое-содержимое" class="nav-link" data-scroll-target="#динамическое-содержимое"><span class="header-section-number">40.9</span> Динамическое содержимое</a>
  <ul class="collapse">
  <li><a href="#таблицы-1" id="toc-таблицы-1" class="nav-link" data-scroll-target="#таблицы-1">Таблицы</a></li>
  <li><a href="#html-виджеты" id="toc-html-виджеты" class="nav-link" data-scroll-target="#html-виджеты">HTML виджеты</a></li>
  </ul></li>
  <li><a href="#ресурсы" id="toc-ресурсы" class="nav-link" data-scroll-target="#ресурсы"><span class="header-section-number">40.10</span> Ресурсы</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../new_pages/rmarkdown.ru.html">Отчеты и информационные панели</a></li><li class="breadcrumb-item"><a href="../new_pages/rmarkdown.ru.html"><span class="chapter-number">40</span>&nbsp; <span class="chapter-title">Отчеты с помощью R Markdown</span></a></li></ol></nav>
<div class="quarto-title">
<h1 class="title"><span class="chapter-number">40</span>&nbsp; <span class="chapter-title">Отчеты с помощью R Markdown</span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="../images/markdown/rmarkdown_overview.png" class="lightbox" data-gallery="quarto-lightbox-gallery-1"><img src="../images/markdown/rmarkdown_overview.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:100.0%"></a></p>
</figure>
</div>
</div>
</div>
<p>R Markdown - широко используемый инструмент для создания автоматизированных, воспроизводимых выходных данных, которыми можно делиться, таких как отчеты. Он генерирует статические или интерактивные выходные данные в Word, pdf, html, powerpoint и других форматах.</p>
<p>Скрипт R Markdown сочетает код R и текст таким образом, что скрипт <em>становится вашим выходным документом</em>. Вы можете создать полный отформатированный документ, включая описательную часть (может быть динамичной и меняться на основе ваших данных), таблицы, рисунки, маркированные списки, список использованной литературы и т.п.</p>
<p>Такие документы могут создаваться для регулярного предоставления обновленной информации (например, ежедневные отчеты по эпиднадзору) и/или могут выполняться для подмножества данных (например, отчеты для каждой юрисдикции).</p>
<p>Другие страницы настоящего руководства более подробно рассматривают эту тему:</p>
<ul>
<li>Страница <a href="../new_pages/reportfactory.ru.html">Структурирование рутинных отчетов</a> демонстрирует, как превратить создание автогенерируемых папок с временным штампом в рутину.<br>
</li>
<li>Страница <a href="../new_pages/flexdashboard.ru.html">Информационные панели с R Markdown</a> объясняет, как форматировать отчет R Markdown в виде информационной панели.</li>
</ul>
<p>Следует отметить, что проект <a href="https://r4epis.netlify.app/">R4Epis</a> создал шаблон скриптов R Markdown для наиболее часто встречающихся вспышек и сценариев исследований, с которыми сталкивались в местах проведения проекта MSF (врачи без границ).</p>
<!-- ======================================================= -->
<section id="подготовка" class="level2" data-number="40.1">
<h2 data-number="40.1" class="anchored" data-anchor-id="подготовка"><span class="header-section-number">40.1</span> Подготовка</h2>
<p><strong>Общая информация по R Markdown</strong></p>
<p>Объясним некоторые необходимые концепции и пакеты:</p>
<ul>
<li><strong>Markdown</strong> - это “язык”, который позволяет вам писать документ, используя простой текст, который можно конвертировать в html и другие форматы. Он не специфичен для R. Файлы, записанные с помощью разметки Markdown имеют расширение ‘.md’.</li>
<li><strong>R Markdown</strong>: это вариант markdown, который <em>специфичен для R</em> - он позволяет вам писать документ, используя разметку, чтобы создать текст <em>и интегрировать код R и отображать его выходные данные</em>. Файлы R Markdown имеют расширение ‘.Rmd’.<br>
</li>
<li><strong>rmarkdown - пакет</strong>: Он используется R, чтобы превратить файл .Rmd в желаемые выходные данные. Его фокус заключается в конвертации синтаксиса разметки (текста), поэтому нам нужны еще…</li>
<li><strong>knitr</strong>: Этот пакет R прочитает фрагменты кода, выполнит их и “свяжет” их с документом. Так можно включить таблицы и графики рядом с текстом.</li>
<li><strong>Pandoc</strong>: Наконец, pandoc собственно конвертирует выходные данные в word/pdf/powerpoint и т.п. Это также отдельная от R программа, но она устанавливается автоматически вместе с RStudio.</li>
</ul>
<p>В целом, процесс, который осуществляется <em>фоново</em> (вам не нужно знать все эти шаги!) включает в себя передачу файла .Rmd в <strong>knitr</strong>, который выполняет фрагменты кода и создает новый файл .md (markdown), который включает в себя код R и выводимые данные. Файл .md затем обрабатывается в pandoc, чтобы создать итоговый продукт: документ Microsoft Word, файл HTML, документ powerpoint, pdf, и т.п.</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="../images/markdown/0_rmd.png" class="lightbox" data-gallery="quarto-lightbox-gallery-2"><img src="../images/markdown/0_rmd.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:100.0%"></a></p>
</figure>
</div>
</div>
</div>
<p>(источник: https://rmarkdown.rstudio.com/authoring_quick_tour.html):</p>
<p><strong>Установка</strong></p>
<p>Чтобы создать выходной продукт в R Markdown, вам нужно установить следующее:</p>
<ul>
<li>Пакет <strong>rmarkdown</strong> (<strong>knitr</strong> также установится автоматически)<br>
</li>
<li>Pandoc, который должен был установиться вместе с RStudio. Если вы не используете RStudio, вы можете скачать Pandoc тут: http://pandoc.org.</li>
<li>Если вы хотите сгенерировать выходной продукт в формате PDF (это чуть сложнее), вам нужно будет установить LaTeX. Для пользователей R Markdown, которые не устанавливали LaTeX ранее, мы рекомендуем установить TinyTeX (https://yihui.name/tinytex/). Вы можете использовать следующие команды:</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>pacman<span class="sc">::</span><span class="fu">p_load</span>(tinytex)     <span class="co"># устанавливаем пакет tinytex</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>tinytex<span class="sc">::</span><span class="fu">install_tinytex</span>()  <span class="co"># команда R для установки программы TinyTeX</span></span></code><button title="Скопировать текст" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<!-- ======================================================= -->
</section>
<section id="начало-работы" class="level2" data-number="40.2">
<h2 data-number="40.2" class="anchored" data-anchor-id="начало-работы"><span class="header-section-number">40.2</span> Начало работы</h2>
<section id="установка-пакета-rmarkdown-r" class="level3 unnumbered">
<h3 class="unnumbered anchored" data-anchor-id="установка-пакета-rmarkdown-r">Установка пакета rmarkdown R</h3>
<p>Установите пакет R <strong>rmarkdown</strong>. В этом руководстве мы подчеркиваем использование <code>p_load()</code> из <strong>pacman</strong>, которая устанавливает пакет, если необходимо, <em>и</em> загружает его для использования. Вы можете также загрузить установленные пакеты с помощью <code>library()</code> из <strong>базового</strong> R. См. страницу <a href="../new_pages/basics.ru.html">Основы R</a> для получения дополнительной информации о пакетах R.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>pacman<span class="sc">::</span><span class="fu">p_load</span>(rmarkdown)</span></code><button title="Скопировать текст" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="создание-нового-файла-rmd" class="level3 unnumbered">
<h3 class="unnumbered anchored" data-anchor-id="создание-нового-файла-rmd">Создание нового файла Rmd</h3>
<p>В RStudio откройте новый файл R markdown, начав с ‘File’ (файл), затем ‘New file’ (новый файл), затем ‘R markdown…’.</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="../images/markdown/1_gettingstarted.png" class="lightbox" data-gallery="quarto-lightbox-gallery-3"><img src="../images/markdown/1_gettingstarted.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:50.0%"></a></p>
</figure>
</div>
</div>
</div>
<p>R Studio даст вам некоторые опции выходных данных на выбор. В примере ниже мы выбираем “HTML”, поскольку мы хотим создать документ html. Заголовок и имена авторов не столь важны. Если в этих опциях нет того типа выходного документа, который вам нужен, не волнуйтесь - вы можете выбрать любой вариант и потом изменить его в скрипте.</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="../images/markdown/1_gettingstartedB.png" class="lightbox" data-gallery="quarto-lightbox-gallery-4"><img src="../images/markdown/1_gettingstartedB.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:50.0%"></a></p>
</figure>
</div>
</div>
</div>
<p>Это позволит открыть новый скрипт .Rmd.</p>
</section>
<section id="важно-знать" class="level3 unnumbered">
<h3 class="unnumbered anchored" data-anchor-id="важно-знать">Важно знать</h3>
<p><strong>Рабочая директория</strong></p>
<p>Рабочая директория файла markdown - то, где сохраняется сам файл Rmd. Например, если R проект находится внутри <code>~/Documents/projectX</code>, а сам файл Rmd - в подпапке <code>~/Documents/projectX/markdownfiles/markdown.Rmd</code>, код <code>read.csv(“data.csv”)</code> внутри файла markdown будет искать csv файл в папке <code>markdownfiles</code>, а не в корневой папке проекта, где обычно осуществляют поиск скрипты в рамках проектов.</p>
<p>Чтобы сослаться на файлы в ином расположении, вам нужно либо использовать полный путь к файлу, либо пакет <strong>here</strong>. Пакет <strong>here</strong> задает рабочую директорию в корневой папкет проекта R, что детально объясняется на страницах <a href="../new_pages/r_projects.ru.html">Проекты R</a> и <a href="../new_pages/importing.ru.html">Импорт и экспорт</a>. Например, чтобы импортировать файл под названием “data.csv” из папки <code>projectX</code>, код будет выглядеть так: <code>import(here(“data.csv”))</code>.</p>
<p>Обратите внимание, что в скриптах R Markdown не рекомендуется использовать <code>setwd()</code> – она будет применяться только к фрагменту кода, в котором она записана.</p>
<p><strong>Работа на сетевых дисках или на компьютере</strong></p>
<p>Поскольку R Markdown может столкнуться с проблемами pandoc при работе с общего сетевого диска, рекомендуется, чтобы ваша папка была на локальной машине, то есьт в проекте в папке “Мои документы”. Если вы используте Git (очень рекомендуется!), это будет вам знакомо. Для получения дополнительной информации см. страницы <a href="../new_pages/network_drives.ru.html">R на сетевых дисках</a> и <a href="../new_pages/errors.ru.html">Ошибки и справка</a>.</p>
<!-- ======================================================= -->
</section>
</section>
<section id="компоненты-r-markdown" class="level2" data-number="40.3">
<h2 data-number="40.3" class="anchored" data-anchor-id="компоненты-r-markdown"><span class="header-section-number">40.3</span> Компоненты R Markdown</h2>
<p>Документ R Markdown можно редактировать в RStudio как и стандартный скрипт R. Когда вы начинаете новый скрипт R Markdown, RStudio попробует помочь, показав шаблон, который объясняет разные разделы скрипта R Markdown.</p>
<p>Ниже вы видите то окно, которое появляется, когда вы начинаете новый скрипт Rmd, с помощью которого хотите создать выходной продукт в html (как мы определили в предыдущем разделе).</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="../images/markdown/2_defaultRMD.png" class="lightbox" data-gallery="quarto-lightbox-gallery-5"><img src="../images/markdown/2_defaultRMD.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:100.0%"></a></p>
</figure>
</div>
</div>
</div>
<p>Как вы можете видеть, существует три основных компонента файла Rmd: YAML, текст Markdown, и фрагменты кода R</p>
<p>Они <em>создадут и станут вашим выходным документом</em>. См. схему ниже:</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="../images/markdown/rmarkdown_translation.png" class="lightbox" data-gallery="quarto-lightbox-gallery-6"><img src="../images/markdown/rmarkdown_translation.png" class="quarto-figure quarto-figure-center figure-img" style="width:100.0%;height:150.0%"></a></p>
</figure>
</div>
</div>
</div>
<section id="метаданные-yaml" class="level3 unnumbered">
<h3 class="unnumbered anchored" data-anchor-id="метаданные-yaml">Метаданные YAML</h3>
<p>Их называют ‘метаданные YAML’ или просто ‘YAML’, находятся в верхней части документа R Markdown. Этот раздел скрипта укажет вашему файлу Rmd, какого типа выходной результат создать, предпочтения в форматировании, а также другие метаданные, например, название документа, автор и дата. Существуют и другие способы применения, не упомянутые здесь (но на них есть отсылка в ‘Подготовка выходных результатов’). Обратите внимание, что важны отступы; tab не допускается, а пробелы - можно.</p>
<p>Этот раздел должен начинаться со строчки, содержащей три дефиса <code>---</code> и должен закрываться строкой, содержащей три дефиса <code>---</code>. Параметры YAML указываются в парах <code>key:value</code>. Размещение двоеточий в YAML очень важно - пары <code>key:value</code> разделяются двоеточиями (не знаки равно!).</p>
<p>YAML должны начинаться с метаданных для документа. Порядок этих первичных параметров YAML (без отступов) не важен. Например:</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode yaml code-with-copy"><code class="sourceCode yaml"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="fu">title</span><span class="kw">:</span><span class="at"> </span><span class="st">"My document"</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="fu">author</span><span class="kw">:</span><span class="at"> </span><span class="st">"Me"</span></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a><span class="fu">date</span><span class="kw">:</span><span class="at"> </span><span class="st">"2024-05-10"</span></span></code><button title="Скопировать текст" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Вы можете использовать код R в значениях YAML, написав его как in-line code (в начале <code>r</code> внутри обратных одинарных кавычек), но также в кавычках (см. пример выше в строке <code>date:</code>).</p>
<p>На изображении выще, поскольку мы кликнули, что выходным результатом по умолчанию будет файл html, мы можем увидеть, что в YAML написано <code>output: html_document</code>. Однако мы также можем изменить этот пункт на <code>powerpoint_presentation</code>, <code>word_document</code> или даже <code>pdf_document</code>.</p>
</section>
<section id="текст" class="level3 unnumbered">
<h3 class="unnumbered anchored" data-anchor-id="текст">Текст</h3>
<p>Это текстовая часть вашего документа, включая заголовки и подзаголовки. Она записана языком разметки “markdown”, который используется в разных программах.</p>
<p>Ниже приведены основные способы написания текста. См. более подробную документацию в “шпаргалке” по R Markdown на <a href="https://rstudio.com/resources/cheatsheets/">веб-сайте RStudio</a>.</p>
<section id="новые-строки" class="level4 unnumbered">
<h4 class="unnumbered anchored" data-anchor-id="новые-строки">Новые строки</h4>
<p>Уникально для R Markdown, чтобы начать новую строку, введите *два пробела** в конце предыдущей строки, затем нажмите Enter/Return.</p>
</section>
<section id="регистр" class="level4 unnumbered">
<h4 class="unnumbered anchored" data-anchor-id="регистр">Регистр</h4>
<p>Поставьте вокруг текста следующие знаки, чтобы изменить его отображение.</p>
<ul>
<li>Нижние подчеркивания (<code>_text_</code>) или одна звездочка (<code>*text*</code>) для <em>курсива</em></li>
<li>Двойная звездочка (<code>**текст**</code>) для <strong>жирного текста</strong></li>
<li>Обратные одинарные кавычки (<code>text</code>) для отображения текста как кода</li>
</ul>
<p>Собственно вид шрифта можно установить, использовав конкретные шаблоны (задаются в метаданных YAML; см. примеры).</p>
</section>
<section id="цвет" class="level4 unnumbered">
<h4 class="unnumbered anchored" data-anchor-id="цвет">Цвет</h4>
<p>Не существует простого механизма изменения цвета текста в R Markdown. Как вариант, <em>ЕСЛИ вы на выходе получаете файл HTML</em>, то можно добавить строку HTML в текст markdown. HTML код ниже напечатает строку текста жирным красным шрифтом.</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode md code-with-copy"><code class="sourceCode markdown"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>&lt;span style="color: red;"&gt;**_ВНИМАНИЕ:_** Это предупреждение.&lt;/span&gt;  </span></code><button title="Скопировать текст" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p><span style="color: red;"><strong><em>ВНИМАНИЕ:</em></strong> Это предупреждение.</span></p>
</section>
<section id="заголовки-и-подзаголовки" class="level4 unnumbered">
<h4 class="unnumbered anchored" data-anchor-id="заголовки-и-подзаголовки">Заголовки и подзаголовки</h4>
<p>Символ решетки в текстовой части скрипта R Markdown создает заголовок. Это отличается от фрагментов кода R в скрипте, где решетка используется для комментария/аннотации/де-активации.</p>
<p>Разные уровни заголовка создаются с помощью разного количества символов решетки в начале новой строки. Один знак решетки - основной заголовок. Два знака решетки - заголовок второго уровня. Заголовки третьего и четвертого уровня можно создать с помощью увеличения количества знаков решетки.</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode md code-with-copy"><code class="sourceCode markdown"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="fu"># Заголовок первого уровня</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a><span class="fu">## Заголовок второго уровня  </span></span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a><span class="fu">### Заголовок третьего уровня</span></span></code><button title="Скопировать текст" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
<section id="маркированные-списки" class="level4 unnumbered">
<h4 class="unnumbered anchored" data-anchor-id="маркированные-списки">Маркированные списки</h4>
<p>Используйте звездочки (<code>*</code>), чтобы создать маркированные списки. Завершите предыдущее предложение, введите два пробела, <em>дважды</em> нажмите Enter/Return, затем начинайте маркированный список. Включите пробел между звездочкой и текстом этого пункта списка. После каждого пункта списка введите два пробела, затем нажмите Enter/Return. Подпункты маркированного списка работают так же, но с отступом. Числа работают также, но вместо звездочки, пишите 1), 2), и т.п. Ниже пример того, как может выглядеть текст скрипта R Markdown.</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode md code-with-copy"><code class="sourceCode markdown"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>Вот мой маркированный список (после этого двоеточия два пробела):  </span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a><span class="ss">* </span>Пункт 1 (после него два пробела и Enter/Return)  </span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a><span class="ss">* </span>Пункт 2 (после него два пробела и Enter/Return)  </span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a><span class="ss">  * </span>Подпункт 1 (после него два пробела и Enter/Return)  </span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a><span class="ss">  * </span>Подпункт 2 (после него два пробела и Enter/Return)  </span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a>  </span></code><button title="Скопировать текст" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
<section id="выделение-текста-в-комментарий" class="level4 unnumbered">
<h4 class="unnumbered anchored" data-anchor-id="выделение-текста-в-комментарий">Выделение текста в комментарий</h4>
<p>Вы можете выделить текст R Markdown в комментарий также как вы используете “#”, чтобы выделить строку кода R во фрагменте кода R в комментарий. Просто выделите текст и нажмите Ctrl+Shift+c (Cmd+Shift+c для Mac). Текст будет окружен стрелками и станет зеленым. Его не будет видно в выходном результате.</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="../images/markdown/rmarkdown_hide_text.png" class="lightbox" data-gallery="quarto-lightbox-gallery-7"><img src="../images/markdown/rmarkdown_hide_text.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:100.0%"></a></p>
</figure>
</div>
</div>
</div>
</section>
</section>
<section id="фрагменты-кода" class="level3 unnumbered">
<h3 class="unnumbered anchored" data-anchor-id="фрагменты-кода">Фрагменты кода</h3>
<p>Разделы скрипта, которые посвящены выполнению кода R, называют “фрагментами кода”. Здесь вы загружаете пакеты, импортируете данные и проводите уперавление данными и визуализацию. У вас может быть много фрагментов кода, они помогают вам организовать свой код R по частям, между которыми может быть текст. Необходимо отметить: Эти ‘фрагменты’ будут иметь чуть другой цвет фона по сравнению с текстовой частью документа.</p>
<p>Каждый фрагмент начинается со строки с тремя обратными одинарными кавычками и фигурными скобками, которые содержат параметры для фрагмента (<code>{ }</code>). Фрагмент оканчивается еще тремя обратными одинарными кавычками.</p>
<p>Вы можете создать новый фрагмент, напечатав его самостоятельно, используя горячие клавиши “Ctrl + Alt + i” (или Cmd + Shift + r в Mac), либо кликную зеленую иконку ‘insert a new code chunk’ (вставить новый фрагмент кода) в верхней части редактора скрипта.</p>
<p>Некоторые комментарии по содержимому фигурных скобок <code>{ }</code>:</p>
<ul>
<li>Они начинаются с ‘r’, чтобы указать, что название используемого во фрагменте языка - R</li>
<li>После r опционально вы можете написать “имя” фрагмента – оно не является обязательным, но может помочь организовать вашу работу. Обратите внимание, что если вы задаете имена фрагментам, вы должны ВСЕГДА использовать уникальные имена, иначе при обработке R будет выдавать предупреждения.<br>
</li>
<li>Фигурные скобки могут включать другие опции, записанные как <code>tag=value</code>, например:<br>
</li>
<li><code>eval = FALSE</code> не выполнять код R<br>
</li>
<li><code>echo = FALSE</code> не печатать исходный код фрагмента R в выходном документе<br>
</li>
<li><code>warning = FALSE</code> не печатать предупреждения, выдаваемые кодом R<br>
</li>
<li><code>message = FALSE</code> не печатать сообщения, созданные кодом R<br>
</li>
<li><code>include =</code> TRUE/FALSE (ПРАВДА или ЛОЖЬ), включать ли выходные данные фрагмента (например, графики) в документе</li>
<li><code>out.width =</code> и <code>out.height =</code> - задает стиль <code>out.width = "75%"</code><br>
</li>
<li><code>fig.align = "center"</code> корректирует, как рисунок выровнен на странице<br>
</li>
<li><code>fig.show='hold'</code>, если ваш фрагмент печатает несколько рисунков и вы их хотите напечатать рядом друг с другом (вместе с <code>out.width = c("33%", "67%")</code>. Можно также задать как <code>fig.show='asis',</code> чтобы показать их под тем кодом, который их генерирует, <code>'hide'</code> чтобы спрятать, либо <code>'animate'</code> для объединения нескольких в анимацию.<br>
</li>
<li>заголовок фрагмента должен быть записан <em>в одну строку</em><br>
</li>
<li>Старайтесь избегать точек, нижних подчеркиваний и пробелов. Используйте вместо этого дефисы ( - ), если вам нужен разделитель.</li>
</ul>
<p>Более детально об опциях <strong>knitr</strong> можно прочитать <a href="https://yihui.org/knitr/options/">тут</a>.</p>
<p>Некоторые вышеуказанные опции можно задать по принципу “наведи и кликни”, используя кнопки настройки в верхней правой части фрагмента. Здесь вы можете уточнить, какие части фрагмента вы хотите включить в готовый документ, в частности, код, выходные данные и предупреждения. Это будет выглядеть как записанные предпочтения внутри фигурных скобок, например, <code>echo=FALSE</code>, если вы хотите уточнить, что надо ‘показыватьт только выходной результат’.</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="../images/markdown/3_chunk.png" class="lightbox" data-gallery="quarto-lightbox-gallery-8"><img src="../images/markdown/3_chunk.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:80.0%"></a></p>
</figure>
</div>
</div>
</div>
<p>Также в верхней части каждого фрагмента есть две стрелки, которые полезны, чтобы выполнить код внутри фрагмента, либо весь код в предыдущих фрагментах. Наведите на них, чтобы увидеть, что они делают.</p>
<p>Чтобы применить глобальные опции ко всем фрагментам скрипта, вы можете это задать в самом первом фрагменте кода R. Например, чтобы только выходные данные были показаны для каждого фрагмента кода, а не сам код, вы можете включить следующую команду во фрагмент кода R:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span>opts_chunk<span class="sc">$</span><span class="fu">set</span>(<span class="at">echo =</span> <span class="cn">FALSE</span>) </span></code><button title="Скопировать текст" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="код-r-внутри-текста" class="level4 unnumbered">
<h4 class="unnumbered anchored" data-anchor-id="код-r-внутри-текста">Код R внутри текста</h4>
<p>Вы также можете включить минимальный код R внутри обратных одинарных кавычек. Внутри одинарных обратных кавычек начните код с “r” и пробела, чтобы RStudio знал, что нужно оценивать код как код R. См. пример ниже.</p>
<p>Пример ниже показывает несколько уровней заголовков, маркированный список и использует код R для текущей даты (<code>Sys.Date()</code>), чтобы превратить ее в печатную дату.</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="../images/markdown/2_text.png" class="lightbox" data-gallery="quarto-lightbox-gallery-9"><img src="../images/markdown/2_text.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:80.0%"></a></p>
</figure>
</div>
</div>
</div>
<p>Приведенный пример является простым (отображение текущей даты), но с помощью того же синтаксиса можно отобразить значения, созданные более сложным кодом R (например, вычислить минимум, медиану, максимум для столбца). Также можно интегрировать в сценарий R-объекты или значения, созданные ранее в фрагментах R-кода.</p>
<p>В качестве примера скрипт ниже показывает долю случаев в возрасте младше 18 лет, используя функции <strong>tidyverse</strong>, и создает объекты <code>less18</code>, <code>total</code>, и <code>less18prop</code>. Это динамическое значение вставляется в последующий текст. Посмотрим, как это выглядит при связывании в документ word.</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="../images/markdown/3_chunktext.png" class="lightbox" data-gallery="quarto-lightbox-gallery-10"><img src="../images/markdown/3_chunktext.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:100.0%"></a></p>
</figure>
</div>
</div>
</div>
</section>
</section>
<section id="рисунки" class="level3 unnumbered">
<h3 class="unnumbered anchored" data-anchor-id="рисунки">Рисунки</h3>
<p>Вы можете включить рисунки в R Markdown одним из двух способов:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="sc">!</span>[](<span class="st">"path/to/image.png"</span>)  </span></code><button title="Скопировать текст" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Если указанный выше способ не работает, попробуйте использовать <code>knitr::include_graphics()</code></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">include_graphics</span>(<span class="st">"path/to/image.png"</span>)</span></code><button title="Скопировать текст" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>(помните, путь к файлу можно записать, используя пакет <strong>here</strong>)</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">include_graphics</span>(here<span class="sc">::</span><span class="fu">here</span>(<span class="st">"path"</span>, <span class="st">"to"</span>, <span class="st">"image.png"</span>))</span></code><button title="Скопировать текст" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="таблицы" class="level3 unnumbered">
<h3 class="unnumbered anchored" data-anchor-id="таблицы">Таблицы</h3>
<p>Создавайте таблицы, используя дефисы ( - ) и вертикальные черточки ( | ). Количество дефисов до/между столбцами создает количество пробелов в ячейке до того, как начнется оборачивание текста.</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode md code-with-copy"><code class="sourceCode markdown"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>Столбец 1 |Столбец  2 |Столбец 3</span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>----------|-----------|--------</span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>Ячейка A  |Ячейка B   |Ячейка C</span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a>Ячейка D  |Ячейка E   |Ячейка F</span></code><button title="Скопировать текст" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Указанный выше код создаст ту таблицу, которую вы видите ниже:</p>
<table class="table">
<thead>
<tr class="header">
<th>Столбец 1</th>
<th>Столбец 2</th>
<th>Столбец 3</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Ячейка A</td>
<td>Ячейка B</td>
<td>Ячейка C</td>
</tr>
<tr class="even">
<td>Ячейка D</td>
<td>Ячейка E</td>
<td>Ячейка F</td>
</tr>
</tbody>
</table>
</section>
<section id="разделы-по-вкладкам" class="level3 unnumbered">
<h3 class="unnumbered anchored" data-anchor-id="разделы-по-вкладкам">разделы по вкладкам</h3>
<p>Для результатов в виде HTML, вы можете организовать разделы по “вкладкам”. Просто добавьте <code>.tabset</code> в фигурные скобки <code>{ }</code>, которые размещаются <em>после заголовка</em>. Любые подзаголовки под этим заголовком (до появления другого заголовка того же уровня) будут отображаться как вкладки, между которыми пользователей может переключаться. Дополнительную информацию читайте <a href="https://bookdown.org/yihui/rmarkdown-cookbook/html-tabs.html">тут</a></p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="../images/markdown/tabbed_script.png" class="lightbox" data-gallery="quarto-lightbox-gallery-11"><img src="../images/markdown/tabbed_script.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:100.0%"></a></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="../images/markdown/tabbed_view.gif" class="lightbox" data-gallery="quarto-lightbox-gallery-12"><img src="../images/markdown/tabbed_view.gif" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:100.0%"></a></p>
</figure>
</div>
</div>
</div>
<p>Вы можете добавить дополнительную опцию <code>.tabset-pills</code> после <code>.tabset</code>, чтобы у вкладок был “комбинированный” вид. Помните, что при рассмотрении выходных результатов в HTML с вкладками, функция поиска Ctrl+f будет искать только по “активной” вкладке, а не по скрытым вкладкам.</p>
<!-- ======================================================= -->
</section>
</section>
<section id="структура-файла" class="level2" data-number="40.4">
<h2 data-number="40.4" class="anchored" data-anchor-id="структура-файла"><span class="header-section-number">40.4</span> Структура файла</h2>
<p>Существует несколько способов структурировать ваш R Markdown и связанные с ним скрипты R. У каждого есть свои преимущества и недостатки:</p>
<ul>
<li>Автономный R Markdown - все, что нужно для отчета, импортируется или создается внутри R Markdown
<ul>
<li>Получение данных из других файлов - Вы можете выполнить внешние скрипты R с помощью команды <code>source()</code> и использовать их выходные результаты в Rmd<br>
</li>
<li>Дочерние скрипты - альтернативный механизм для <code>source()</code><br>
</li>
</ul></li>
<li>Использовать “файл выполнения” - Выполнять команды в скрипте R <em>до</em> построения R</li>
</ul>
<section id="автономный-rmd" class="level3 unnumbered">
<h3 class="unnumbered anchored" data-anchor-id="автономный-rmd">Автономный Rmd</h3>
<p>Для относительно простого отчета вы можете организовать свой скрипт R Markdown таким образом, чтобы он был “автономным” и не требовал других внешних скриптов.</p>
<p>Все, что необходимо для выполнения R Markdown, импортируется или создается в Rmd-файле, включая все фрагменты кода и загрузку пакетов. Такой “автономный” подход уместен, когда не требуется большой обработки данных (например, приводится чистый или полу-чистый файл данных) и формирование R Markdown не займет много времени.</p>
<p>В этом сценарии логичной организацией скрипта R Markdown может быть следующей:</p>
<ol type="1">
<li>Задаются глобальные опции <strong>knitr</strong><br>
</li>
<li>Загрузка пакет<br>
</li>
<li>Импорт данных<br>
</li>
<li>Обработка данных<br>
</li>
<li>Подготовка выходных данных (таблицы, графики и т.п.)<br>
</li>
<li>Сохранение выходных данных, если нужно(.csv, .png, и т.п.)</li>
</ol>
<section id="получение-данных-из-других-файлов" class="level4 unnumbered">
<h4 class="unnumbered anchored" data-anchor-id="получение-данных-из-других-файлов">Получение данных из других файлов</h4>
<p>Одним из вариантов “автономного” подхода является использование фрагментов кода R Markdown в качестве “источника” (выполнения) других скриптов R. Это может сделать ваш сценарий R Markdown менее загроможденным, более простым и удобным для организации. Это также может помочь, если необходимо вывести итоговые цифры в начале отчета. При таком подходе конечный скрипт R Markdown просто объединяет предварительно обработанные результаты в документ.</p>
<p>Один из способов это сделать - задать скрипты R (путь к файлу и имя с разрешением) в команду <strong>базового</strong> R <code>source()</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="fu">source</span>(<span class="st">"your-script.R"</span>, <span class="at">local =</span> knitr<span class="sc">::</span><span class="fu">knit_global</span>())</span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a><span class="co"># или sys.source("your-script.R", envir = knitr::knit_global())</span></span></code><button title="Скопировать текст" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Обратите внимание, что при использовании <code>source()</code> <em>внутри</em> R Markdown, внешние файлы будут все еще выполняться <em>в ходе формирования файла Rmd</em>. Следовательно, каждый скрипт выполняется каждый раз, когда вы формируете отчет. Таким образом, наличие команд <code>source()</code> <em>внутри</em> R Markdown не ускоряет время выполнения, и не особо помогает с дебаггингом, так как созданные ошибки все еще будут напечатаны при подготовке R Markdown.</p>
<p>Альтернативой является использование опции <code>child =</code> <strong>knitr</strong>. НЕОХОДИМО ОБЪЯСНИТЬ ПОДРОБНЕЕ</p>
<p>Вы должны знать о разных <em>средах</em> R. Объекты, созданные внутри среды, не обязательно будут доступны для среды R Markdown.</p>
</section>
</section>
<section id="файл-выполнения" class="level3 unnumbered">
<h3 class="unnumbered anchored" data-anchor-id="файл-выполнения">Файл выполнения</h3>
<p>Этот подход требует использования скрипта R, который содержит команду(ы) <code>render()</code> для предварительной обработки объектов, которые передаются в R markdown.</p>
<p>Например, вы можете загрузить пакеты, загрузить и вычистить данные и даже создать интересующие графики до функции <code>render()</code>. Эти шаги могут выполняться как в скрипте R, так и в других скриптах. Если эти команды выполняются в одной и той же сессии RStudio, а объекты сохраняются в среде, то их можно вызывать в содержимом Rmd. Тогда сам R markdown будет использоваться только на последнем этапе - для создания выходных данных со всеми предварительно обработанными объектами. Так гораздо проще отладить работу, если что-то пойдет не так.</p>
<p>Этот подход полезен по следующим причинам:</p>
<ul>
<li>Более информативные сообщения об ошибках - эти сообщения будут сгенерированы в скрипте R, а не в R Markdown. Ошибки R Markdown, как правило, сообщают, в каком фрагменте кода есть проблема, но не говорят - в какой строке.<br>
</li>
<li>Если применимо, вы можете выполнить длинные шаги обработки до использования команды <code>render()</code> - они будут выполнены только один раз.</li>
</ul>
<p>В примере ниже мы отделили скрипт R, в котором мы предварительно обрабатываем объект <code>data</code> в среде R (Environment) и затем сформируем “create_output.Rmd”, используя <code>render()</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> <span class="fu">import</span>(<span class="st">"datafile.csv"</span>) <span class="sc">%&gt;%</span>       <span class="co"># Загружаем данные и сохраняем в рабочую среду</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(age, hospital, weight)          <span class="co"># выбираем ограниченное количество столбцов</span></span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>rmarkdown<span class="sc">::</span><span class="fu">render</span>(<span class="at">input =</span> <span class="st">"create_output.Rmd"</span>)   <span class="co"># Создаем файл Rmd</span></span></code><button title="Скопировать текст" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="структура-папок" class="level3 unnumbered">
<h3 class="unnumbered anchored" data-anchor-id="структура-папок">Структура папок</h3>
<p>Рабочий поток также учитывает общую структуру папок, например, нужна папка ‘output’ для созданных документов и рисунков, папки ‘data’ или ‘inputs’ для вычищенных данных. Здесь мы не будем углубляться в детали, но проверьте страницу <a href="../new_pages/reportfactory.ru.html">Структурирование рутинных отчетов</a>.</p>
</section>
</section>
<section id="создание-документа" class="level2" data-number="40.5">
<h2 data-number="40.5" class="anchored" data-anchor-id="создание-документа"><span class="header-section-number">40.5</span> Создание документа</h2>
<p>Вы можете создать документ следующим образом:</p>
<ul>
<li>Вручную, нажав кнопку “Knit” наверху редактора скриптов RStudio (быстро и легко)<br>
</li>
<li>Выполнить команду <code>render()</code> (выполняется за пределами скрипта R Markdown)</li>
</ul>
<section id="вариант-1-кнопка-knit" class="level3 unnumbered">
<h3 class="unnumbered anchored" data-anchor-id="вариант-1-кнопка-knit">Вариант 1: кнопка “Knit”</h3>
<p>Когда у вас открыт файл Rmd, нажмите иконку/кнопку ‘Knit’ наверху файла.</p>
<p>R Studio покажет прогресс во вкладке ‘R Markdown’ возле консоли R. Документ автоматически откроется после завершения выполнения.</p>
<p>Документ будет сохранен в той же папке, что и ваш скрипт R markdown, и с тем же именем файла (кроме расширения). Это, конечно, не идеально для контроля версий (он будет перезаписываться каждый раз при формировании, если вы не переместите его вручную), поскольку вам, возможно, потребуется переименовывать файл самостоятельно (например, добавлять дату).</p>
<p>Это “горячая кнопка” RStudio для функции <code>render()</code> из <strong>rmarkdown</strong>. Этот подход совместим только с автономным R markdown, где существуют все необходимые компоненты, либо они могут быть запрошены в рамках файла.</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="../images/markdown/4_progress.png" class="lightbox" data-gallery="quarto-lightbox-gallery-13"><img src="../images/markdown/4_progress.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:90.0%"></a></p>
</figure>
</div>
</div>
</div>
</section>
<section id="вариант-2-команда-render" class="level3 unnumbered">
<h3 class="unnumbered anchored" data-anchor-id="вариант-2-команда-render">Вариант 2: команда <code>render()</code></h3>
<p>Еще один способ создать выходные данные R Markdown - выполнить функцию <code>render()</code> (из пакета <strong>rmarkdown</strong>). Вы должны исполнить эту команду <em>за пределами</em> скрипта R Markdown - либо в отдельном R script (часто называется “файл выполнения”), либо как отдельную команду в консоли R.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>rmarkdown<span class="sc">::</span><span class="fu">render</span>(<span class="at">input =</span> <span class="st">"my_report.Rmd"</span>)</span></code><button title="Скопировать текст" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Как и с “knit”, настройки по умолчанию сохранят выходной результат в ту же папку, что скрипт Rmd, с тем же именем файла (кроме расширения файла). Например, “my_report.Rmd” при формировании создаст “my_report.docx”, если вы его формируете как документ word. Однако используя <code>render()</code> у вас есть опция использования разных настроек. <code>render()</code> может принимать аргументы, включая:</p>
<ul>
<li><code>output_format =</code> Это формат выходных данных для конвертации в (например, <code>"html_document"</code>, <code>"pdf_document"</code>, <code>"word_document"</code>, либо <code>"all"</code>). Вы можете также указать это в YAML внутри скрипта R Markdown.<br>
</li>
<li><code>output_file =</code> Это название выходного файла (и путь к файлу). Его можно создать через такие функции R, как <code>here()</code> или <code>str_glue()</code> как показано ниже.<br>
</li>
<li><code>output_dir =</code> Это выходная директория (папка) для сохранения файла. Это позволяет вам выбрать другую альтернативу, кроме директории, в которую сохраняется файл Rmd.<br>
</li>
<li><code>output_options =</code> Вы можете задать список опций, которые будут превалировать над теми, которые записаны в YAML скрипта (например, )</li>
<li><code>output_yaml =</code> Вы можете задать путь к файлу .yml, который содержит спецификации YAML<br>
</li>
<li><code>params =</code> См. раздел по параметрам ниже<br>
</li>
<li>См. полный список <a href="https://pkgs.rstudio.com/rmarkdown/reference/render.html">тут</a></li>
</ul>
<p>В качестве одного примера, чтобы улучшить контроль версий, следующая команда сохранит выходной файл в подпапке ‘outputs’ с текущей датой в имени файла. Чтобы создать имя файла, используется функция <code>str_glue()</code> из пакета <strong>stringr</strong>, которая ‘склеивает’ статические последовательности (написанные простым текстом) с динамическим кодом R (записанным в фигурных скобках). Например, если сегодня 10 апреля 2021, имя файла ниже будет “Report_2021-04-10.docx”. См. дополнительную информацию по <code>str_glue()</code> на странице <a href="../new_pages/characters_strings.ru.html">Текст и последовательности</a>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>rmarkdown<span class="sc">::</span><span class="fu">render</span>(</span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">input =</span> <span class="st">"create_output.Rmd"</span>,</span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">output_file =</span> stringr<span class="sc">::</span><span class="fu">str_glue</span>(<span class="st">"outputs/Report_{Sys.Date()}.docx"</span>)) </span></code><button title="Скопировать текст" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>По мере того как файл формируется, на консоли RStudio будет показан прогресс формирвоания до 100%, а в итоговом сообщении будет написано, что формирование завершено.</p>
</section>
<section id="вариант-3-пакет-reportfactory" class="level3 unnumbered">
<h3 class="unnumbered anchored" data-anchor-id="вариант-3-пакет-reportfactory">Вариант 3: пакет <strong>reportfactory</strong></h3>
<p>Пакет R <strong>reportfactory</strong> предлагает альтернативный метод организации и формирования отчетов R Markdown, <em>адаптированный для ситуаций, когда вам надо регулярно повторять формирование отчета (например, ежедневно, еженедельно…).</em> Он облегчает формирование нескольких файлов R Markdown и организацию их выходных данных. По сути, он создает “фабрику”, из которой вы можете выполнить отчеты R Markdown, получить папки для выходных данных с автоматическими метками даты и времени, а также “легко” контролировать версии.</p>
<p>Более подробно о данном потоке работ читайте на странице <a href="../new_pages/reportfactory.ru.html">Структурирование рутинных отчетов</a>.</p>
<!-- ======================================================= -->
</section>
</section>
<section id="параметризированные-отчеты" class="level2" data-number="40.6">
<h2 data-number="40.6" class="anchored" data-anchor-id="параметризированные-отчеты"><span class="header-section-number">40.6</span> Параметризированные отчеты</h2>
<p>Вы можете использовать параметризацию, чтобы сделать отчеты динамичными, чтобы их можно было выполнять с конкретными настройками (например, с конкретной датой или местом, либо с определенными вариантами формирования). Ниже мы фокусируемся на основных моментах, но имеется <a href="https://bookdown.org/yihui/rmarkdown/parameterized-reports.html">детальная информация онлайн</a> о параметризированных отчетах.</p>
<p>Используя построчный список по Эболе в качестве примера, представим, что нам нужно выдавать стандартный отчет по эпиднадзору для каждой больницы каждый день. Мы покажем, как это можно сделать с использованием параметров.</p>
<p><em>Важно: динамические отчеты также возможны без официальной структуры параметров (без <code>params:</code>), используя простые объекты R в соседнем скрипте R. Это объясняется в конце данного раздела.</em></p>
<section id="установка-параметров" class="level3 unnumbered">
<h3 class="unnumbered anchored" data-anchor-id="установка-параметров">Установка параметров</h3>
<p>У вас есть несколько вариантов уточнения значений параметров для выходных результатов R Markdown.</p>
<section id="вариант-1-задать-параметры-внутри-yaml" class="level4 unnumbered">
<h4 class="unnumbered anchored" data-anchor-id="вариант-1-задать-параметры-внутри-yaml">Вариант 1: Задать параметры внутри YAML</h4>
<p>Редактируйте YAML, чтобы включить опцию <code>params:</code>, с утверждениями с отступом для каждого параметра, который вы хотите определить. В этом примере мы создаем параметры <code>date</code> (дата) и <code>hospital</code> (больница), для которых мы задаем значения. Эти значения будут меняться каждый раз, когда выполняется отчет. Если вы используете кнопку “Knit” для создания выходного результата, у параметров будут значения по умолчанию. Аналогично, если вы используете <code>render()</code>, у параметров будут эти значения по умолчанию, если в команде <code>render()</code> не указано иное.</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode yaml code-with-copy"><code class="sourceCode yaml"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="pp">---</span></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a><span class="fu">title</span><span class="kw">:</span><span class="at"> Surveillance report</span></span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a><span class="fu">output</span><span class="kw">:</span><span class="at"> html_document</span></span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a><span class="fu">params</span><span class="kw">:</span></span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a><span class="at"> </span><span class="fu">date</span><span class="kw">:</span><span class="at"> 2021-04-10</span></span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a><span class="at"> </span><span class="fu">hospital</span><span class="kw">:</span><span class="at"> Central Hospital</span></span>
<span id="cb16-7"><a href="#cb16-7" aria-hidden="true" tabindex="-1"></a><span class="pp">---</span></span></code><button title="Скопировать текст" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Фоново значения этих параметров содержатся в списке только для чтения под названием <code>params</code>. Таким образом, вы можете вставить значения параметров в код R как вы это делаете с другим объектом/значением R в своей рабочей среде. Просто напечатайте <code>params$</code>, после чего укажите имя параметра. Например, <code>params$hospital</code> для представления названия больницы (“Central Hospital” по умолчанию).</p>
<p>Обратите внимание, что параметры могут также содержать значения <code>true</code> (истина) или <code>false</code> (ложь), поэтому они могут быть включены в ваши опции <strong>knitr</strong> для фрагмента R. Например, вы можете задать <code>{r, eval=params$run}</code> вместо <code>{r, eval=FALSE}</code>, и теперь то, будет ли выполняться фрагмент будет зависеть от значения параметра <code>run:</code>.</p>
<p>Обратите внимание, что параметры, которые являются датами, будут введены как последовательность. Например, чтобы <code>params$date</code> интерпретировался в коде R, его скорее всего нужно обернуть в <code>as.Date()</code> либо аналогичную функцию, чтобы конвертировать в класс Дата.</p>
</section>
<section id="вариант-2-задать-параметры-внутри-render" class="level4 unnumbered">
<h4 class="unnumbered anchored" data-anchor-id="вариант-2-задать-параметры-внутри-render">Вариант 2: задать параметры внутри <code>render()</code></h4>
<p>Как было указано выше, альтернативой использованию кнопки “Knit” для создания выходных результатов является выполнение функции <code>render()</code> из отдельного скрипта. В последнем случае вы можете уточнить параметры, которые должны использоваться при формировании, в аргументе <code>params =</code> в <code>render()</code>.</p>
<p>Обратите внимание, что любые значения параметров, заданные тут, будут <em>записаны поверх</em> значений по умолчанию, если они записаны внутри YAML. Мы пишем значения в кавычках, так как в таком случае их следует определять как текстовые значения/последовательности.</p>
<p>Команда ниже формирует “surveillance_report.Rmd”, уточняет имя и папку для динамического файла-результата, а также задает список <code>list()</code> двух параметров и их значений в аргумент <code>params =</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>rmarkdown<span class="sc">::</span><span class="fu">render</span>(</span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">input =</span> <span class="st">"surveillance_report.Rmd"</span>,  </span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">output_file =</span> stringr<span class="sc">::</span><span class="fu">str_glue</span>(<span class="st">"outputs/Report_{Sys.Date()}.docx"</span>),</span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">params =</span> <span class="fu">list</span>(<span class="at">date =</span> <span class="st">"2021-04-10"</span>, <span class="at">hospital  =</span> <span class="st">"Central Hospital"</span>))</span></code><button title="Скопировать текст" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="вариант-3-задать-параметры-используя-графический-интерфейс-пользователя" class="level4 unnumbered">
<h4 class="unnumbered anchored" data-anchor-id="вариант-3-задать-параметры-используя-графический-интерфейс-пользователя">Вариант 3: задать параметры, используя графический интерфейс пользователя</h4>
<p>Для большей интерактивности вы можете также использовать графический интерфейс пользователя, чтобы вручную установить значения параметров. Чтобы это сделать, мы можем кликнуть на выпадающее меню рядом с кнопкой ‘Knit’ и выбрать ‘Knit with parameters’.</p>
<p>Появится всплывающее окно, позволяющее вам впечатать значения для параметров, которые устанавливаются в YAML документа.</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="../images/markdown/5_parametersGUI.png" class="lightbox" data-gallery="quarto-lightbox-gallery-14"><img src="../images/markdown/5_parametersGUI.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:50.0%"></a></p>
</figure>
</div>
</div>
</div>
<p>Вы можете добиться того же самого с помощью команды <code>render()</code>, указав <code>params = "ask"</code>, как показано ниже.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>rmarkdown<span class="sc">::</span><span class="fu">render</span>(</span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">input =</span> <span class="st">"surveillance_report.Rmd"</span>,  </span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">output_file =</span> stringr<span class="sc">::</span><span class="fu">str_glue</span>(<span class="st">"outputs/Report_{Sys.Date()}.docx"</span>),</span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">params =</span> “ask”)</span></code><button title="Скопировать текст" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Однако при вводе значений в это всплывающее окно возможны ошибки и опечатки. Возможно, вы предпочтете добавить ограничения на значения, которые можно вводить через выпадающие меню. Это можно сделать, добавив в YAML несколько спецификаций для ввода каждого параметра <code>params:</code>.</p>
<ul>
<li><code>label:</code> заголовок для конкретного выпадающего меню<br>
</li>
<li><code>value:</code> значение по умолчанию (стартовое)<br>
</li>
<li><code>input:</code> установить <code>select</code> для выпадающего меню<br>
</li>
<li><code>choices:</code> дать допустимые значения в выпадающем меню</li>
</ul>
<p>Ниже эти спецификации записываются для параметра <code>hospital</code>.</p>
<div class="sourceCode" id="cb19"><pre class="sourceCode yaml code-with-copy"><code class="sourceCode yaml"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="pp">---</span></span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a><span class="fu">title</span><span class="kw">:</span><span class="at"> Surveillance report</span></span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a><span class="fu">output</span><span class="kw">:</span><span class="at"> html_document</span></span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a><span class="fu">params</span><span class="kw">:</span></span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a><span class="at"> </span><span class="fu">date</span><span class="kw">:</span><span class="at"> 2021-04-10</span></span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true" tabindex="-1"></a><span class="at"> </span><span class="fu">hospital</span><span class="kw">:</span><span class="at"> </span></span>
<span id="cb19-7"><a href="#cb19-7" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">label</span><span class="kw">:</span><span class="at"> “Town:”</span></span>
<span id="cb19-8"><a href="#cb19-8" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">value</span><span class="kw">:</span><span class="at"> Central Hospital</span></span>
<span id="cb19-9"><a href="#cb19-9" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">input</span><span class="kw">:</span><span class="at"> select</span></span>
<span id="cb19-10"><a href="#cb19-10" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">choices</span><span class="kw">:</span><span class="at"> </span><span class="kw">[</span><span class="at">Central Hospital</span><span class="kw">,</span><span class="at"> Military Hospital</span><span class="kw">,</span><span class="at"> Port Hospital</span><span class="kw">,</span><span class="at"> St. Mark</span><span class="st">'s Maternity Hospital (SMMH)]</span></span>
<span id="cb19-11"><a href="#cb19-11" aria-hidden="true" tabindex="-1"></a><span class="st">---</span></span></code><button title="Скопировать текст" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>При формировании (с помощью кнопки ‘knit with parameters’ или <code>render()</code>), во всплывающем окне будут выпадающие опции, из которых вы сможете выбрать.</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="../images/markdown/5_parametersGUIB.png" class="lightbox" data-gallery="quarto-lightbox-gallery-15"><img src="../images/markdown/5_parametersGUIB.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:50.0%"></a></p>
</figure>
</div>
</div>
</div>
</section>
</section>
<section id="параметризованный-пример" class="level3 unnumbered">
<h3 class="unnumbered anchored" data-anchor-id="параметризованный-пример">Параметризованный пример</h3>
<p>Следующий код создает параметры <code>date</code> (дата) и <code>hospital</code> (больница), которые используются в R Markdown как <code>params$date</code> и <code>params$hospital</code>, соответственно.</p>
<p>Посмотрите, как в получившемся в результате выходоном отчете данные отфильтрованы до конкретной больницы, а заголовок графика относится к правильной больнице и дате. Мы используем здесь файл “linelist_cleaned.rds”, но было бы особенно хорошо, если в самом построчном списке также был бы штамп даты, чтобы сопоставить его с параметризованной датой.</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="../images/markdown/6_Rmdexample.png" class="lightbox" data-gallery="quarto-lightbox-gallery-16"><img src="../images/markdown/6_Rmdexample.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:100.0%"></a></p>
</figure>
</div>
</div>
</div>
<p>Формирование выдаст итоговый выходной результат со шрифтом и макетом по умолчанию.</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="../images/markdown/6_RmdexampleB.png" class="lightbox" data-gallery="quarto-lightbox-gallery-17"><img src="../images/markdown/6_RmdexampleB.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:80.0%"></a></p>
</figure>
</div>
</div>
</div>
</section>
<section id="параметризация-без-params" class="level3 unnumbered">
<h3 class="unnumbered anchored" data-anchor-id="параметризация-без-params">Параметризация без <code>params</code></h3>
<p>Если вы формируете файл R Markdown с помощью <code>render()</code> из отдельного скрипта, вы можете создать действие параметризации без использования функционала <code>params:</code>.</p>
<p>Например, в <em>скрипте R</em>, который содержит команду <code>render()</code>, вы можете просто задать <code>hospital</code> и <code>date</code> как два объекта R (значения) до команды <code>render()</code>. В R Markdown вам не нужен раздел <code>params:</code> в YAML, и мы будем ссылаться на объект <code>date</code>, а не <code>params$date</code>, и <code>hospital</code>, а не <code>params$hospital</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Это скрипт R, который сделан отдельно от R Markdown</span></span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a><span class="co"># определяем объекты R</span></span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a>hospital <span class="ot">&lt;-</span> <span class="st">"Central Hospital"</span></span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a>date <span class="ot">&lt;-</span> <span class="st">"2021-04-10"</span></span>
<span id="cb20-6"><a href="#cb20-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-7"><a href="#cb20-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Формируем R markdown</span></span>
<span id="cb20-8"><a href="#cb20-8" aria-hidden="true" tabindex="-1"></a>rmarkdown<span class="sc">::</span><span class="fu">render</span>(<span class="at">input =</span> <span class="st">"create_output.Rmd"</span>) </span></code><button title="Скопировать текст" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Если вы следуете этому подходу, вы не сможете использовать “knit with parameters”, использовать графический интерфейс пользователя или включать опции формирования (knitting) внутри параметров. Однако это облегчит код, что может иметь свои преимущества.</p>
<!-- ======================================================= -->
</section>
</section>
<section id="зацикливаение-отчетов" class="level2" data-number="40.7">
<h2 data-number="40.7" class="anchored" data-anchor-id="зацикливаение-отчетов"><span class="header-section-number">40.7</span> Зацикливаение отчетов</h2>
<p>Нам может потребоваться выполнить отчет несколько раз, варьируя входные параметры, чтобы создавать отчет для каждой юрисдикции/единицы. Это можно сделать с помощью инструментов <em>итерации</em>, которые детально изучаются на странице [Итерации, циклы и списки]. Опции включают пакет <strong>purrr</strong>, либо использования <em>циклов for</em>, как объясняется ниже.</p>
<p>Ниже мы используем простой <em>цикл for</em> для создания отчета по эпиднадзору для всех интересующих больниц. Это делается с помощью одной команды (вместо изменения параметров больницы по одной вручную). Команда по формированию отчетов должна существовать в отдельном скрипте <em>вне</em> отчета Rmd. Этот скрипт будет также содержать определенные объекты для “прохождения цикла” - сегодняшнюю дату, а также вектор названий больниц, по которым должны пройти циклы.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>hospitals <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Central Hospital"</span>,</span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>                <span class="st">"Military Hospital"</span>, </span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a>                <span class="st">"Port Hospital"</span>,</span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a>                <span class="st">"St. Mark's Maternity Hospital (SMMH)"</span>) </span></code><button title="Скопировать текст" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Мы задаем эти значения по одному в команду <code>render()</code>, используя цикл, который выполняет команду один раз для каждого значения в векторе <code>hospitals</code>. Буква <code>i</code> представляет индексную позицию (от 1 до 4) больницы, которая в настоящий момент используется в этой итерации, так чтобы <code>hospital_list[1]</code> стал “Central Hospital”. Эта информация предоставляется в двух местах в команде <code>render()</code>:</p>
<ol type="1">
<li>в имя файла, чтобы имя файла первой итерации, если он создается 10 апреля 2021 года, было “Report_Central Hospital_2021-04-10.docx”, сохранялось в подпапке ‘output’ рабочей директории.<br>
</li>
<li>в <code>params =</code>, чтобы Rmd использовал имя больницы на внутреннем уровне, когда вызывается значение <code>params$hospital</code> (например, чтобы отфильтровать набор данных только до конкретных больниц). В этом примере создается 4 файла - по одному для каждой больницы.</li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(hospitals)){</span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>  rmarkdown<span class="sc">::</span><span class="fu">render</span>(</span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">input =</span> <span class="st">"surveillance_report.Rmd"</span>,</span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">output_file =</span> <span class="fu">str_glue</span>(<span class="st">"output/Report_{hospitals[i]}_{Sys.Date()}.docx"</span>),</span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">params =</span> <span class="fu">list</span>(<span class="at">hospital  =</span> hospitals[i]))</span>
<span id="cb22-6"><a href="#cb22-6" aria-hidden="true" tabindex="-1"></a>}       </span></code><button title="Скопировать текст" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<!-- В сценарии, когда вы не используете эту строгую форму параметризации, но сохраняете объекты в рабочей среде, как обсуждается в конце раздела параметризации, функция формирования будет выглядеть следующим образом: -->
<!-- ```md -->
<!-- for(i in 1:length(hospital_list)){ -->
<!-- rmarkdown::render("surveillance_report.Rmd", -->
<!--                   output_file = paste0("output/Report_", hospital_list[i], refdate, ".docx") -->
<!-- }        -->
<!-- ``` -->
<!-- Текст внутри markdown тогда должен ссылаться на `hospital_list[i]` и `refdate`.  -->
<!-- ======================================================= -->
</section>
<section id="шаблоны" class="level2" data-number="40.8">
<h2 data-number="40.8" class="anchored" data-anchor-id="шаблоны"><span class="header-section-number">40.8</span> Шаблоны</h2>
<p>Используя шаблонный документ, содержащий любое желаемое форматирование, можно настроить эстетику внешнего вида выходного Rmd-файла. Например, можно создать файл MS Word или Powerpoint, содержащий страницы/слайды с нужными размерами, водяными знаками, фоном и шрифтами.</p>
<section id="документы-word" class="level3 unnumbered">
<h3 class="unnumbered anchored" data-anchor-id="документы-word">Документы Word</h3>
<p>Чтобы создать шаблон, создаем новый документ word (или используем существующий выходной результат с подходящим форматированием) и редактируем шрифты, задав их в Стиле. В Стиле, заголовок 1, 2 и 3 относятся к разным уровням заголовков markdown (<code># Header 1</code>, <code>## Header 2</code> и <code>### Header 3</code> соответственно). Правой кнопкой мыши кликните на стиль и кликните ‘изменить’, чтобы изменить форматирование шрифта и абзаца (например, вы можете ввести разрывы страниц перед определенным стилем, что поможет с наличием пространства). Другие аспекты документа word, такие как границы, размер страницы, заголовки и т.п. можно менять как в обычном документе word, в котором вы напрямую работаете.</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="../images/markdown/7_template.png" class="lightbox" data-gallery="quarto-lightbox-gallery-18"><img src="../images/markdown/7_template.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:100.0%"></a></p>
</figure>
</div>
</div>
</div>
</section>
<section id="документы-powerpoint" class="level3 unnumbered">
<h3 class="unnumbered anchored" data-anchor-id="документы-powerpoint">Документы Powerpoint</h3>
<p>Как и выше, создаем новую презентацию или используем существующий файл powerpoint с нужным форматированием. Для дополнительного редактирования кликните на ‘Вид’ и ‘Образец слайдов’. Оттуда вы можете менять вид ‘мастер’ слайда, редактируя форматирование текста в текстовых полях, а также фон/размер страницы для всей страницы.</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="../images/markdown/8_ppttemplate.PNG" class="lightbox" data-gallery="quarto-lightbox-gallery-19"><img src="../images/markdown/8_ppttemplate.PNG" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:100.0%"></a></p>
</figure>
</div>
</div>
</div>
<p>К сожалению редактировать файлы powerpoint можно менее гибким образом:</p>
<ul>
<li>Заголовок первого уровня (<code># Header 1</code>) автоматически станет заголовком нового слайда,</li>
<li>Текст <code>## Заголовка 2</code> не будет отображен как подзаголовок, а будет текстом внутри основного текстового поля слайда (если вы только не найдете способ манипуляции с образцом слайдов).</li>
<li>Полученные выходные графики и таблицы автоматически перейдут на новые слайды. Вам нужно будет их объединять, например, с помощью функции <strong>patchwork</strong> по комбинированию ggplots, чтобы они отображались на одной странице. См. этот <a href="https://mattherman.info/blog/ppt-patchwork/">пост в блоге</a> об использовании пакета <strong>patchwork</strong> для размещения нескольких картинок на одном слайде.</li>
</ul>
<p>См. <a href="https://davidgohel.github.io/officer/">пакет <strong>officer</strong></a>, который является инструментом для более глубокой работы с презентациями powerpoint.</p>
</section>
<section id="интеграция-шаблонов-в-yaml" class="level3 unnumbered">
<h3 class="unnumbered anchored" data-anchor-id="интеграция-шаблонов-в-yaml">Интеграция шаблонов в YAML</h3>
<p>Как только шаблон подготовлен, его детали можно добавить в YAML в Rmd под строкой ‘output’ и под указанием типа документа (который сам переходит на отдельную строку). Обратите внимание, что для шаблонов слайдов powerpoint можно использовать <code>reference_doc</code>.</p>
<p>Проще всего сохранить шаблон в той же папке, где находится файл Rmd (как в примере ниже), или внутри подпапки в ней.</p>
<div class="sourceCode" id="cb23"><pre class="sourceCode yaml code-with-copy"><code class="sourceCode yaml"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="pp">---</span></span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a><span class="fu">title</span><span class="kw">:</span><span class="at"> Surveillance report</span></span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a><span class="fu">output</span><span class="kw">:</span><span class="at"> </span></span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a><span class="at"> </span><span class="fu">word_document</span><span class="kw">:</span></span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">reference_docx</span><span class="kw">:</span><span class="at"> </span><span class="st">"template.docx"</span></span>
<span id="cb23-6"><a href="#cb23-6" aria-hidden="true" tabindex="-1"></a><span class="fu">params</span><span class="kw">:</span></span>
<span id="cb23-7"><a href="#cb23-7" aria-hidden="true" tabindex="-1"></a><span class="at"> </span><span class="fu">date</span><span class="kw">:</span><span class="at"> 2021-04-10</span></span>
<span id="cb23-8"><a href="#cb23-8" aria-hidden="true" tabindex="-1"></a><span class="at"> </span><span class="fu">hospital</span><span class="kw">:</span><span class="at"> Central Hospital</span></span>
<span id="cb23-9"><a href="#cb23-9" aria-hidden="true" tabindex="-1"></a><span class="fu">template</span><span class="kw">:</span></span>
<span id="cb23-10"><a href="#cb23-10" aria-hidden="true" tabindex="-1"></a><span class="at"> </span></span>
<span id="cb23-11"><a href="#cb23-11" aria-hidden="true" tabindex="-1"></a><span class="pp">---</span></span></code><button title="Скопировать текст" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
<section id="форматирование-файлов-html" class="level3 unnumbered">
<h3 class="unnumbered anchored" data-anchor-id="форматирование-файлов-html">Форматирование файлов HTML</h3>
<p>Файлы HTML не используют шаблоны, но могут содержать конфигурацию стилей внутри YAML. HTML - интерактивные документы, они особенно гибкие. Здесь мы разберем некоторые основные опции.</p>
<ul>
<li><p>Оглавление: Мы можем добавить оглавление с помощью <code>toc: true</code> ниже, и также уточнить, что оно остается видимым (“плавает”), когда вы пролистываете, с помощью <code>toc_float: true</code>.</p></li>
<li><p>Темы: Мы можем сослаться на некоторые предварительно разработанные темы, которые мы получаем из библиотеки тем Bootswatch. В примере ниже мы используем cerulean (синюю). Другие варианты включают: journal, flatly, darkly, readable, spacelab, united, cosmo, lumen, paper, sandstone, simplex и yeti.</p></li>
<li><p>Выделение: Эта конфигурация меняет вид выделенного текста (например, кода во фрагментах, которые показаны). Поддерживаемые стили включают default, tango, pygments, kate, monochrome, espresso, zenburn, haddock, breezedark, и textmate.</p></li>
</ul>
<p>Вот пример того, как интегрировать указанные выше опции в YAML.</p>
<div class="sourceCode" id="cb24"><pre class="sourceCode yaml code-with-copy"><code class="sourceCode yaml"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="pp">---</span></span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a><span class="fu">title</span><span class="kw">:</span><span class="at"> </span><span class="st">"HTML example"</span></span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a><span class="fu">output</span><span class="kw">:</span></span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a><span class="at">  </span><span class="fu">html_document</span><span class="kw">:</span></span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">toc</span><span class="kw">:</span><span class="at"> </span><span class="ch">true</span></span>
<span id="cb24-6"><a href="#cb24-6" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">toc_float</span><span class="kw">:</span><span class="at"> </span><span class="ch">true</span></span>
<span id="cb24-7"><a href="#cb24-7" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">theme</span><span class="kw">:</span><span class="at"> cerulean</span></span>
<span id="cb24-8"><a href="#cb24-8" aria-hidden="true" tabindex="-1"></a><span class="at">    </span><span class="fu">highlight</span><span class="kw">:</span><span class="at"> kate</span></span>
<span id="cb24-9"><a href="#cb24-9" aria-hidden="true" tabindex="-1"></a><span class="at">    </span></span>
<span id="cb24-10"><a href="#cb24-10" aria-hidden="true" tabindex="-1"></a><span class="pp">---</span></span></code><button title="Скопировать текст" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Ниже приведены два примера выходных результатов в HTML, у обоих из которых плавающее оглавление, но разные темы и стили выделения:</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="../images/markdown/9_html.png" class="lightbox" data-gallery="quarto-lightbox-gallery-20"><img src="../images/markdown/9_html.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:100.0%"></a></p>
</figure>
</div>
</div>
</div>
</section>
</section>
<section id="динамическое-содержимое" class="level2" data-number="40.9">
<h2 data-number="40.9" class="anchored" data-anchor-id="динамическое-содержимое"><span class="header-section-number">40.9</span> Динамическое содержимое</h2>
<p>В выходном результате в формате HTML ваше содержимое отчета может быть динамичным. Ниже приведены некоторые примеры:</p>
<section id="таблицы-1" class="level3 unnumbered">
<h3 class="unnumbered anchored" data-anchor-id="таблицы-1">Таблицы</h3>
<p>В отчете в формате HTML вы можете печатать датафрейм/таблицы tibble таким образом, что содержимое будет динамическим с фильтрами и полосами прокрутки. Существует несколько пакетов, которые дают такие возможности.</p>
<p>Чтобы это сделать с помощью пакета <strong>DT</strong>, как это сделано в данном руководстве, вы можете вставить фрагмент кода следующим образом:</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="../images/markdown/10_dynamictable.png" class="lightbox" data-gallery="quarto-lightbox-gallery-21"><img src="../images/markdown/10_dynamictable.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:100.0%"></a></p>
</figure>
</div>
</div>
</div>
<p>Функция <code>datatable()</code> напечатает заданный датафрейм как динамическую таблицу для читателя. Вы можете установить <code>rownames = FALSE</code>, чтобы упростить дальнюю левую сторону таблицы. <code>filter = "top"</code> создает фильтр над каждым столбцом. В аргументе <code>option()</code> задайте список других спецификаций. Ниже мы включаем две: <code>pageLength = 5</code> устанавливает количество видимых строк на уровне 5 (остальные строки можно увидеть, перейдя по стрелкам на следующую страницу), а <code>scrollX=TRUE</code> активирует полосу прокрутки внизу таблицы (для столбцов, которые уходят вправо).</p>
<p>Если у вас очень большой набор данных, рассмотрите возможность показать только топ X строк, обернув датафрейм в <code>head()</code>.</p>
</section>
<section id="html-виджеты" class="level3 unnumbered">
<h3 class="unnumbered anchored" data-anchor-id="html-виджеты">HTML виджеты</h3>
<p><a href="http://www.htmlwidgets.org/">Виджеты HTML для R</a> - особый класс пакетов R, который позволяет увеличить интерактивность с помощью использования библиотек JavaScript. Вы можете их интегрировать в выходной HTML файл R Markdown.</p>
<p>Некоторые частые примеры виджетов включают:</p>
<ul>
<li>Plotly (используется в данном руководстве на этой странице и странице <a href="../new_pages/interactive_plots.ru.html">Интерактивные графики</a>)</li>
<li>visNetwork (используется на странице руководства <a href="../new_pages/transmission_chains.ru.html">Цепочки распространения</a>)<br>
</li>
<li>Leaflet (используется на странице руководства <a href="../new_pages/gis.ru.html">Основы ГИС</a>)<br>
</li>
<li>dygraphs (полезен для интерактивного отображения данных временных рядов)<br>
</li>
<li>DT (<code>datatable()</code>) (используется, чтобы показать динамические таблицы с фильтром, сортировкой и т.п.)</li>
</ul>
<p>Функцию <code>ggplotly()</code> из <strong>plotly</strong> особенно легко использовать. См. страницу <a href="../new_pages/interactive_plots.ru.html">Интерактивные графики</a>.</p>
</section>
</section>
<section id="ресурсы" class="level2" data-number="40.10">
<h2 data-number="40.10" class="anchored" data-anchor-id="ресурсы"><span class="header-section-number">40.10</span> Ресурсы</h2>
<p>Дополнительная информация:</p>
<ul>
<li>https://bookdown.org/yihui/rmarkdown/</li>
<li>https://rmarkdown.rstudio.com/articles_intro.html</li>
</ul>
<p>Хорошее объяснение markdown в сравнении с knitr в сравнении с Rmarkdown есть тут: https://stackoverflow.com/questions/40563479/relationship-between-r-markdown-knitr-pandoc-and-bookdown</p>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const disableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'prefetch';
    }
  }
  const enableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'stylesheet';
    }
  }
  const manageTransitions = (selector, allowTransitions) => {
    const els = window.document.querySelectorAll(selector);
    for (let i=0; i < els.length; i++) {
      const el = els[i];
      if (allowTransitions) {
        el.classList.remove('notransition');
      } else {
        el.classList.add('notransition');
      }
    }
  }
  const toggleGiscusIfUsed = (isAlternate, darkModeDefault) => {
    const baseTheme = document.querySelector('#giscus-base-theme')?.value ?? 'light';
    const alternateTheme = document.querySelector('#giscus-alt-theme')?.value ?? 'dark';
    let newTheme = '';
    if(darkModeDefault) {
      newTheme = isAlternate ? baseTheme : alternateTheme;
    } else {
      newTheme = isAlternate ? alternateTheme : baseTheme;
    }
    const changeGiscusTheme = () => {
      // From: https://github.com/giscus/giscus/issues/336
      const sendMessage = (message) => {
        const iframe = document.querySelector('iframe.giscus-frame');
        if (!iframe) return;
        iframe.contentWindow.postMessage({ giscus: message }, 'https://giscus.app');
      }
      sendMessage({
        setConfig: {
          theme: newTheme
        }
      });
    }
    const isGiscussLoaded = window.document.querySelector('iframe.giscus-frame') !== null;
    if (isGiscussLoaded) {
      changeGiscusTheme();
    }
  }
  const toggleColorMode = (alternate) => {
    // Switch the stylesheets
    const alternateStylesheets = window.document.querySelectorAll('link.quarto-color-scheme.quarto-color-alternate');
    manageTransitions('#quarto-margin-sidebar .nav-link', false);
    if (alternate) {
      enableStylesheet(alternateStylesheets);
      for (const sheetNode of alternateStylesheets) {
        if (sheetNode.id === "quarto-bootstrap") {
          toggleBodyColorMode(sheetNode);
        }
      }
    } else {
      disableStylesheet(alternateStylesheets);
      toggleBodyColorPrimary();
    }
    manageTransitions('#quarto-margin-sidebar .nav-link', true);
    // Switch the toggles
    const toggles = window.document.querySelectorAll('.quarto-color-scheme-toggle');
    for (let i=0; i < toggles.length; i++) {
      const toggle = toggles[i];
      if (toggle) {
        if (alternate) {
          toggle.classList.add("alternate");     
        } else {
          toggle.classList.remove("alternate");
        }
      }
    }
    // Hack to workaround the fact that safari doesn't
    // properly recolor the scrollbar when toggling (#1455)
    if (navigator.userAgent.indexOf('Safari') > 0 && navigator.userAgent.indexOf('Chrome') == -1) {
      manageTransitions("body", false);
      window.scrollTo(0, 1);
      setTimeout(() => {
        window.scrollTo(0, 0);
        manageTransitions("body", true);
      }, 40);  
    }
  }
  const isFileUrl = () => { 
    return window.location.protocol === 'file:';
  }
  const hasAlternateSentinel = () => {  
    let styleSentinel = getColorSchemeSentinel();
    if (styleSentinel !== null) {
      return styleSentinel === "alternate";
    } else {
      return false;
    }
  }
  const setStyleSentinel = (alternate) => {
    const value = alternate ? "alternate" : "default";
    if (!isFileUrl()) {
      window.localStorage.setItem("quarto-color-scheme", value);
    } else {
      localAlternateSentinel = value;
    }
  }
  const getColorSchemeSentinel = () => {
    if (!isFileUrl()) {
      const storageValue = window.localStorage.getItem("quarto-color-scheme");
      return storageValue != null ? storageValue : localAlternateSentinel;
    } else {
      return localAlternateSentinel;
    }
  }
  const darkModeDefault = false;
  let localAlternateSentinel = darkModeDefault ? 'alternate' : 'default';
  // Dark / light mode switch
  window.quartoToggleColorScheme = () => {
    // Read the current dark / light value 
    let toAlternate = !hasAlternateSentinel();
    toggleColorMode(toAlternate);
    setStyleSentinel(toAlternate);
    toggleGiscusIfUsed(toAlternate, darkModeDefault);
  };
  // Ensure there is a toggle, if there isn't float one in the top right
  if (window.document.querySelector('.quarto-color-scheme-toggle') === null) {
    const a = window.document.createElement('a');
    a.classList.add('top-right');
    a.classList.add('quarto-color-scheme-toggle');
    a.href = "";
    a.onclick = function() { try { window.quartoToggleColorScheme(); } catch {} return false; };
    const i = window.document.createElement("i");
    i.classList.add('bi');
    a.appendChild(i);
    window.document.body.appendChild(a);
  }
  // Switch to dark mode if need be
  if (hasAlternateSentinel()) {
    toggleColorMode(true);
  } else {
    toggleColorMode(false);
  }
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Скопировано");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Скопировано");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="../new_pages/interactive_plots.ru.html" class="pagination-link" aria-label="Интерактивные графики">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">39</span>&nbsp; <span class="chapter-title">Интерактивные графики</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="../new_pages/reportfactory.ru.html" class="pagination-link" aria-label="Структурирование рутинных отчетов">
        <span class="nav-page-text"><span class="chapter-number">41</span>&nbsp; <span class="chapter-title">Структурирование рутинных отчетов</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->
<script>var lightboxQuarto = GLightbox({"selector":".lightbox","loop":false,"closeEffect":"zoom","descPosition":"bottom","openEffect":"zoom"});
window.onload = () => {
  lightboxQuarto.on('slide_before_load', (data) => {
    const { slideIndex, slideNode, slideConfig, player, trigger } = data;
    const href = trigger.getAttribute('href');
    if (href !== null) {
      const imgEl = window.document.querySelector(`a[href="${href}"] img`);
      if (imgEl !== null) {
        const srcAttr = imgEl.getAttribute("src");
        if (srcAttr && srcAttr.startsWith("data:")) {
          slideConfig.href = srcAttr;
        }
      }
    } 
  });

  lightboxQuarto.on('slide_after_load', (data) => {
    const { slideIndex, slideNode, slideConfig, player, trigger } = data;
    if (window.Quarto?.typesetMath) {
      window.Quarto.typesetMath(slideNode);
    }
  });

};
          </script>




</body></html>